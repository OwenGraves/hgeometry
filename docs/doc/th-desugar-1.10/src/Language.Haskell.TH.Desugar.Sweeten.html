<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- Language/Haskell/TH/Desugar/Sweeten.hs

(c) Richard Eisenberg 2013
rae@cs.brynmawr.edu

Converts desugared TH back into real TH.
-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Module      :  Language.Haskell.TH.Desugar.Sweeten</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Copyright   :  (C) 2014 Richard Eisenberg</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- License     :  BSD-style (see LICENSE)</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- Maintainer  :  Ryan Scott</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- Portability :  non-portable</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- The functions in this module convert desugared Template Haskell back into</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- proper Template Haskell.</span><span>
</span><span id="line-23"></span><span class="hs-comment">--</span><span>
</span><span id="line-24"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Haskell.TH.Desugar.Sweeten</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier">expToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#matchToTH"><span class="hs-identifier">matchToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier">patToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decsToTH"><span class="hs-identifier">decsToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier">decToTH</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#letDecToTH"><span class="hs-identifier">letDecToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier">typeToTH</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#conToTH"><span class="hs-identifier">conToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#foreignToTH"><span class="hs-identifier">foreignToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#pragmaToTH"><span class="hs-identifier">pragmaToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#ruleBndrToTH"><span class="hs-identifier">ruleBndrToTH</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#clauseToTH"><span class="hs-identifier">clauseToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier">tvbToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier">cxtToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier">predToTH</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivClauseToTH"><span class="hs-identifier">derivClauseToTH</span></a></span><span class="hs-special">,</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patSynDirToTH"><span class="hs-identifier">patSynDirToTH</span></a></span><span class="hs-special">,</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeArgToTH"><span class="hs-identifier">typeArgToTH</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">exp</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">cxt</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.AST</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.Core</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier">DTypeArg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.Util</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">maybeToList</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-type">expToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-51"></span><span id="expToTH"><span class="annot"><span class="annottext">expToTH :: DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var hs-var">expToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-type">DVarE</span></a></span><span> </span><span id="local-6989586621679414444"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414444"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414444"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-52"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-type">DConE</span></a></span><span> </span><span id="local-6989586621679414441"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414441"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">ConE</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414441"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-53"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-type">DLitE</span></a></span><span> </span><span id="local-6989586621679414438"><span class="annot"><span class="annottext">l :: Lit
</span><a href="#local-6989586621679414438"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lit -&gt; Exp
</span><span class="hs-identifier hs-var">LitE</span></span><span> </span><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679414438"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-54"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-type">DAppE</span></a></span><span> </span><span id="local-6989586621679414435"><span class="annot"><span class="annottext">e1 :: DExp
</span><a href="#local-6989586621679414435"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679414434"><span class="annot"><span class="annottext">e2 :: DExp
</span><a href="#local-6989586621679414434"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-identifier hs-var">AppE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679414435"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679414434"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLamE"><span class="hs-identifier hs-type">DLamE</span></a></span><span> </span><span id="local-6989586621679414431"><span class="annot"><span class="annottext">names :: [Name]
</span><a href="#local-6989586621679414431"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span id="local-6989586621679414430"><span class="annot"><span class="annottext">exp :: DExp
</span><a href="#local-6989586621679414430"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; Exp -&gt; Exp
</span><span class="hs-identifier hs-var">LamE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Pat) -&gt; [Name] -&gt; [Pat]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><span class="hs-identifier hs-var">VarP</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679414431"><span class="hs-identifier hs-var">names</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679414430"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-type">DCaseE</span></a></span><span> </span><span id="local-6989586621679414426"><span class="annot"><span class="annottext">exp :: DExp
</span><a href="#local-6989586621679414426"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679414425"><span class="annot"><span class="annottext">matches :: [DMatch]
</span><a href="#local-6989586621679414425"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Match] -&gt; Exp
</span><span class="hs-identifier hs-var">CaseE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679414426"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DMatch -&gt; Match) -&gt; [DMatch] -&gt; [Match]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DMatch -&gt; Match
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#matchToTH"><span class="hs-identifier hs-var">matchToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679414425"><span class="hs-identifier hs-var">matches</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetE"><span class="hs-identifier hs-type">DLetE</span></a></span><span> </span><span id="local-6989586621679414422"><span class="annot"><span class="annottext">decs :: [DLetDec]
</span><a href="#local-6989586621679414422"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span id="local-6989586621679414421"><span class="annot"><span class="annottext">exp :: DExp
</span><a href="#local-6989586621679414421"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; Exp -&gt; Exp
</span><span class="hs-identifier hs-var">LetE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DLetDec -&gt; Maybe Dec) -&gt; [DLetDec] -&gt; [Dec]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">DLetDec -&gt; Maybe Dec
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#letDecToTH"><span class="hs-identifier hs-var">letDecToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679414422"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679414421"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigE"><span class="hs-identifier hs-type">DSigE</span></a></span><span> </span><span id="local-6989586621679414418"><span class="annot"><span class="annottext">exp :: DExp
</span><a href="#local-6989586621679414418"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679414417"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679414417"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Type -&gt; Exp
</span><span class="hs-identifier hs-var">SigE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679414418"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414417"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 709
</span><span class="hs-identifier">expToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DStaticE</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Static expressions supported only in GHC 7.10+&quot;</span><span class="hs-cpp">
#else
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DStaticE"><span class="hs-identifier hs-type">DStaticE</span></a></span><span> </span><span id="local-6989586621679414414"><span class="annot"><span class="annottext">exp :: DExp
</span><a href="#local-6989586621679414414"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><span class="hs-identifier hs-var">StaticE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679414414"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppTypeE"><span class="hs-identifier hs-type">DAppTypeE</span></a></span><span> </span><span id="local-6989586621679414411"><span class="annot"><span class="annottext">exp :: DExp
</span><a href="#local-6989586621679414411"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679414410"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679414410"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Type -&gt; Exp
</span><span class="hs-identifier hs-var">AppTypeE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679414411"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414410"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- In the event that we're on a version of Template Haskell without support for</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- type applications, we will simply drop the applied type.</span><span>
</span><span id="line-69"></span><span class="hs-identifier">expToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DAppTypeE</span><span> </span><span class="hs-identifier">exp</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">expToTH</span><span> </span><span class="hs-identifier">exp</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-72"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#matchToTH"><span class="hs-identifier hs-type">matchToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span>
</span><span id="line-73"></span><span id="matchToTH"><span class="annot"><span class="annottext">matchToTH :: DMatch -&gt; Match
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#matchToTH"><span class="hs-identifier hs-var hs-var">matchToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span><span> </span><span id="local-6989586621679414407"><span class="annot"><span class="annottext">pat :: DPat
</span><a href="#local-6989586621679414407"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679414406"><span class="annot"><span class="annottext">exp :: DExp
</span><a href="#local-6989586621679414406"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Body -&gt; [Dec] -&gt; Match
</span><span class="hs-identifier hs-var">Match</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679414407"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Body
</span><span class="hs-identifier hs-var">NormalB</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679414406"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-type">patToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span>
</span><span id="line-76"></span><span id="patToTH"><span class="annot"><span class="annottext">patToTH :: DPat -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var hs-var">patToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLitP"><span class="hs-identifier hs-type">DLitP</span></a></span><span> </span><span id="local-6989586621679414402"><span class="annot"><span class="annottext">lit :: Lit
</span><a href="#local-6989586621679414402"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lit -&gt; Pat
</span><span class="hs-identifier hs-var">LitP</span></span><span> </span><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679414402"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-77"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-type">DVarP</span></a></span><span> </span><span id="local-6989586621679414399"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414399"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><span class="hs-identifier hs-var">VarP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414399"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-78"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-type">DConP</span></a></span><span> </span><span id="local-6989586621679414397"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414397"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414396"><span class="annot"><span class="annottext">pats :: [DPat]
</span><a href="#local-6989586621679414396"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Pat
</span><span class="hs-identifier hs-var">ConP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414397"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DPat -&gt; Pat) -&gt; [DPat] -&gt; [Pat]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679414396"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTildeP"><span class="hs-identifier hs-type">DTildeP</span></a></span><span> </span><span id="local-6989586621679414393"><span class="annot"><span class="annottext">pat :: DPat
</span><a href="#local-6989586621679414393"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Pat
</span><span class="hs-identifier hs-var">TildeP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679414393"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DBangP"><span class="hs-identifier hs-type">DBangP</span></a></span><span> </span><span id="local-6989586621679414390"><span class="annot"><span class="annottext">pat :: DPat
</span><a href="#local-6989586621679414390"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Pat
</span><span class="hs-identifier hs-var">BangP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679414390"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigP"><span class="hs-identifier hs-type">DSigP</span></a></span><span> </span><span id="local-6989586621679414387"><span class="annot"><span class="annottext">pat :: DPat
</span><a href="#local-6989586621679414387"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679414386"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679414386"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Type -&gt; Pat
</span><span class="hs-identifier hs-var">SigP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679414387"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414386"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-type">DWildP</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat
</span><span class="hs-identifier hs-var">WildP</span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decsToTH"><span class="hs-identifier hs-type">decsToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-85"></span><span id="decsToTH"><span class="annot"><span class="annottext">decsToTH :: [DDec] -&gt; [Dec]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#decsToTH"><span class="hs-identifier hs-var hs-var">decsToTH</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [Dec]) -&gt; [DDec] -&gt; [Dec]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">DDec -&gt; [Dec]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- | This returns a list of @Dec@s because GHC 7.6.3 does not have</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- a one-to-one mapping between 'DDec' and @Dec@.</span><span>
</span><span id="line-89"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-type">decToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-90"></span><span id="decToTH"><span class="annot"><span class="annottext">decToTH :: DDec -&gt; [Dec]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var hs-var">decToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-type">DLetDec</span></a></span><span> </span><span id="local-6989586621679414380"><span class="annot"><span class="annottext">d :: DLetDec
</span><a href="#local-6989586621679414380"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Dec -&gt; [Dec]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DLetDec -&gt; Maybe Dec
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#letDecToTH"><span class="hs-identifier hs-var">letDecToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DLetDec
</span><a href="#local-6989586621679414380"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDataD"><span class="hs-identifier hs-type">DDataD</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span id="local-6989586621679414377"><span class="annot"><span class="annottext">cxt :: DCxt
</span><a href="#local-6989586621679414377"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679414376"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414376"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414375"><span class="annot"><span class="annottext">tvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679414375"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679414374"><span class="annot"><span class="annottext">_mk :: Maybe DType
</span><a href="#local-6989586621679414374"><span class="hs-identifier hs-var">_mk</span></a></span></span><span> </span><span id="local-6989586621679414373"><span class="annot"><span class="annottext">cons :: [DCon]
</span><a href="#local-6989586621679414373"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679414372"><span class="annot"><span class="annottext">derivings :: [DDerivClause]
</span><a href="#local-6989586621679414372"><span class="hs-identifier hs-var">derivings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Cxt
-&gt; Name
-&gt; [TyVarBndr]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; Dec
</span><span class="hs-identifier hs-var">DataD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DCxt -&gt; Cxt
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-var">cxtToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679414377"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414376"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; TyVarBndr) -&gt; [DTyVarBndr] -&gt; [TyVarBndr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; TyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679414375"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DType -&gt; Type) -&gt; Maybe DType -&gt; Maybe Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679414374"><span class="hs-identifier hs-var">_mk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DCon -&gt; Con) -&gt; [DCon] -&gt; [Con]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DCon -&gt; Con
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#conToTH"><span class="hs-identifier hs-var">conToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DCon]
</span><a href="#local-6989586621679414373"><span class="hs-identifier hs-var">cons</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DDerivClause -&gt; [DerivClause]) -&gt; [DDerivClause] -&gt; [DerivClause]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">DDerivClause -&gt; [DerivClause]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivClauseToTH"><span class="hs-identifier hs-var">derivClauseToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DDerivClause]
</span><a href="#local-6989586621679414372"><span class="hs-identifier hs-var">derivings</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span>  </span><span class="hs-special">[</span><span class="hs-identifier">DataD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cxtToTH</span><span> </span><span class="hs-identifier">cxt</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">tvbToTH</span><span> </span><span class="hs-identifier">tvbs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-identifier">cons</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>         </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">derivingToTH</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDataD"><span class="hs-identifier hs-type">DDataD</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#Newtype"><span class="hs-identifier hs-type">Newtype</span></a></span><span> </span><span id="local-6989586621679414369"><span class="annot"><span class="annottext">cxt :: DCxt
</span><a href="#local-6989586621679414369"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679414368"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414368"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414367"><span class="annot"><span class="annottext">tvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679414367"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679414366"><span class="annot"><span class="annottext">_mk :: Maybe DType
</span><a href="#local-6989586621679414366"><span class="hs-identifier hs-var">_mk</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679414365"><span class="annot"><span class="annottext">con :: DCon
</span><a href="#local-6989586621679414365"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679414364"><span class="annot"><span class="annottext">derivings :: [DDerivClause]
</span><a href="#local-6989586621679414364"><span class="hs-identifier hs-var">derivings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Cxt
-&gt; Name -&gt; [TyVarBndr] -&gt; Maybe Type -&gt; Con -&gt; [DerivClause] -&gt; Dec
</span><span class="hs-identifier hs-var">NewtypeD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DCxt -&gt; Cxt
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-var">cxtToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679414369"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414368"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; TyVarBndr) -&gt; [DTyVarBndr] -&gt; [TyVarBndr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; TyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679414367"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DType -&gt; Type) -&gt; Maybe DType -&gt; Maybe Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679414366"><span class="hs-identifier hs-var">_mk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DCon -&gt; Con
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#conToTH"><span class="hs-identifier hs-var">conToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DCon
</span><a href="#local-6989586621679414365"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DDerivClause -&gt; [DerivClause]) -&gt; [DDerivClause] -&gt; [DerivClause]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">DDerivClause -&gt; [DerivClause]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivClauseToTH"><span class="hs-identifier hs-var">derivClauseToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DDerivClause]
</span><a href="#local-6989586621679414364"><span class="hs-identifier hs-var">derivings</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span>  </span><span class="hs-special">[</span><span class="hs-identifier">NewtypeD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cxtToTH</span><span> </span><span class="hs-identifier">cxt</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">tvbToTH</span><span> </span><span class="hs-identifier">tvbs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-identifier">con</span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>            </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">derivingToTH</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTySynD"><span class="hs-identifier hs-type">DTySynD</span></a></span><span> </span><span id="local-6989586621679414361"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414361"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414360"><span class="annot"><span class="annottext">tvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679414360"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679414359"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679414359"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [TyVarBndr] -&gt; Type -&gt; Dec
</span><span class="hs-identifier hs-var">TySynD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414361"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; TyVarBndr) -&gt; [DTyVarBndr] -&gt; [TyVarBndr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; TyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679414360"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414359"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-108"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DClassD"><span class="hs-identifier hs-type">DClassD</span></a></span><span> </span><span id="local-6989586621679414356"><span class="annot"><span class="annottext">cxt :: DCxt
</span><a href="#local-6989586621679414356"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679414355"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414355"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414354"><span class="annot"><span class="annottext">tvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679414354"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679414353"><span class="annot"><span class="annottext">fds :: [FunDep]
</span><a href="#local-6989586621679414353"><span class="hs-identifier hs-var">fds</span></a></span></span><span> </span><span id="local-6989586621679414352"><span class="annot"><span class="annottext">decs :: [DDec]
</span><a href="#local-6989586621679414352"><span class="hs-identifier hs-var">decs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Cxt -&gt; Name -&gt; [TyVarBndr] -&gt; [FunDep] -&gt; [Dec] -&gt; Dec
</span><span class="hs-identifier hs-var">ClassD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DCxt -&gt; Cxt
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-var">cxtToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679414356"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414355"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; TyVarBndr) -&gt; [DTyVarBndr] -&gt; [TyVarBndr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; TyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679414354"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FunDep]
</span><a href="#local-6989586621679414353"><span class="hs-identifier hs-var">fds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DDec] -&gt; [Dec]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#decsToTH"><span class="hs-identifier hs-var">decsToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679414352"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-110"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DInstanceD"><span class="hs-identifier hs-type">DInstanceD</span></a></span><span> </span><span id="local-6989586621679414349"><span class="annot"><span class="annottext">over :: Maybe Overlap
</span><a href="#local-6989586621679414349"><span class="hs-identifier hs-var">over</span></a></span></span><span> </span><span id="local-6989586621679414348"><span class="annot"><span class="annottext">mtvbs :: Maybe [DTyVarBndr]
</span><a href="#local-6989586621679414348"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679414347"><span class="annot"><span class="annottext">_cxt :: DCxt
</span><a href="#local-6989586621679414347"><span class="hs-identifier hs-var">_cxt</span></a></span></span><span> </span><span id="local-6989586621679414346"><span class="annot"><span class="annottext">_ty :: DType
</span><a href="#local-6989586621679414346"><span class="hs-identifier hs-var">_ty</span></a></span></span><span> </span><span id="local-6989586621679414345"><span class="annot"><span class="annottext">decs :: [DDec]
</span><a href="#local-6989586621679414345"><span class="hs-identifier hs-var">decs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe Overlap -&gt; DCxt -&gt; DType -&gt; [DDec] -&gt; Dec
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#instanceDToTH"><span class="hs-identifier hs-var">instanceDToTH</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Overlap
</span><a href="#local-6989586621679414349"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679414343"><span class="hs-identifier hs-var">cxt'</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414342"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679414345"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679414343"><span class="annot"><span class="annottext">cxt' :: DCxt
</span><a href="#local-6989586621679414343"><span class="hs-identifier hs-var">cxt'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679414342"><span class="annot"><span class="annottext">ty' :: DType
</span><a href="#local-6989586621679414342"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr]
</span><a href="#local-6989586621679414348"><span class="hs-identifier hs-var">mtvbs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-114"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679414347"><span class="hs-identifier hs-var">_cxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414346"><span class="hs-identifier hs-var">_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679414341"><span class="annot"><span class="annottext">_tvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679414341"><span class="hs-identifier hs-var">_tvbs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 800 || __GLASGOW_HASKELL__ &gt;= 802
</span><span>                                </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-var">DForallT</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679414341"><span class="hs-identifier hs-var">_tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679414347"><span class="hs-identifier hs-var">_cxt</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414346"><span class="hs-identifier hs-var">_ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>                                </span><span class="hs-comment">-- See #117</span><span>
</span><span id="line-120"></span><span>                                </span><span class="hs-identifier">error</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-string">&quot;Explicit foralls in instance declarations &quot;</span><span>
</span><span id="line-121"></span><span>                                     </span><span class="hs-operator">++</span><span> </span><span class="hs-string">&quot;are broken on GHC 8.0.&quot;</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForeignD"><span class="hs-identifier hs-type">DForeignD</span></a></span><span> </span><span id="local-6989586621679414338"><span class="annot"><span class="annottext">f :: DForeign
</span><a href="#local-6989586621679414338"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Foreign -&gt; Dec
</span><span class="hs-identifier hs-var">ForeignD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DForeign -&gt; Foreign
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#foreignToTH"><span class="hs-identifier hs-var">foreignToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DForeign
</span><a href="#local-6989586621679414338"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DOpenTypeFamilyD"><span class="hs-identifier hs-type">DOpenTypeFamilyD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTypeFamilyHead"><span class="hs-identifier hs-type">DTypeFamilyHead</span></a></span><span> </span><span id="local-6989586621679414334"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414334"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414333"><span class="annot"><span class="annottext">tvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679414333"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679414332"><span class="annot"><span class="annottext">frs :: DFamilyResultSig
</span><a href="#local-6989586621679414332"><span class="hs-identifier hs-var">frs</span></a></span></span><span> </span><span id="local-6989586621679414331"><span class="annot"><span class="annottext">ann :: Maybe InjectivityAnn
</span><a href="#local-6989586621679414331"><span class="hs-identifier hs-var">ann</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TypeFamilyHead -&gt; Dec
</span><span class="hs-identifier hs-var">OpenTypeFamilyD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
-&gt; [TyVarBndr]
-&gt; FamilyResultSig
-&gt; Maybe InjectivityAnn
-&gt; TypeFamilyHead
</span><span class="hs-identifier hs-var">TypeFamilyHead</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414334"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; TyVarBndr) -&gt; [DTyVarBndr] -&gt; [TyVarBndr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; TyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679414333"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DFamilyResultSig -&gt; FamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#frsToTH"><span class="hs-identifier hs-var">frsToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DFamilyResultSig
</span><a href="#local-6989586621679414332"><span class="hs-identifier hs-var">frs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe InjectivityAnn
</span><a href="#local-6989586621679414331"><span class="hs-identifier hs-var">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">decToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DOpenTypeFamilyD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DTypeFamilyHead</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">frs</span><span> </span><span class="hs-identifier">_ann</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-special">[</span><span class="hs-identifier">FamilyD</span><span> </span><span class="hs-identifier">TypeFam</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">tvbToTH</span><span> </span><span class="hs-identifier">tvbs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">frsToTH</span><span> </span><span class="hs-identifier">frs</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDataFamilyD"><span class="hs-identifier hs-type">DDataFamilyD</span></a></span><span> </span><span id="local-6989586621679414326"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414326"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414325"><span class="annot"><span class="annottext">tvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679414325"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679414324"><span class="annot"><span class="annottext">mk :: Maybe DType
</span><a href="#local-6989586621679414324"><span class="hs-identifier hs-var">mk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [TyVarBndr] -&gt; Maybe Type -&gt; Dec
</span><span class="hs-identifier hs-var">DataFamilyD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414326"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; TyVarBndr) -&gt; [DTyVarBndr] -&gt; [TyVarBndr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; TyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679414325"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DType -&gt; Type) -&gt; Maybe DType -&gt; Maybe Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679414324"><span class="hs-identifier hs-var">mk</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span>  </span><span class="hs-special">[</span><span class="hs-identifier">FamilyD</span><span> </span><span class="hs-identifier">DataFam</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">tvbToTH</span><span> </span><span class="hs-identifier">tvbs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">mk</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDataInstD"><span class="hs-identifier hs-type">DDataInstD</span></a></span><span> </span><span id="local-6989586621679414321"><span class="annot"><span class="annottext">nd :: NewOrData
</span><a href="#local-6989586621679414321"><span class="hs-identifier hs-var">nd</span></a></span></span><span> </span><span id="local-6989586621679414320"><span class="annot"><span class="annottext">cxt :: DCxt
</span><a href="#local-6989586621679414320"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679414319"><span class="annot"><span class="annottext">mtvbs :: Maybe [DTyVarBndr]
</span><a href="#local-6989586621679414319"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679414318"><span class="annot"><span class="annottext">lhs :: DType
</span><a href="#local-6989586621679414318"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679414317"><span class="annot"><span class="annottext">mk :: Maybe DType
</span><a href="#local-6989586621679414317"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679414316"><span class="annot"><span class="annottext">cons :: [DCon]
</span><a href="#local-6989586621679414316"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679414315"><span class="annot"><span class="annottext">derivings :: [DDerivClause]
</span><a href="#local-6989586621679414315"><span class="hs-identifier hs-var">derivings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679414314"><span class="annot"><span class="annottext">ndc :: DNewOrDataCons
</span><a href="#local-6989586621679414314"><span class="hs-identifier hs-var hs-var">ndc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NewOrData
</span><a href="#local-6989586621679414321"><span class="hs-identifier hs-var">nd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DCon]
</span><a href="#local-6989586621679414316"><span class="hs-identifier hs-var">cons</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-139"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#Newtype"><span class="hs-identifier hs-type">Newtype</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621679414313"><span class="annot"><span class="annottext">con :: DCon
</span><a href="#local-6989586621679414313"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DCon -&gt; DNewOrDataCons
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#DNewtypeCon"><span class="hs-identifier hs-var">DNewtypeCon</span></a></span><span> </span><span class="annot"><span class="annottext">DCon
</span><a href="#local-6989586621679414313"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-140"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#Newtype"><span class="hs-identifier hs-type">Newtype</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; DNewOrDataCons
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Newtype that doesn't have only one constructor&quot;</span></span><span>
</span><span id="line-141"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span class="hs-special">,</span><span>    </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[DCon] -&gt; DNewOrDataCons
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#DDataCons"><span class="hs-identifier hs-var">DDataCons</span></a></span><span> </span><span class="annot"><span class="annottext">[DCon]
</span><a href="#local-6989586621679414316"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">DNewOrDataCons
-&gt; DCxt
-&gt; Maybe [DTyVarBndr]
-&gt; DType
-&gt; Maybe DType
-&gt; [DDerivClause]
-&gt; [Dec]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#dataInstDecToTH"><span class="hs-identifier hs-var">dataInstDecToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DNewOrDataCons
</span><a href="#local-6989586621679414314"><span class="hs-identifier hs-var">ndc</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679414320"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr]
</span><a href="#local-6989586621679414319"><span class="hs-identifier hs-var">mtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414318"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679414317"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="annot"><span class="annottext">[DDerivClause]
</span><a href="#local-6989586621679414315"><span class="hs-identifier hs-var">derivings</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTySynInstD"><span class="hs-identifier hs-type">DTySynInstD</span></a></span><span> </span><span id="local-6989586621679414307"><span class="annot"><span class="annottext">eqn :: DTySynEqn
</span><a href="#local-6989586621679414307"><span class="hs-identifier hs-var">eqn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TySynEqn -&gt; Dec
</span><span class="hs-identifier hs-var">TySynInstD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name, TySynEqn) -&gt; TySynEqn
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Name, TySynEqn) -&gt; TySynEqn) -&gt; (Name, TySynEqn) -&gt; TySynEqn
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DTySynEqn -&gt; (Name, TySynEqn)
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tySynEqnToTH"><span class="hs-identifier hs-var">tySynEqnToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DTySynEqn
</span><a href="#local-6989586621679414307"><span class="hs-identifier hs-var">eqn</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">decToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DTySynInstD</span><span> </span><span class="hs-identifier">eqn</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">eqn'</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">tySynEqnToTH</span><span> </span><span class="hs-identifier">eqn</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-special">[</span><span class="hs-identifier">TySynInstD</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">eqn'</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DClosedTypeFamilyD"><span class="hs-identifier hs-type">DClosedTypeFamilyD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTypeFamilyHead"><span class="hs-identifier hs-type">DTypeFamilyHead</span></a></span><span> </span><span id="local-6989586621679414303"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414303"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414302"><span class="annot"><span class="annottext">tvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679414302"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679414301"><span class="annot"><span class="annottext">frs :: DFamilyResultSig
</span><a href="#local-6989586621679414301"><span class="hs-identifier hs-var">frs</span></a></span></span><span> </span><span id="local-6989586621679414300"><span class="annot"><span class="annottext">ann :: Maybe InjectivityAnn
</span><a href="#local-6989586621679414300"><span class="hs-identifier hs-var">ann</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679414299"><span class="annot"><span class="annottext">eqns :: [DTySynEqn]
</span><a href="#local-6989586621679414299"><span class="hs-identifier hs-var">eqns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TypeFamilyHead -&gt; [TySynEqn] -&gt; Dec
</span><span class="hs-identifier hs-var">ClosedTypeFamilyD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
-&gt; [TyVarBndr]
-&gt; FamilyResultSig
-&gt; Maybe InjectivityAnn
-&gt; TypeFamilyHead
</span><span class="hs-identifier hs-var">TypeFamilyHead</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414303"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; TyVarBndr) -&gt; [DTyVarBndr] -&gt; [TyVarBndr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; TyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679414302"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DFamilyResultSig -&gt; FamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#frsToTH"><span class="hs-identifier hs-var">frsToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DFamilyResultSig
</span><a href="#local-6989586621679414301"><span class="hs-identifier hs-var">frs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe InjectivityAnn
</span><a href="#local-6989586621679414300"><span class="hs-identifier hs-var">ann</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DTySynEqn -&gt; TySynEqn) -&gt; [DTySynEqn] -&gt; [TySynEqn]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name, TySynEqn) -&gt; TySynEqn
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Name, TySynEqn) -&gt; TySynEqn)
-&gt; (DTySynEqn -&gt; (Name, TySynEqn)) -&gt; DTySynEqn -&gt; TySynEqn
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DTySynEqn -&gt; (Name, TySynEqn)
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tySynEqnToTH"><span class="hs-identifier hs-var">tySynEqnToTH</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DTySynEqn]
</span><a href="#local-6989586621679414299"><span class="hs-identifier hs-var">eqns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">decToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DClosedTypeFamilyD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DTypeFamilyHead</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">frs</span><span> </span><span class="hs-identifier">_ann</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">eqns</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-special">[</span><span class="hs-identifier">ClosedTypeFamilyD</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">tvbToTH</span><span> </span><span class="hs-identifier">tvbs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">frsToTH</span><span> </span><span class="hs-identifier">frs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">snd</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">tySynEqnToTH</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">eqns</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DRoleAnnotD"><span class="hs-identifier hs-type">DRoleAnnotD</span></a></span><span> </span><span id="local-6989586621679414295"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414295"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414294"><span class="annot"><span class="annottext">roles :: [Role]
</span><a href="#local-6989586621679414294"><span class="hs-identifier hs-var">roles</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Role] -&gt; Dec
</span><span class="hs-identifier hs-var">RoleAnnotD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414295"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679414294"><span class="hs-identifier hs-var">roles</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-160"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DStandaloneDerivD"><span class="hs-identifier hs-type">DStandaloneDerivD</span></a></span><span> </span><span id="local-6989586621679414291"><span class="annot"><span class="annottext">mds :: Maybe DDerivStrategy
</span><a href="#local-6989586621679414291"><span class="hs-identifier hs-var">mds</span></a></span></span><span> </span><span id="local-6989586621679414290"><span class="annot"><span class="annottext">mtvbs :: Maybe [DTyVarBndr]
</span><a href="#local-6989586621679414290"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679414289"><span class="annot"><span class="annottext">_cxt :: DCxt
</span><a href="#local-6989586621679414289"><span class="hs-identifier hs-var">_cxt</span></a></span></span><span> </span><span id="local-6989586621679414288"><span class="annot"><span class="annottext">_ty :: DType
</span><a href="#local-6989586621679414288"><span class="hs-identifier hs-var">_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe DDerivStrategy -&gt; DCxt -&gt; DType -&gt; Dec
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#standaloneDerivDToTH"><span class="hs-identifier hs-var">standaloneDerivDToTH</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DDerivStrategy
</span><a href="#local-6989586621679414291"><span class="hs-identifier hs-var">mds</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679414286"><span class="hs-identifier hs-var">cxt'</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414285"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679414286"><span class="annot"><span class="annottext">cxt' :: DCxt
</span><a href="#local-6989586621679414286"><span class="hs-identifier hs-var">cxt'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679414285"><span class="annot"><span class="annottext">ty' :: DType
</span><a href="#local-6989586621679414285"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr]
</span><a href="#local-6989586621679414290"><span class="hs-identifier hs-var">mtvbs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-164"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679414289"><span class="hs-identifier hs-var">_cxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414288"><span class="hs-identifier hs-var">_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679414284"><span class="annot"><span class="annottext">_tvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679414284"><span class="hs-identifier hs-var">_tvbs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 710 || __GLASGOW_HASKELL__ &gt;= 802
</span><span>                                </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-var">DForallT</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679414284"><span class="hs-identifier hs-var">_tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679414289"><span class="hs-identifier hs-var">_cxt</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414288"><span class="hs-identifier hs-var">_ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>                                </span><span class="hs-comment">-- See #117</span><span>
</span><span id="line-170"></span><span>                                </span><span class="hs-identifier">error</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-string">&quot;Explicit foralls in standalone deriving declarations &quot;</span><span>
</span><span id="line-171"></span><span>                                     </span><span class="hs-operator">++</span><span> </span><span class="hs-string">&quot;are broken on GHC 7.10 and 8.0.&quot;</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &lt; 709
</span><span class="hs-identifier">decToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DDefaultSigD</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Default method signatures supported only in GHC 7.10+&quot;</span><span class="hs-cpp">
#else
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDefaultSigD"><span class="hs-identifier hs-type">DDefaultSigD</span></a></span><span> </span><span id="local-6989586621679414282"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414282"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414281"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679414281"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Dec
</span><span class="hs-identifier hs-var">DefaultSigD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414282"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414281"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPatSynD"><span class="hs-identifier hs-type">DPatSynD</span></a></span><span> </span><span id="local-6989586621679414278"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414278"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414277"><span class="annot"><span class="annottext">args :: PatSynArgs
</span><a href="#local-6989586621679414277"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679414276"><span class="annot"><span class="annottext">dir :: DPatSynDir
</span><a href="#local-6989586621679414276"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621679414275"><span class="annot"><span class="annottext">pat :: DPat
</span><a href="#local-6989586621679414275"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; PatSynArgs -&gt; PatSynDir -&gt; Pat -&gt; Dec
</span><span class="hs-identifier hs-var">PatSynD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414278"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">PatSynArgs
</span><a href="#local-6989586621679414277"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPatSynDir -&gt; PatSynDir
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patSynDirToTH"><span class="hs-identifier hs-var">patSynDirToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DPatSynDir
</span><a href="#local-6989586621679414276"><span class="hs-identifier hs-var">dir</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679414275"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-181"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPatSynSigD"><span class="hs-identifier hs-type">DPatSynSigD</span></a></span><span> </span><span id="local-6989586621679414272"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414272"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414271"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679414271"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Dec
</span><span class="hs-identifier hs-var">PatSynSigD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414272"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414271"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">decToTH</span><span> </span><span class="hs-identifier">dec</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">DPatSynD</span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">dec</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">patSynErr</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">DPatSynSigD</span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">dec</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">patSynErr</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-identifier">patSynErr</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Pattern synonyms supported only in GHC 8.2+&quot;</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#decToTH"><span class="hs-identifier hs-var">decToTH</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Dec]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Newtype declaration without exactly 1 constructor.&quot;</span></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">-- | Indicates whether something is a newtype or data type, bundling its</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- constructor(s) along with it.</span><span>
</span><span id="line-193"></span><span class="hs-keyword">data</span><span> </span><span id="DNewOrDataCons"><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#DNewOrDataCons"><span class="hs-identifier hs-var">DNewOrDataCons</span></a></span></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="DNewtypeCon"><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#DNewtypeCon"><span class="hs-identifier hs-var">DNewtypeCon</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-type">DCon</span></a></span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DDataCons"><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#DDataCons"><span class="hs-identifier hs-var">DDataCons</span></a></span></span><span>   </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-type">DCon</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-comment">-- | Sweeten a 'DDataInstD'.</span><span>
</span><span id="line-198"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#dataInstDecToTH"><span class="hs-identifier hs-type">dataInstDecToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#DNewOrDataCons"><span class="hs-identifier hs-type">DNewOrDataCons</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-199"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDerivClause"><span class="hs-identifier hs-type">DDerivClause</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-200"></span><span id="dataInstDecToTH"><span class="annot"><span class="annottext">dataInstDecToTH :: DNewOrDataCons
-&gt; DCxt
-&gt; Maybe [DTyVarBndr]
-&gt; DType
-&gt; Maybe DType
-&gt; [DDerivClause]
-&gt; [Dec]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#dataInstDecToTH"><span class="hs-identifier hs-var hs-var">dataInstDecToTH</span></a></span></span><span> </span><span id="local-6989586621679414268"><span class="annot"><span class="annottext">ndc :: DNewOrDataCons
</span><a href="#local-6989586621679414268"><span class="hs-identifier hs-var">ndc</span></a></span></span><span> </span><span id="local-6989586621679414267"><span class="annot"><span class="annottext">cxt :: DCxt
</span><a href="#local-6989586621679414267"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679414266"><span class="annot"><span class="annottext">_mtvbs :: Maybe [DTyVarBndr]
</span><a href="#local-6989586621679414266"><span class="hs-identifier hs-var">_mtvbs</span></a></span></span><span> </span><span id="local-6989586621679414265"><span class="annot"><span class="annottext">lhs :: DType
</span><a href="#local-6989586621679414265"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679414264"><span class="annot"><span class="annottext">_mk :: Maybe DType
</span><a href="#local-6989586621679414264"><span class="hs-identifier hs-var">_mk</span></a></span></span><span> </span><span id="local-6989586621679414263"><span class="annot"><span class="annottext">derivings :: [DDerivClause]
</span><a href="#local-6989586621679414263"><span class="hs-identifier hs-var">derivings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DNewOrDataCons
</span><a href="#local-6989586621679414268"><span class="hs-identifier hs-var">ndc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#DNewtypeCon"><span class="hs-identifier hs-type">DNewtypeCon</span></a></span><span> </span><span id="local-6989586621679414262"><span class="annot"><span class="annottext">con :: DCon
</span><a href="#local-6989586621679414262"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Cxt
-&gt; Maybe [TyVarBndr]
-&gt; Type
-&gt; Maybe Type
-&gt; Con
-&gt; [DerivClause]
-&gt; Dec
</span><span class="hs-identifier hs-var">NewtypeInstD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DCxt -&gt; Cxt
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-var">cxtToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679414267"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([DTyVarBndr] -&gt; [TyVarBndr])
-&gt; Maybe [DTyVarBndr] -&gt; Maybe [TyVarBndr]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; TyVarBndr) -&gt; [DTyVarBndr] -&gt; [TyVarBndr]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; TyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr]
</span><a href="#local-6989586621679414266"><span class="hs-identifier hs-var">_mtvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414265"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DType -&gt; Type) -&gt; Maybe DType -&gt; Maybe Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679414264"><span class="hs-identifier hs-var">_mk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DCon -&gt; Con
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#conToTH"><span class="hs-identifier hs-var">conToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DCon
</span><a href="#local-6989586621679414262"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DDerivClause -&gt; [DerivClause]) -&gt; [DDerivClause] -&gt; [DerivClause]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">DDerivClause -&gt; [DerivClause]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivClauseToTH"><span class="hs-identifier hs-var">derivClauseToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DDerivClause]
</span><a href="#local-6989586621679414263"><span class="hs-identifier hs-var">derivings</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#elif __GLASGOW_HASKELL__ &gt; 710
</span><span>      </span><span class="hs-special">[</span><span class="hs-identifier">NewtypeInstD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cxtToTH</span><span> </span><span class="hs-identifier">cxt</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_n</span><span> </span><span class="hs-identifier">_lhs_args</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">_mk</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-identifier">con</span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>                    </span><span class="hs-special">(</span><span class="hs-identifier">concatMap</span><span> </span><span class="hs-identifier">derivClauseToTH</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span>      </span><span class="hs-special">[</span><span class="hs-identifier">NewtypeInstD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cxtToTH</span><span> </span><span class="hs-identifier">cxt</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_n</span><span> </span><span class="hs-identifier">_lhs_args</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-identifier">con</span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>                    </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">derivingToTH</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#DDataCons"><span class="hs-identifier hs-type">DDataCons</span></a></span><span> </span><span id="local-6989586621679414260"><span class="annot"><span class="annottext">cons :: [DCon]
</span><a href="#local-6989586621679414260"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Cxt
-&gt; Maybe [TyVarBndr]
-&gt; Type
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; Dec
</span><span class="hs-identifier hs-var">DataInstD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DCxt -&gt; Cxt
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-var">cxtToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679414267"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([DTyVarBndr] -&gt; [TyVarBndr])
-&gt; Maybe [DTyVarBndr] -&gt; Maybe [TyVarBndr]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; TyVarBndr) -&gt; [DTyVarBndr] -&gt; [TyVarBndr]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; TyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr]
</span><a href="#local-6989586621679414266"><span class="hs-identifier hs-var">_mtvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414265"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DType -&gt; Type) -&gt; Maybe DType -&gt; Maybe Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679414264"><span class="hs-identifier hs-var">_mk</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DCon -&gt; Con) -&gt; [DCon] -&gt; [Con]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DCon -&gt; Con
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#conToTH"><span class="hs-identifier hs-var">conToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DCon]
</span><a href="#local-6989586621679414260"><span class="hs-identifier hs-var">cons</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DDerivClause -&gt; [DerivClause]) -&gt; [DDerivClause] -&gt; [DerivClause]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">DDerivClause -&gt; [DerivClause]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivClauseToTH"><span class="hs-identifier hs-var">derivClauseToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DDerivClause]
</span><a href="#local-6989586621679414263"><span class="hs-identifier hs-var">derivings</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#elif __GLASGOW_HASKELL__ &gt; 710
</span><span>      </span><span class="hs-special">[</span><span class="hs-identifier">DataInstD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cxtToTH</span><span> </span><span class="hs-identifier">cxt</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_n</span><span> </span><span class="hs-identifier">_lhs_args</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">_mk</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-identifier">cons</span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>                 </span><span class="hs-special">(</span><span class="hs-identifier">concatMap</span><span> </span><span class="hs-identifier">derivClauseToTH</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span>      </span><span class="hs-special">[</span><span class="hs-identifier">DataInstD</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cxtToTH</span><span> </span><span class="hs-identifier">cxt</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_n</span><span> </span><span class="hs-identifier">_lhs_args</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-identifier">cons</span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>                 </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">derivingToTH</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621679414258"><span class="annot"><span class="annottext">_lhs' :: Type
</span><a href="#local-6989586621679414258"><span class="hs-identifier hs-var hs-var">_lhs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414265"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679414257"><span class="annot"><span class="annottext">_n :: Name
</span><a href="#local-6989586621679414257"><span class="hs-identifier hs-var">_n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679414256"><span class="annot"><span class="annottext">_lhs_args :: Cxt
</span><a href="#local-6989586621679414256"><span class="hs-identifier hs-var">_lhs_args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-230"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (Type, [TypeArg])
</span><a href="Language.Haskell.TH.Desugar.Util.html#unfoldType"><span class="hs-identifier hs-var">unfoldType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679414258"><span class="hs-identifier hs-var">_lhs'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-231"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679414253"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414253"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679414252"><span class="annot"><span class="annottext">lhs_args :: [TypeArg]
</span><a href="#local-6989586621679414252"><span class="hs-identifier hs-var">lhs_args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414253"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TypeArg] -&gt; Cxt
</span><a href="Language.Haskell.TH.Desugar.Util.html#filterTANormals"><span class="hs-identifier hs-var">filterTANormals</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679414252"><span class="hs-identifier hs-var">lhs_args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>        </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (Name, Cxt)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; (Name, Cxt)) -&gt; [Char] -&gt; (Name, Cxt)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Illegal data instance LHS: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Char]
forall a. Ppr a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">pprint</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679414258"><span class="hs-identifier hs-var">_lhs'</span></a></span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#frsToTH"><span class="hs-identifier hs-type">frsToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DFamilyResultSig"><span class="hs-identifier hs-type">DFamilyResultSig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FamilyResultSig</span></span><span>
</span><span id="line-236"></span><span id="frsToTH"><span class="annot"><span class="annottext">frsToTH :: DFamilyResultSig -&gt; FamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#frsToTH"><span class="hs-identifier hs-var hs-var">frsToTH</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DNoSig"><span class="hs-identifier hs-type">DNoSig</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FamilyResultSig
</span><span class="hs-identifier hs-var">NoSig</span></span><span>
</span><span id="line-237"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#frsToTH"><span class="hs-identifier hs-var">frsToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKindSig"><span class="hs-identifier hs-type">DKindSig</span></a></span><span> </span><span id="local-6989586621679414246"><span class="annot"><span class="annottext">k :: DType
</span><a href="#local-6989586621679414246"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; FamilyResultSig
</span><span class="hs-identifier hs-var">KindSig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414246"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#frsToTH"><span class="hs-identifier hs-var">frsToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarSig"><span class="hs-identifier hs-type">DTyVarSig</span></a></span><span> </span><span id="local-6989586621679414243"><span class="annot"><span class="annottext">tvb :: DTyVarBndr
</span><a href="#local-6989586621679414243"><span class="hs-identifier hs-var">tvb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; FamilyResultSig
</span><span class="hs-identifier hs-var">TyVarSig</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DTyVarBndr -&gt; TyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr
</span><a href="#local-6989586621679414243"><span class="hs-identifier hs-var">tvb</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">frsToTH</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DFamilyResultSig</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">Kind</span><span>
</span><span id="line-241"></span><span class="hs-identifier">frsToTH</span><span> </span><span class="hs-identifier">DNoSig</span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-242"></span><span class="hs-identifier">frsToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DKindSig</span><span> </span><span class="hs-identifier">k</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">k</span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span class="hs-identifier">frsToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DTyVarSig</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DPlainTV</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-244"></span><span class="hs-identifier">frsToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DTyVarSig</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DKindedTV</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">k</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">k</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt;= 710
</span><span class="hs-identifier">derivingToTH</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DDerivClause</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Name</span><span>
</span><span id="line-249"></span><span class="hs-identifier">derivingToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DDerivClause</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">DConT</span><span> </span><span class="hs-identifier">nm</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">nm</span><span>
</span><span id="line-250"></span><span class="hs-identifier">derivingToTH</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-identifier">error</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Template Haskell in GHC &lt; 8.0 only allows simple derivings: &quot;</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- | Note: This can currently only return a 'Nothing' if the 'DLetDec' is a pragma which</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- is not supported by the GHC version being used.</span><span>
</span><span id="line-256"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#letDecToTH"><span class="hs-identifier hs-type">letDecToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-type">DLetDec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span>
</span><span id="line-257"></span><span id="letDecToTH"><span class="annot"><span class="annottext">letDecToTH :: DLetDec -&gt; Maybe Dec
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#letDecToTH"><span class="hs-identifier hs-var hs-var">letDecToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DFunD"><span class="hs-identifier hs-type">DFunD</span></a></span><span> </span><span id="local-6989586621679414240"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679414240"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679414239"><span class="annot"><span class="annottext">clauses :: [DClause]
</span><a href="#local-6989586621679414239"><span class="hs-identifier hs-var">clauses</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; Maybe Dec
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; Maybe Dec) -&gt; Dec -&gt; Maybe Dec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Clause] -&gt; Dec
</span><span class="hs-identifier hs-var">FunD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414240"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DClause -&gt; Clause) -&gt; [DClause] -&gt; [Clause]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DClause -&gt; Clause
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#clauseToTH"><span class="hs-identifier hs-var">clauseToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DClause]
</span><a href="#local-6989586621679414239"><span class="hs-identifier hs-var">clauses</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#letDecToTH"><span class="hs-identifier hs-var">letDecToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DValD"><span class="hs-identifier hs-type">DValD</span></a></span><span> </span><span id="local-6989586621679414236"><span class="annot"><span class="annottext">pat :: DPat
</span><a href="#local-6989586621679414236"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679414235"><span class="annot"><span class="annottext">exp :: DExp
</span><a href="#local-6989586621679414235"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; Maybe Dec
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; Maybe Dec) -&gt; Dec -&gt; Maybe Dec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Body -&gt; [Dec] -&gt; Dec
</span><span class="hs-identifier hs-var">ValD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679414236"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Body
</span><span class="hs-identifier hs-var">NormalB</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679414235"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-259"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#letDecToTH"><span class="hs-identifier hs-var">letDecToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigD"><span class="hs-identifier hs-type">DSigD</span></a></span><span> </span><span id="local-6989586621679414232"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679414232"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679414231"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679414231"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; Maybe Dec
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; Maybe Dec) -&gt; Dec -&gt; Maybe Dec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Dec
</span><span class="hs-identifier hs-var">SigD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414232"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414231"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#letDecToTH"><span class="hs-identifier hs-var">letDecToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DInfixD"><span class="hs-identifier hs-type">DInfixD</span></a></span><span> </span><span id="local-6989586621679414228"><span class="annot"><span class="annottext">f :: Fixity
</span><a href="#local-6989586621679414228"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679414227"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679414227"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; Maybe Dec
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; Maybe Dec) -&gt; Dec -&gt; Maybe Dec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Fixity -&gt; Name -&gt; Dec
</span><span class="hs-identifier hs-var">InfixD</span></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621679414228"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414227"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-261"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#letDecToTH"><span class="hs-identifier hs-var">letDecToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPragmaD"><span class="hs-identifier hs-type">DPragmaD</span></a></span><span> </span><span id="local-6989586621679414224"><span class="annot"><span class="annottext">prag :: DPragma
</span><a href="#local-6989586621679414224"><span class="hs-identifier hs-var">prag</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pragma -&gt; Dec) -&gt; Maybe Pragma -&gt; Maybe Dec
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Pragma -&gt; Dec
</span><span class="hs-identifier hs-var">PragmaD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPragma -&gt; Maybe Pragma
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#pragmaToTH"><span class="hs-identifier hs-var">pragmaToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DPragma
</span><a href="#local-6989586621679414224"><span class="hs-identifier hs-var">prag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#conToTH"><span class="hs-identifier hs-type">conToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-type">DCon</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span id="conToTH"><span class="annot"><span class="annottext">conToTH :: DCon -&gt; Con
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#conToTH"><span class="hs-identifier hs-var hs-var">conToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-type">DCon</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679414221"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414221"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DNormalC"><span class="hs-identifier hs-type">DNormalC</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679414219"><span class="annot"><span class="annottext">stys :: [DBangType]
</span><a href="#local-6989586621679414219"><span class="hs-identifier hs-var">stys</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679414218"><span class="annot"><span class="annottext">rty :: DType
</span><a href="#local-6989586621679414218"><span class="hs-identifier hs-var">rty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-266"></span><span>  </span><span class="annot"><span class="annottext">[Name] -&gt; [BangType] -&gt; Type -&gt; Con
</span><span class="hs-identifier hs-var">GadtC</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414221"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DBangType -&gt; BangType) -&gt; [DBangType] -&gt; [BangType]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DType -&gt; Type) -&gt; DBangType -&gt; BangType
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DBangType]
</span><a href="#local-6989586621679414219"><span class="hs-identifier hs-var">stys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414218"><span class="hs-identifier hs-var">rty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#conToTH"><span class="hs-identifier hs-var">conToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-type">DCon</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679414215"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414215"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DRecC"><span class="hs-identifier hs-type">DRecC</span></a></span><span> </span><span id="local-6989586621679414213"><span class="annot"><span class="annottext">vstys :: [DVarBangType]
</span><a href="#local-6989586621679414213"><span class="hs-identifier hs-var">vstys</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679414212"><span class="annot"><span class="annottext">rty :: DType
</span><a href="#local-6989586621679414212"><span class="hs-identifier hs-var">rty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-268"></span><span>  </span><span class="annot"><span class="annottext">[Name] -&gt; [VarBangType] -&gt; Type -&gt; Con
</span><span class="hs-identifier hs-var">RecGadtC</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414215"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DVarBangType -&gt; VarBangType) -&gt; [DVarBangType] -&gt; [VarBangType]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DType -&gt; Type) -&gt; DVarBangType -&gt; VarBangType
forall a b c d. (a -&gt; b) -&gt; (c, d, a) -&gt; (c, d, b)
</span><a href="Language.Haskell.TH.Desugar.Util.html#thirdOf3"><span class="hs-identifier hs-var">thirdOf3</span></a></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DVarBangType]
</span><a href="#local-6989586621679414213"><span class="hs-identifier hs-var">vstys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414212"><span class="hs-identifier hs-var">rty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DCon</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DNormalC</span><span> </span><span class="hs-identifier">True</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">sty1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">sty2</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-identifier">InfixC</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">bangToStrict</span><span> </span><span class="hs-operator">***</span><span> </span><span class="hs-identifier">typeToTH</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">sty1</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">bangToStrict</span><span> </span><span class="hs-operator">***</span><span> </span><span class="hs-identifier">typeToTH</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">sty2</span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span class="hs-comment">-- Note: it's possible that someone could pass in a DNormalC value that</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- erroneously claims that it's declared infix (e.g., if has more than two</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- fields), but we will fall back on NormalC in such a scenario.</span><span>
</span><span id="line-275"></span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DCon</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DNormalC</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">stys</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-identifier">NormalC</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">bangToStrict</span><span> </span><span class="hs-operator">***</span><span> </span><span class="hs-identifier">typeToTH</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">stys</span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DCon</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DRecC</span><span> </span><span class="hs-identifier">vstys</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-identifier">RecC</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">v</span><span class="hs-special">,</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">t</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">v</span><span class="hs-special">,</span><span class="hs-identifier">bangToStrict</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">,</span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">vstys</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="hs-comment">-- On GHC 8.0 or later, we sweeten every constructor to GADT syntax, so it is</span><span>
</span><span id="line-282"></span><span class="hs-comment">-- perfectly OK to put all of the quantified type variables</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- (both universal and existential) in a ForallC.</span><span>
</span><span id="line-284"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#conToTH"><span class="hs-identifier hs-var">conToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-type">DCon</span></a></span><span> </span><span id="local-6989586621679414209"><span class="annot"><span class="annottext">tvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679414209"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679414208"><span class="annot"><span class="annottext">cxt :: DCxt
</span><a href="#local-6989586621679414208"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679414207"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414207"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414206"><span class="annot"><span class="annottext">fields :: DConFields
</span><a href="#local-6989586621679414206"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679414205"><span class="annot"><span class="annottext">rty :: DType
</span><a href="#local-6989586621679414205"><span class="hs-identifier hs-var">rty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-285"></span><span>  </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; Cxt -&gt; Con -&gt; Con
</span><span class="hs-identifier hs-var">ForallC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; TyVarBndr) -&gt; [DTyVarBndr] -&gt; [TyVarBndr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; TyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679414209"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DCxt -&gt; Cxt
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-var">cxtToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679414208"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DCon -&gt; Con
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#conToTH"><span class="hs-identifier hs-var">conToTH</span></a></span><span> </span><span class="annot"><span class="annottext">(DCon -&gt; Con) -&gt; DCon -&gt; Con
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; DCxt -&gt; Name -&gt; DConFields -&gt; DType -&gt; DCon
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-var">DCon</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414207"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">DConFields
</span><a href="#local-6989586621679414206"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414205"><span class="hs-identifier hs-var">rty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- On GHCs earlier than 8.0, we must be careful, since the only time ForallC is</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- used is when there are either:</span><span>
</span><span id="line-289"></span><span class="hs-comment">--</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- 1. Any existentially quantified type variables</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- 2. A constructor context</span><span>
</span><span id="line-292"></span><span class="hs-comment">--</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- If neither of these conditions hold, then we needn't put a ForallC at the</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- front, since it would be completely pointless (you'd end up with things like</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- @data Foo = forall. MkFoo@!).</span><span>
</span><span id="line-296"></span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DCon</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">fields</span><span> </span><span class="hs-identifier">rty</span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">ex_tvbs</span><span> </span><span class="hs-operator">&amp;&amp;</span><span> </span><span class="hs-identifier">null</span><span> </span><span class="hs-identifier">cxt</span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">con'</span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ForallC</span><span> </span><span class="hs-identifier">ex_tvbs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">cxtToTH</span><span> </span><span class="hs-identifier">cxt</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">con'</span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-comment">-- Fortunately, on old GHCs, it's especially easy to distinguish between</span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-comment">-- universally and existentially quantified type variables. When desugaring</span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-comment">-- a ForallC, we just stick all of the universals (from the datatype</span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-comment">-- definition) at the front of the @forall@. Therefore, it suffices to</span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-comment">-- count the number of type variables in the return type and drop that many</span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-comment">-- variables from the @forall@ in the ForallC, leaving only the</span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-comment">-- existentials.</span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-identifier">ex_tvbs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">TyVarBndr</span><span class="hs-special">]</span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-identifier">ex_tvbs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">tvbToTH</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">drop</span><span> </span><span class="hs-identifier">num_univ_tvs</span><span> </span><span class="hs-identifier">tvbs</span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span>    </span><span class="hs-identifier">num_univ_tvs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Int</span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-identifier">num_univ_tvs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">rty</span><span>
</span><span id="line-314"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-315"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DType</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span>
</span><span id="line-316"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DAppT</span><span> </span><span class="hs-identifier">t1</span><span> </span><span class="hs-identifier">t2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">t1</span><span> </span><span class="hs-operator">+</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">t2</span><span>
</span><span id="line-317"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DSigT</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-318"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DVarT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><span id="line-319"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DConT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><span id="line-320"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">DArrowT</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><span id="line-321"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DLitT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><span id="line-322"></span><span>        </span><span class="hs-comment">-- These won't show up on pre-8.0 GHCs</span><span>
</span><span id="line-323"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DForallT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;`forall` type used in GADT return type&quot;</span><span>
</span><span id="line-324"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">DWildCardT</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><span id="line-325"></span><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DAppKindT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-identifier">con'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Con</span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-identifier">con'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">conToTH</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">DCon</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">fields</span><span> </span><span class="hs-identifier">rty</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-331"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#instanceDToTH"><span class="hs-identifier hs-type">instanceDToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Overlap</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span>
</span><span id="line-332"></span><span id="instanceDToTH"><span class="annot"><span class="annottext">instanceDToTH :: Maybe Overlap -&gt; DCxt -&gt; DType -&gt; [DDec] -&gt; Dec
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#instanceDToTH"><span class="hs-identifier hs-var hs-var">instanceDToTH</span></a></span></span><span> </span><span id="local-6989586621679414203"><span class="annot"><span class="annottext">_over :: Maybe Overlap
</span><a href="#local-6989586621679414203"><span class="hs-identifier hs-var">_over</span></a></span></span><span> </span><span id="local-6989586621679414202"><span class="annot"><span class="annottext">cxt :: DCxt
</span><a href="#local-6989586621679414202"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679414201"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679414201"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679414200"><span class="annot"><span class="annottext">decs :: [DDec]
</span><a href="#local-6989586621679414200"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-333"></span><span>  </span><span class="annot"><span class="annottext">Maybe Overlap -&gt; Cxt -&gt; Type -&gt; [Dec] -&gt; Dec
</span><span class="hs-identifier hs-var">InstanceD</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>            </span><span class="annot"><span class="annottext">Maybe Overlap
</span><a href="#local-6989586621679414203"><span class="hs-identifier hs-var">_over</span></a></span><span class="hs-cpp">
#endif
</span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DCxt -&gt; Cxt
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-var">cxtToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679414202"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414201"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DDec] -&gt; [Dec]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#decsToTH"><span class="hs-identifier hs-var">decsToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679414200"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#standaloneDerivDToTH"><span class="hs-identifier hs-type">standaloneDerivDToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDerivStrategy"><span class="hs-identifier hs-type">DDerivStrategy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 710
</span><span id="standaloneDerivDToTH"><span class="annot"><span class="annottext">standaloneDerivDToTH :: Maybe DDerivStrategy -&gt; DCxt -&gt; DType -&gt; Dec
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#standaloneDerivDToTH"><span class="hs-identifier hs-var hs-var">standaloneDerivDToTH</span></a></span></span><span> </span><span id="local-6989586621679414198"><span class="annot"><span class="annottext">_mds :: Maybe DDerivStrategy
</span><a href="#local-6989586621679414198"><span class="hs-identifier hs-var">_mds</span></a></span></span><span> </span><span id="local-6989586621679414197"><span class="annot"><span class="annottext">cxt :: DCxt
</span><a href="#local-6989586621679414197"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679414196"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679414196"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-342"></span><span>  </span><span class="annot"><span class="annottext">Maybe DerivStrategy -&gt; Cxt -&gt; Type -&gt; Dec
</span><span class="hs-identifier hs-var">StandaloneDerivD</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 802
</span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DDerivStrategy -&gt; DerivStrategy)
-&gt; Maybe DDerivStrategy -&gt; Maybe DerivStrategy
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DDerivStrategy -&gt; DerivStrategy
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivStrategyToTH"><span class="hs-identifier hs-var">derivStrategyToTH</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DDerivStrategy
</span><a href="#local-6989586621679414198"><span class="hs-identifier hs-var">_mds</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DCxt -&gt; Cxt
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-var">cxtToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679414197"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414196"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">standaloneDerivDToTH</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Standalone deriving supported only in GHC 7.10+&quot;</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-351"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#foreignToTH"><span class="hs-identifier hs-type">foreignToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForeign"><span class="hs-identifier hs-type">DForeign</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foreign</span></span><span>
</span><span id="line-352"></span><span id="foreignToTH"><span class="annot"><span class="annottext">foreignToTH :: DForeign -&gt; Foreign
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#foreignToTH"><span class="hs-identifier hs-var hs-var">foreignToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DImportF"><span class="hs-identifier hs-type">DImportF</span></a></span><span> </span><span id="local-6989586621679414192"><span class="annot"><span class="annottext">cc :: Callconv
</span><a href="#local-6989586621679414192"><span class="hs-identifier hs-var">cc</span></a></span></span><span> </span><span id="local-6989586621679414191"><span class="annot"><span class="annottext">safety :: Safety
</span><a href="#local-6989586621679414191"><span class="hs-identifier hs-var">safety</span></a></span></span><span> </span><span id="local-6989586621679414190"><span class="annot"><span class="annottext">str :: [Char]
</span><a href="#local-6989586621679414190"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679414189"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414189"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414188"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679414188"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-353"></span><span>  </span><span class="annot"><span class="annottext">Callconv -&gt; Safety -&gt; [Char] -&gt; Name -&gt; Type -&gt; Foreign
</span><span class="hs-identifier hs-var">ImportF</span></span><span> </span><span class="annot"><span class="annottext">Callconv
</span><a href="#local-6989586621679414192"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">Safety
</span><a href="#local-6989586621679414191"><span class="hs-identifier hs-var">safety</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679414190"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414189"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414188"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#foreignToTH"><span class="hs-identifier hs-var">foreignToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExportF"><span class="hs-identifier hs-type">DExportF</span></a></span><span> </span><span id="local-6989586621679414185"><span class="annot"><span class="annottext">cc :: Callconv
</span><a href="#local-6989586621679414185"><span class="hs-identifier hs-var">cc</span></a></span></span><span> </span><span id="local-6989586621679414184"><span class="annot"><span class="annottext">str :: [Char]
</span><a href="#local-6989586621679414184"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679414183"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414183"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414182"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679414182"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Callconv -&gt; [Char] -&gt; Name -&gt; Type -&gt; Foreign
</span><span class="hs-identifier hs-var">ExportF</span></span><span> </span><span class="annot"><span class="annottext">Callconv
</span><a href="#local-6989586621679414185"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679414184"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414183"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414182"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#pragmaToTH"><span class="hs-identifier hs-type">pragmaToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPragma"><span class="hs-identifier hs-type">DPragma</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pragma</span></span><span>
</span><span id="line-357"></span><span id="pragmaToTH"><span class="annot"><span class="annottext">pragmaToTH :: DPragma -&gt; Maybe Pragma
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#pragmaToTH"><span class="hs-identifier hs-var hs-var">pragmaToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DInlineP"><span class="hs-identifier hs-type">DInlineP</span></a></span><span> </span><span id="local-6989586621679414179"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414179"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414178"><span class="annot"><span class="annottext">inl :: Inline
</span><a href="#local-6989586621679414178"><span class="hs-identifier hs-var">inl</span></a></span></span><span> </span><span id="local-6989586621679414177"><span class="annot"><span class="annottext">rm :: RuleMatch
</span><a href="#local-6989586621679414177"><span class="hs-identifier hs-var">rm</span></a></span></span><span> </span><span id="local-6989586621679414176"><span class="annot"><span class="annottext">phases :: Phases
</span><a href="#local-6989586621679414176"><span class="hs-identifier hs-var">phases</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pragma -&gt; Maybe Pragma
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Pragma -&gt; Maybe Pragma) -&gt; Pragma -&gt; Maybe Pragma
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Inline -&gt; RuleMatch -&gt; Phases -&gt; Pragma
</span><span class="hs-identifier hs-var">InlineP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414179"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Inline
</span><a href="#local-6989586621679414178"><span class="hs-identifier hs-var">inl</span></a></span><span> </span><span class="annot"><span class="annottext">RuleMatch
</span><a href="#local-6989586621679414177"><span class="hs-identifier hs-var">rm</span></a></span><span> </span><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679414176"><span class="hs-identifier hs-var">phases</span></a></span><span>
</span><span id="line-358"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#pragmaToTH"><span class="hs-identifier hs-var">pragmaToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSpecialiseP"><span class="hs-identifier hs-type">DSpecialiseP</span></a></span><span> </span><span id="local-6989586621679414173"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414173"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414172"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679414172"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679414171"><span class="annot"><span class="annottext">m_inl :: Maybe Inline
</span><a href="#local-6989586621679414171"><span class="hs-identifier hs-var">m_inl</span></a></span></span><span> </span><span id="local-6989586621679414170"><span class="annot"><span class="annottext">phases :: Phases
</span><a href="#local-6989586621679414170"><span class="hs-identifier hs-var">phases</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-359"></span><span>  </span><span class="annot"><span class="annottext">Pragma -&gt; Maybe Pragma
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Pragma -&gt; Maybe Pragma) -&gt; Pragma -&gt; Maybe Pragma
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Maybe Inline -&gt; Phases -&gt; Pragma
</span><span class="hs-identifier hs-var">SpecialiseP</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414173"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414172"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Inline
</span><a href="#local-6989586621679414171"><span class="hs-identifier hs-var">m_inl</span></a></span><span> </span><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679414170"><span class="hs-identifier hs-var">phases</span></a></span><span>
</span><span id="line-360"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#pragmaToTH"><span class="hs-identifier hs-var">pragmaToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSpecialiseInstP"><span class="hs-identifier hs-type">DSpecialiseInstP</span></a></span><span> </span><span id="local-6989586621679414167"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679414167"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pragma -&gt; Maybe Pragma
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Pragma -&gt; Maybe Pragma) -&gt; Pragma -&gt; Maybe Pragma
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Pragma
</span><span class="hs-identifier hs-var">SpecialiseInstP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414167"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#pragmaToTH"><span class="hs-identifier hs-var">pragmaToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DRuleP"><span class="hs-identifier hs-type">DRuleP</span></a></span><span> </span><span id="local-6989586621679414164"><span class="annot"><span class="annottext">str :: [Char]
</span><a href="#local-6989586621679414164"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679414163"><span class="annot"><span class="annottext">mtvbs :: Maybe [DTyVarBndr]
</span><a href="#local-6989586621679414163"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679414162"><span class="annot"><span class="annottext">rbs :: [DRuleBndr]
</span><a href="#local-6989586621679414162"><span class="hs-identifier hs-var">rbs</span></a></span></span><span> </span><span id="local-6989586621679414161"><span class="annot"><span class="annottext">lhs :: DExp
</span><a href="#local-6989586621679414161"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679414160"><span class="annot"><span class="annottext">rhs :: DExp
</span><a href="#local-6989586621679414160"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621679414159"><span class="annot"><span class="annottext">phases :: Phases
</span><a href="#local-6989586621679414159"><span class="hs-identifier hs-var">phases</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-363"></span><span>  </span><span class="annot"><span class="annottext">Pragma -&gt; Maybe Pragma
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Pragma -&gt; Maybe Pragma) -&gt; Pragma -&gt; Maybe Pragma
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
-&gt; Maybe [TyVarBndr]
-&gt; [RuleBndr]
-&gt; Exp
-&gt; Exp
-&gt; Phases
-&gt; Pragma
</span><span class="hs-identifier hs-var">RuleP</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679414164"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([DTyVarBndr] -&gt; [TyVarBndr])
-&gt; Maybe [DTyVarBndr] -&gt; Maybe [TyVarBndr]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; TyVarBndr) -&gt; [DTyVarBndr] -&gt; [TyVarBndr]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; TyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr]
</span><a href="#local-6989586621679414163"><span class="hs-identifier hs-var">mtvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DRuleBndr -&gt; RuleBndr) -&gt; [DRuleBndr] -&gt; [RuleBndr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DRuleBndr -&gt; RuleBndr
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#ruleBndrToTH"><span class="hs-identifier hs-var">ruleBndrToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DRuleBndr]
</span><a href="#local-6989586621679414162"><span class="hs-identifier hs-var">rbs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679414161"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679414160"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679414159"><span class="hs-identifier hs-var">phases</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">pragmaToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DRuleP</span><span> </span><span class="hs-identifier">str</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">rbs</span><span> </span><span class="hs-identifier">lhs</span><span> </span><span class="hs-identifier">rhs</span><span> </span><span class="hs-identifier">phases</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-367"></span><span>  </span><span class="hs-identifier">Just</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">RuleP</span><span> </span><span class="hs-identifier">str</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">ruleBndrToTH</span><span> </span><span class="hs-identifier">rbs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">expToTH</span><span> </span><span class="hs-identifier">lhs</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">expToTH</span><span> </span><span class="hs-identifier">rhs</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">phases</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#pragmaToTH"><span class="hs-identifier hs-var">pragmaToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAnnP"><span class="hs-identifier hs-type">DAnnP</span></a></span><span> </span><span id="local-6989586621679414156"><span class="annot"><span class="annottext">target :: AnnTarget
</span><a href="#local-6989586621679414156"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span id="local-6989586621679414155"><span class="annot"><span class="annottext">exp :: DExp
</span><a href="#local-6989586621679414155"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pragma -&gt; Maybe Pragma
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Pragma -&gt; Maybe Pragma) -&gt; Pragma -&gt; Maybe Pragma
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AnnTarget -&gt; Exp -&gt; Pragma
</span><span class="hs-identifier hs-var">AnnP</span></span><span> </span><span class="annot"><span class="annottext">AnnTarget
</span><a href="#local-6989586621679414156"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679414155"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 709
</span><span class="hs-identifier">pragmaToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DLineP</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Nothing</span><span class="hs-cpp">
#else
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#pragmaToTH"><span class="hs-identifier hs-var">pragmaToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLineP"><span class="hs-identifier hs-type">DLineP</span></a></span><span> </span><span id="local-6989586621679414152"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679414152"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414151"><span class="annot"><span class="annottext">str :: [Char]
</span><a href="#local-6989586621679414151"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pragma -&gt; Maybe Pragma
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Pragma -&gt; Maybe Pragma) -&gt; Pragma -&gt; Maybe Pragma
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char] -&gt; Pragma
</span><span class="hs-identifier hs-var">LineP</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679414152"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679414151"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &lt; 801
</span><span class="hs-identifier">pragmaToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DCompleteP</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Nothing</span><span class="hs-cpp">
#else
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#pragmaToTH"><span class="hs-identifier hs-var">pragmaToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCompleteP"><span class="hs-identifier hs-type">DCompleteP</span></a></span><span> </span><span id="local-6989586621679414148"><span class="annot"><span class="annottext">cls :: [Name]
</span><a href="#local-6989586621679414148"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span id="local-6989586621679414147"><span class="annot"><span class="annottext">mty :: Maybe Name
</span><a href="#local-6989586621679414147"><span class="hs-identifier hs-var">mty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pragma -&gt; Maybe Pragma
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Pragma -&gt; Maybe Pragma) -&gt; Pragma -&gt; Maybe Pragma
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Maybe Name -&gt; Pragma
</span><span class="hs-identifier hs-var">CompleteP</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679414148"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679414147"><span class="hs-identifier hs-var">mty</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-381"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#ruleBndrToTH"><span class="hs-identifier hs-type">ruleBndrToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DRuleBndr"><span class="hs-identifier hs-type">DRuleBndr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RuleBndr</span></span><span>
</span><span id="line-382"></span><span id="ruleBndrToTH"><span class="annot"><span class="annottext">ruleBndrToTH :: DRuleBndr -&gt; RuleBndr
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#ruleBndrToTH"><span class="hs-identifier hs-var hs-var">ruleBndrToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DRuleVar"><span class="hs-identifier hs-type">DRuleVar</span></a></span><span> </span><span id="local-6989586621679414144"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414144"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; RuleBndr
</span><span class="hs-identifier hs-var">RuleVar</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414144"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-383"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#ruleBndrToTH"><span class="hs-identifier hs-var">ruleBndrToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTypedRuleVar"><span class="hs-identifier hs-type">DTypedRuleVar</span></a></span><span> </span><span id="local-6989586621679414141"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414141"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414140"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679414140"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; RuleBndr
</span><span class="hs-identifier hs-var">TypedRuleVar</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414141"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414140"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="hs-comment">-- | It's convenient to also return a 'Name' here, since some call sites make</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- use of it.</span><span>
</span><span id="line-388"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#tySynEqnToTH"><span class="hs-identifier hs-type">tySynEqnToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTySynEqn"><span class="hs-identifier hs-type">DTySynEqn</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TySynEqn</span></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span id="tySynEqnToTH"><span class="annot"><span class="annottext">tySynEqnToTH :: DTySynEqn -&gt; (Name, TySynEqn)
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tySynEqnToTH"><span class="hs-identifier hs-var hs-var">tySynEqnToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTySynEqn"><span class="hs-identifier hs-type">DTySynEqn</span></a></span><span> </span><span id="local-6989586621679414137"><span class="annot"><span class="annottext">tvbs :: Maybe [DTyVarBndr]
</span><a href="#local-6989586621679414137"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679414136"><span class="annot"><span class="annottext">lhs :: DType
</span><a href="#local-6989586621679414136"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679414135"><span class="annot"><span class="annottext">rhs :: DType
</span><a href="#local-6989586621679414135"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679414134"><span class="annot"><span class="annottext">lhs' :: Type
</span><a href="#local-6989586621679414134"><span class="hs-identifier hs-var hs-var">lhs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414136"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (Type, [TypeArg])
</span><a href="Language.Haskell.TH.Desugar.Util.html#unfoldType"><span class="hs-identifier hs-var">unfoldType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679414134"><span class="hs-identifier hs-var">lhs'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-392"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679414133"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414133"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679414132"><span class="annot"><span class="annottext">_lhs_args :: [TypeArg]
</span><a href="#local-6989586621679414132"><span class="hs-identifier hs-var">_lhs_args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414133"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndr] -&gt; Type -&gt; Type -&gt; TySynEqn
</span><span class="hs-identifier hs-var">TySynEqn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([DTyVarBndr] -&gt; [TyVarBndr])
-&gt; Maybe [DTyVarBndr] -&gt; Maybe [TyVarBndr]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; TyVarBndr) -&gt; [DTyVarBndr] -&gt; [TyVarBndr]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; TyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr]
</span><a href="#local-6989586621679414137"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679414134"><span class="hs-identifier hs-var">lhs'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414135"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (Name, TySynEqn)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; (Name, TySynEqn)) -&gt; [Char] -&gt; (Name, TySynEqn)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Illegal type instance LHS: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Char]
forall a. Ppr a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">pprint</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679414134"><span class="hs-identifier hs-var">lhs'</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">tySynEqnToTH</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DTySynEqn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Name</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">TySynEqn</span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span class="hs-identifier">tySynEqnToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DTySynEqn</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">lhs</span><span> </span><span class="hs-identifier">rhs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">lhs'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">lhs</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">unfoldType</span><span> </span><span class="hs-identifier">lhs'</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-399"></span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">ConT</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">lhs_args</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">TySynEqn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">filterTANormals</span><span> </span><span class="hs-identifier">lhs_args</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">rhs</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-string">&quot;Illegal type instance LHS: &quot;</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-identifier">pprint</span><span> </span><span class="hs-identifier">lhs'</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-403"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#clauseToTH"><span class="hs-identifier hs-type">clauseToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DClause"><span class="hs-identifier hs-type">DClause</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Clause</span></span><span>
</span><span id="line-404"></span><span id="clauseToTH"><span class="annot"><span class="annottext">clauseToTH :: DClause -&gt; Clause
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#clauseToTH"><span class="hs-identifier hs-var hs-var">clauseToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DClause"><span class="hs-identifier hs-type">DClause</span></a></span><span> </span><span id="local-6989586621679414129"><span class="annot"><span class="annottext">pats :: [DPat]
</span><a href="#local-6989586621679414129"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span id="local-6989586621679414128"><span class="annot"><span class="annottext">exp :: DExp
</span><a href="#local-6989586621679414128"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; Body -&gt; [Dec] -&gt; Clause
</span><span class="hs-identifier hs-var">Clause</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DPat -&gt; Pat) -&gt; [DPat] -&gt; [Pat]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patToTH"><span class="hs-identifier hs-var">patToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679414129"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Body
</span><span class="hs-identifier hs-var">NormalB</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#expToTH"><span class="hs-identifier hs-var">expToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679414128"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-type">typeToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-407"></span><span id="typeToTH"><span class="annot"><span class="annottext">typeToTH :: DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var hs-var">typeToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-type">DForallT</span></a></span><span> </span><span id="local-6989586621679414126"><span class="annot"><span class="annottext">tvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679414126"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679414125"><span class="annot"><span class="annottext">cxt :: DCxt
</span><a href="#local-6989586621679414125"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679414124"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679414124"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; Cxt -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; TyVarBndr) -&gt; [DTyVarBndr] -&gt; [TyVarBndr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; TyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679414126"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DType -&gt; Type) -&gt; DCxt -&gt; Cxt
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679414125"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414124"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-type">DAppT</span></a></span><span> </span><span id="local-6989586621679414121"><span class="annot"><span class="annottext">t1 :: DType
</span><a href="#local-6989586621679414121"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679414120"><span class="annot"><span class="annottext">t2 :: DType
</span><a href="#local-6989586621679414120"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">AppT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414121"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414120"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigT"><span class="hs-identifier hs-type">DSigT</span></a></span><span> </span><span id="local-6989586621679414117"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679414117"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679414116"><span class="annot"><span class="annottext">ki :: DType
</span><a href="#local-6989586621679414116"><span class="hs-identifier hs-var">ki</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">SigT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414117"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414116"><span class="hs-identifier hs-var">ki</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-type">DVarT</span></a></span><span> </span><span id="local-6989586621679414113"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414113"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">VarT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414113"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-411"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-type">DConT</span></a></span><span> </span><span id="local-6989586621679414110"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414110"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tyconToTH"><span class="hs-identifier hs-var">tyconToTH</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414110"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-412"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DArrowT"><span class="hs-identifier hs-type">DArrowT</span></a></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ArrowT</span></span><span>
</span><span id="line-413"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-type">DLitT</span></a></span><span> </span><span id="local-6989586621679414105"><span class="annot"><span class="annottext">lit :: TyLit
</span><a href="#local-6989586621679414105"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; Type
</span><span class="hs-identifier hs-var">LitT</span></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621679414105"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DWildCardT"><span class="hs-identifier hs-type">DWildCardT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">WildCardT</span></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">DWildCardT</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Wildcards supported only in GHC 8.0+&quot;</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppKindT"><span class="hs-identifier hs-type">DAppKindT</span></a></span><span> </span><span id="local-6989586621679414100"><span class="annot"><span class="annottext">t :: DType
</span><a href="#local-6989586621679414100"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679414099"><span class="annot"><span class="annottext">k :: DType
</span><a href="#local-6989586621679414099"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">AppKindT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414100"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414099"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- In the event that we're on a version of Template Haskell without support for</span><span>
</span><span id="line-423"></span><span class="hs-comment">-- kind applications, we will simply drop the applied kind.</span><span>
</span><span id="line-424"></span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DAppKindT</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">t</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-427"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-type">tvbToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span>
</span><span id="line-428"></span><span id="tvbToTH"><span class="annot"><span class="annottext">tvbToTH :: DTyVarBndr -&gt; TyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var hs-var">tvbToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPlainTV"><span class="hs-identifier hs-type">DPlainTV</span></a></span><span> </span><span id="local-6989586621679414096"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414096"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; TyVarBndr
</span><span class="hs-identifier hs-var">PlainTV</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414096"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-429"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-type">DKindedTV</span></a></span><span> </span><span id="local-6989586621679414093"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414093"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414092"><span class="annot"><span class="annottext">k :: DType
</span><a href="#local-6989586621679414092"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; TyVarBndr
</span><span class="hs-identifier hs-var">KindedTV</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414093"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414092"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-type">cxtToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span>
</span><span id="line-432"></span><span id="cxtToTH"><span class="annot"><span class="annottext">cxtToTH :: DCxt -&gt; Cxt
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-var hs-var">cxtToTH</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; Type) -&gt; DCxt -&gt; Cxt
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivClauseToTH"><span class="hs-identifier hs-type">derivClauseToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDerivClause"><span class="hs-identifier hs-type">DDerivClause</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">DerivClause</span></span><span class="hs-special">]</span><span>
</span><span id="line-436"></span><span id="derivClauseToTH"><span class="annot"><span class="annottext">derivClauseToTH :: DDerivClause -&gt; [DerivClause]
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivClauseToTH"><span class="hs-identifier hs-var hs-var">derivClauseToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDerivClause"><span class="hs-identifier hs-type">DDerivClause</span></a></span><span> </span><span id="local-6989586621679414089"><span class="annot"><span class="annottext">mds :: Maybe DDerivStrategy
</span><a href="#local-6989586621679414089"><span class="hs-identifier hs-var">mds</span></a></span></span><span> </span><span id="local-6989586621679414088"><span class="annot"><span class="annottext">cxt :: DCxt
</span><a href="#local-6989586621679414088"><span class="hs-identifier hs-var">cxt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe DerivStrategy -&gt; Cxt -&gt; DerivClause
</span><span class="hs-identifier hs-var">DerivClause</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DDerivStrategy -&gt; DerivStrategy)
-&gt; Maybe DDerivStrategy -&gt; Maybe DerivStrategy
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DDerivStrategy -&gt; DerivStrategy
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivStrategyToTH"><span class="hs-identifier hs-var">derivStrategyToTH</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DDerivStrategy
</span><a href="#local-6989586621679414089"><span class="hs-identifier hs-var">mds</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DCxt -&gt; Cxt
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#cxtToTH"><span class="hs-identifier hs-var">cxtToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679414088"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">derivClauseToTH</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DDerivClause</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Cxt</span><span>
</span><span id="line-440"></span><span class="hs-identifier">derivClauseToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DDerivClause</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">cxt</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cxtToTH</span><span> </span><span class="hs-identifier">cxt</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivStrategyToTH"><span class="hs-identifier hs-type">derivStrategyToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDerivStrategy"><span class="hs-identifier hs-type">DDerivStrategy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DerivStrategy</span></span><span>
</span><span id="line-445"></span><span id="derivStrategyToTH"><span class="annot"><span class="annottext">derivStrategyToTH :: DDerivStrategy -&gt; DerivStrategy
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivStrategyToTH"><span class="hs-identifier hs-var hs-var">derivStrategyToTH</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DStockStrategy"><span class="hs-identifier hs-type">DStockStrategy</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DerivStrategy
</span><span class="hs-identifier hs-var">StockStrategy</span></span><span>
</span><span id="line-446"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivStrategyToTH"><span class="hs-identifier hs-var">derivStrategyToTH</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAnyclassStrategy"><span class="hs-identifier hs-type">DAnyclassStrategy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DerivStrategy
</span><span class="hs-identifier hs-var">AnyclassStrategy</span></span><span>
</span><span id="line-447"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivStrategyToTH"><span class="hs-identifier hs-var">derivStrategyToTH</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DNewtypeStrategy"><span class="hs-identifier hs-type">DNewtypeStrategy</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DerivStrategy
</span><span class="hs-identifier hs-var">NewtypeStrategy</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 805
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#derivStrategyToTH"><span class="hs-identifier hs-var">derivStrategyToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DViaStrategy"><span class="hs-identifier hs-type">DViaStrategy</span></a></span><span> </span><span id="local-6989586621679414079"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679414079"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; DerivStrategy
</span><span class="hs-identifier hs-var">ViaStrategy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414079"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">derivStrategyToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DViaStrategy</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;DerivingVia supported only in GHC 8.6+&quot;</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patSynDirToTH"><span class="hs-identifier hs-type">patSynDirToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPatSynDir"><span class="hs-identifier hs-type">DPatSynDir</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PatSynDir</span></span><span>
</span><span id="line-457"></span><span id="patSynDirToTH"><span class="annot"><span class="annottext">patSynDirToTH :: DPatSynDir -&gt; PatSynDir
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#patSynDirToTH"><span class="hs-identifier hs-var hs-var">patSynDirToTH</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DUnidir"><span class="hs-identifier hs-type">DUnidir</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatSynDir
</span><span class="hs-identifier hs-var">Unidir</span></span><span>
</span><span id="line-458"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patSynDirToTH"><span class="hs-identifier hs-var">patSynDirToTH</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DImplBidir"><span class="hs-identifier hs-type">DImplBidir</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PatSynDir
</span><span class="hs-identifier hs-var">ImplBidir</span></span><span>
</span><span id="line-459"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#patSynDirToTH"><span class="hs-identifier hs-var">patSynDirToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExplBidir"><span class="hs-identifier hs-type">DExplBidir</span></a></span><span> </span><span id="local-6989586621679414072"><span class="annot"><span class="annottext">clauses :: [DClause]
</span><a href="#local-6989586621679414072"><span class="hs-identifier hs-var">clauses</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Clause] -&gt; PatSynDir
</span><span class="hs-identifier hs-var">ExplBidir</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DClause -&gt; Clause) -&gt; [DClause] -&gt; [Clause]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DClause -&gt; Clause
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#clauseToTH"><span class="hs-identifier hs-var">clauseToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DClause]
</span><a href="#local-6989586621679414072"><span class="hs-identifier hs-var">clauses</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-462"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-type">predToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPred"><span class="hs-identifier hs-type">DPred</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pred</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 709
</span><span class="hs-identifier">predToTH</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-466"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">acc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DAppT</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">t</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">typeToTH</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">acc</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">p</span><span>
</span><span id="line-467"></span><span>    </span><span class="hs-comment">-- In the event that we're on a version of Template Haskell without support</span><span>
</span><span id="line-468"></span><span>    </span><span class="hs-comment">-- for kind applications, we will simply drop the applied kind.</span><span>
</span><span id="line-469"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">acc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DAppKindT</span><span> </span><span class="hs-identifier">t</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">acc</span><span> </span><span class="hs-identifier">t</span><span>
</span><span id="line-470"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">acc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DSigT</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">acc</span><span>                </span><span class="hs-identifier">p</span><span>  </span><span class="hs-comment">-- this shouldn't happen.</span><span>
</span><span id="line-471"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">acc</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DConT</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">nameBase</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-string">&quot;~&quot;</span><span>
</span><span id="line-473"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">t1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">t2</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">acc</span><span>
</span><span id="line-474"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">EqualP</span><span> </span><span class="hs-identifier">t1</span><span> </span><span class="hs-identifier">t2</span><span>
</span><span id="line-475"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">otherwise</span><span>
</span><span id="line-476"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ClassP</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">acc</span><span>
</span><span id="line-477"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">(</span><span class="hs-identifier">DVarT</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Template Haskell in GHC &lt;= 7.8 does not support variable constraints.&quot;</span><span>
</span><span id="line-479"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">DWildCardT</span><span>
</span><span id="line-480"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Wildcards supported only in GHC 8.0+&quot;</span><span>
</span><span id="line-481"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DForallT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Quantified constraints supported only in GHC 8.6+&quot;</span><span>
</span><span id="line-483"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">DArrowT</span><span>
</span><span id="line-484"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;(-&gt;) spotted at head of a constraint&quot;</span><span>
</span><span id="line-485"></span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DLitT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-486"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Type-level literal spotted at head of a constraint&quot;</span><span class="hs-cpp">
#else
</span><span id="predToTH"><span class="annot"><span class="annottext">predToTH :: DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var hs-var">predToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-type">DAppT</span></a></span><span> </span><span id="local-6989586621679414069"><span class="annot"><span class="annottext">p :: DType
</span><a href="#local-6989586621679414069"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679414068"><span class="annot"><span class="annottext">t :: DType
</span><a href="#local-6989586621679414068"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">AppT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414069"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414068"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigT"><span class="hs-identifier hs-type">DSigT</span></a></span><span> </span><span id="local-6989586621679414067"><span class="annot"><span class="annottext">p :: DType
</span><a href="#local-6989586621679414067"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679414066"><span class="annot"><span class="annottext">k :: DType
</span><a href="#local-6989586621679414066"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">SigT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414067"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414066"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-type">DVarT</span></a></span><span> </span><span id="local-6989586621679414065"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414065"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">VarT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414065"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-491"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-type">DConT</span></a></span><span> </span><span id="local-6989586621679414064"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414064"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414064"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DArrowT"><span class="hs-identifier hs-type">DArrowT</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ArrowT</span></span><span>
</span><span id="line-493"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-type">DLitT</span></a></span><span> </span><span id="local-6989586621679414063"><span class="annot"><span class="annottext">lit :: TyLit
</span><a href="#local-6989586621679414063"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; Type
</span><span class="hs-identifier hs-var">LitT</span></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621679414063"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DWildCardT"><span class="hs-identifier hs-type">DWildCardT</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">WildCardT</span></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">predToTH</span><span> </span><span class="hs-identifier">DWildCardT</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Wildcards supported only in GHC 8.0+&quot;</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 805
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-type">DForallT</span></a></span><span> </span><span id="local-6989586621679414062"><span class="annot"><span class="annottext">tvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679414062"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679414061"><span class="annot"><span class="annottext">cxt :: DCxt
</span><a href="#local-6989586621679414061"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679414060"><span class="annot"><span class="annottext">p :: DType
</span><a href="#local-6989586621679414060"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-501"></span><span>  </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; Cxt -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; TyVarBndr) -&gt; [DTyVarBndr] -&gt; [TyVarBndr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; TyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tvbToTH"><span class="hs-identifier hs-var">tvbToTH</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679414062"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DType -&gt; Type) -&gt; DCxt -&gt; Cxt
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679414061"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414060"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">predToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DForallT</span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">error</span><span> </span><span class="hs-string">&quot;Quantified constraints supported only in GHC 8.6+&quot;</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppKindT"><span class="hs-identifier hs-type">DAppKindT</span></a></span><span> </span><span id="local-6989586621679414059"><span class="annot"><span class="annottext">p :: DType
</span><a href="#local-6989586621679414059"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679414058"><span class="annot"><span class="annottext">k :: DType
</span><a href="#local-6989586621679414058"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><span class="hs-identifier hs-var">AppKindT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#predToTH"><span class="hs-identifier hs-var">predToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414059"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414058"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- In the event that we're on a version of Template Haskell without support for</span><span>
</span><span id="line-509"></span><span class="hs-comment">-- kind applications, we will simply drop the applied kind.</span><span>
</span><span id="line-510"></span><span class="hs-identifier">predToTH</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DAppKindT</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">predToTH</span><span> </span><span class="hs-identifier">p</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#endif
</span><span>
</span><span id="line-514"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#tyconToTH"><span class="hs-identifier hs-type">tyconToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-515"></span><span id="tyconToTH"><span class="annot"><span class="annottext">tyconToTH :: Name -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#tyconToTH"><span class="hs-identifier hs-var hs-var">tyconToTH</span></a></span></span><span> </span><span id="local-6989586621679414057"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679414057"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-516"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414057"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-glyph">-&gt;</span><span class="hs-special">)</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ArrowT</span></span><span> </span><span class="hs-comment">-- Work around Trac #14888</span><span>
</span><span id="line-517"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414057"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">''</span><span class="hs-special">[</span><span class="hs-special">]</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">ListT</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 709
</span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414057"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-glyph">~</span><span class="hs-special">)</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">EqualityT</span></span><span class="hs-cpp">
#endif
</span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414057"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">PromotedNilT</span></span><span>
</span><span id="line-522"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414057"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier hs-var">PromotedConsT</span></span><span>
</span><span id="line-523"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679414052"><span class="annot"><span class="annottext">deg :: Int
</span><a href="#local-6989586621679414052"><span class="hs-identifier hs-var">deg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#tupleNameDegree_maybe"><span class="hs-identifier hs-var">tupleNameDegree_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414057"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-524"></span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#isDataName"><span class="hs-identifier hs-var">isDataName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414057"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 805
</span><span>                                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type
</span><span class="hs-identifier hs-var">PromotedTupleT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679414052"><span class="hs-identifier hs-var">deg</span></a></span><span class="hs-cpp">
#else
</span><span>                                  </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">PromotedT</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-comment">-- Work around Trac #14843</span><span class="hs-cpp">
#endif
</span><span>                                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type
</span><span class="hs-identifier hs-var">TupleT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679414052"><span class="hs-identifier hs-var">deg</span></a></span><span>
</span><span id="line-531"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679414047"><span class="annot"><span class="annottext">deg :: Int
</span><a href="#local-6989586621679414047"><span class="hs-identifier hs-var">deg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedTupleNameDegree_maybe"><span class="hs-identifier hs-var">unboxedTupleNameDegree_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414057"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type
</span><span class="hs-identifier hs-var">UnboxedTupleT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679414047"><span class="hs-identifier hs-var">deg</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679414044"><span class="annot"><span class="annottext">deg :: Int
</span><a href="#local-6989586621679414044"><span class="hs-identifier hs-var">deg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Int
</span><a href="Language.Haskell.TH.Desugar.Util.html#unboxedSumNameDegree_maybe"><span class="hs-identifier hs-var">unboxedSumNameDegree_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414057"><span class="hs-identifier hs-var">n</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type
</span><span class="hs-identifier hs-var">UnboxedSumT</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679414044"><span class="hs-identifier hs-var">deg</span></a></span><span class="hs-cpp">
#endif
</span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679414057"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeArgToTH"><span class="hs-identifier hs-type">typeArgToTH</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span>
</span><span id="line-538"></span><span id="typeArgToTH"><span class="annot"><span class="annottext">typeArgToTH :: DTypeArg -&gt; TypeArg
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeArgToTH"><span class="hs-identifier hs-var hs-var">typeArgToTH</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-type">DTANormal</span></a></span><span> </span><span id="local-6989586621679414040"><span class="annot"><span class="annottext">t :: DType
</span><a href="#local-6989586621679414040"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TypeArg
</span><a href="Language.Haskell.TH.Desugar.Util.html#TANormal"><span class="hs-identifier hs-var">TANormal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414040"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeArgToTH"><span class="hs-identifier hs-var">typeArgToTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTyArg"><span class="hs-identifier hs-type">DTyArg</span></a></span><span> </span><span id="local-6989586621679414037"><span class="annot"><span class="annottext">k :: DType
</span><a href="#local-6989586621679414037"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; TypeArg
</span><a href="Language.Haskell.TH.Desugar.Util.html#TyArg"><span class="hs-identifier hs-var">TyArg</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; Type
</span><a href="Language.Haskell.TH.Desugar.Sweeten.html#typeToTH"><span class="hs-identifier hs-var">typeToTH</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679414037"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &lt;= 710
</span><span class="hs-comment">-- | Convert a 'Bang' to a 'Strict'</span><span>
</span><span id="line-543"></span><span class="hs-identifier">bangToStrict</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Bang</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Strict</span><span>
</span><span id="line-544"></span><span class="hs-identifier">bangToStrict</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Bang</span><span> </span><span class="hs-identifier">SourceUnpack</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Unpacked</span><span>
</span><span id="line-545"></span><span class="hs-identifier">bangToStrict</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Bang</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">SourceStrict</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">IsStrict</span><span>
</span><span id="line-546"></span><span class="hs-identifier">bangToStrict</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Bang</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">NotStrict</span><span class="hs-cpp">
#endif
</span></pre></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- Language/Haskell/TH/Desugar/Reify.hs

(c) Richard Eisenberg 2014
rae@cs.brynmawr.edu

Allows for reification from a list of declarations, without looking a name
up in the environment.
-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE CPP, GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Haskell.TH.Desugar.Reify</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-13"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Reification</span></span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals_maybe"><span class="hs-identifier">reifyWithLocals_maybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals"><span class="hs-identifier">reifyWithLocals</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithWarning"><span class="hs-identifier">reifyWithWarning</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDecs"><span class="hs-identifier">reifyInDecs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Fixity reification</span></span><span>
</span><span id="line-17"></span><span>  </span><span class="annot"><span class="hs-identifier">qReifyFixity</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">reifyFixity</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFixityWithLocals"><span class="hs-identifier">reifyFixityWithLocals</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFixityInDecs"><span class="hs-identifier">reifyFixityInDecs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Datatype lookup</span></span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#getDataD"><span class="hs-identifier">getDataD</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToCon"><span class="hs-identifier">dataConNameToCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToDataName"><span class="hs-identifier">dataConNameToDataName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Value and type lookup</span></span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#lookupValueNameWithLocals"><span class="hs-identifier">lookupValueNameWithLocals</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#lookupTypeNameWithLocals"><span class="hs-identifier">lookupTypeNameWithLocals</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#mkDataNameWithLocals"><span class="hs-identifier">mkDataNameWithLocals</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#mkTypeNameWithLocals"><span class="hs-identifier">mkTypeNameWithLocals</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyNameSpace"><span class="hs-identifier">reifyNameSpace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Monad support</span></span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier">DsMonad</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsM"><span class="hs-identifier">DsM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#withLocalDeclarations"><span class="hs-identifier">withLocalDeclarations</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Fail</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Fail</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Writer</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.RWS</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Instances</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">on</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 709
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Applicative</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Datatype</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Instances</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Syntax</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">lift</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.Util</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">-- | Like @reify@ from Template Haskell, but looks also in any not-yet-typechecked</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- declarations. To establish this list of not-yet-typechecked declarations,</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- use 'withLocalDeclarations'. Returns 'Nothing' if reification fails.</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- Note that no inferred type information is available from local declarations;</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- bottoms may be used if necessary.</span><span>
</span><span id="line-56"></span><span id="local-6989586621679412291"><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals_maybe"><span class="hs-identifier hs-type">reifyWithLocals_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679412291"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679412291"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Info</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-57"></span><span id="reifyWithLocals_maybe"><span class="annot"><span class="annottext">reifyWithLocals_maybe :: Name -&gt; q (Maybe Info)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals_maybe"><span class="hs-identifier hs-var hs-var">reifyWithLocals_maybe</span></a></span></span><span> </span><span id="local-6989586621679412079"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679412079"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">q (Maybe Info) -&gt; q (Maybe Info) -&gt; q (Maybe Info)
forall (m :: * -&gt; *) a. Quasi m =&gt; m a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">qRecover</span></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Info -&gt; q (Maybe Info)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Info -&gt; q (Maybe Info))
-&gt; ([Dec] -&gt; Maybe Info) -&gt; [Dec] -&gt; q (Maybe Info)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; Maybe Info
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDecs"><span class="hs-identifier hs-var">reifyInDecs</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412079"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">([Dec] -&gt; q (Maybe Info)) -&gt; q [Dec] -&gt; q (Maybe Info)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">q [Dec]
forall (m :: * -&gt; *). DsMonad m =&gt; m [Dec]
</span><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier hs-var">localDeclarations</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Info -&gt; Maybe Info
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Info -&gt; Maybe Info) -&gt; q Info -&gt; q (Maybe Info)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Info
forall (m :: * -&gt; *). Quasi m =&gt; Name -&gt; m Info
</span><span class="hs-identifier hs-var">qReify</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412079"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- | Like 'reifyWithLocals_maybe', but throws an exception upon failure,</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- warning the user about separating splices.</span><span>
</span><span id="line-63"></span><span id="local-6989586621679412274"><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals"><span class="hs-identifier hs-type">reifyWithLocals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679412274"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679412274"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Info</span></span></span><span>
</span><span id="line-64"></span><span id="reifyWithLocals"><span class="annot"><span class="annottext">reifyWithLocals :: Name -&gt; q Info
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals"><span class="hs-identifier hs-var hs-var">reifyWithLocals</span></a></span></span><span> </span><span id="local-6989586621679412073"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679412073"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-65"></span><span>  </span><span id="local-6989586621679412072"><span class="annot"><span class="annottext">Maybe Info
</span><a href="#local-6989586621679412072"><span class="hs-identifier hs-var">m_info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q (Maybe Info)
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q (Maybe Info)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals_maybe"><span class="hs-identifier hs-var">reifyWithLocals_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412073"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Info
</span><a href="#local-6989586621679412072"><span class="hs-identifier hs-var">m_info</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Info
forall (m :: * -&gt; *) a. MonadFail m =&gt; Name -&gt; m a
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFail"><span class="hs-identifier hs-var">reifyFail</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412073"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679412070"><span class="annot"><span class="annottext">i :: Info
</span><a href="#local-6989586621679412070"><span class="hs-identifier hs-var">i</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Info -&gt; q Info
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679412070"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- | Reify a declaration, warning the user about splices if the reify fails.</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- The warning says that reification can fail if you try to reify a type in</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- the same splice as it is declared.</span><span>
</span><span id="line-73"></span><span id="local-6989586621679412069"><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithWarning"><span class="hs-identifier hs-type">reifyWithWarning</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Quasi</span></span><span> </span><span class="annot"><a href="#local-6989586621679412069"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fail.MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679412069"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679412069"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Info</span></span></span><span>
</span><span id="line-74"></span><span id="reifyWithWarning"><span class="annot"><span class="annottext">reifyWithWarning :: Name -&gt; q Info
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithWarning"><span class="hs-identifier hs-var hs-var">reifyWithWarning</span></a></span></span><span> </span><span id="local-6989586621679412068"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679412068"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">q Info -&gt; q Info -&gt; q Info
forall (m :: * -&gt; *) a. Quasi m =&gt; m a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">qRecover</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; q Info
forall (m :: * -&gt; *) a. MonadFail m =&gt; Name -&gt; m a
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFail"><span class="hs-identifier hs-var">reifyFail</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412068"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; q Info
forall (m :: * -&gt; *). Quasi m =&gt; Name -&gt; m Info
</span><span class="hs-identifier hs-var">qReify</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412068"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | Print out a warning about separating splices and fail.</span><span>
</span><span id="line-77"></span><span id="local-6989586621679412289"><span id="local-6989586621679412290"><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFail"><span class="hs-identifier hs-type">reifyFail</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fail.MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679412290"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679412290"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679412289"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-78"></span><span id="reifyFail"><span class="annot"><span class="annottext">reifyFail :: Name -&gt; m a
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFail"><span class="hs-identifier hs-var hs-var">reifyFail</span></a></span></span><span> </span><span id="local-6989586621679412067"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679412067"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; m a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">Fail.fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m a) -&gt; String -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Looking up &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412067"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; in the list of available &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-80"></span><span>              </span><span class="annot"><span class="hs-string">&quot;declarations failed.\nThis lookup fails if the declaration &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-81"></span><span>              </span><span class="annot"><span class="hs-string">&quot;referenced was made in the same Template\nHaskell splice as the use &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-82"></span><span>              </span><span class="annot"><span class="hs-string">&quot;of the declaration. If this is the case, put\nthe reference to &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-83"></span><span>              </span><span class="annot"><span class="hs-string">&quot;the declaration in a new splice.&quot;</span></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">---------------------------------</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- Utilities</span><span>
</span><span id="line-87"></span><span class="hs-comment">---------------------------------</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- | Extract the @TyVarBndr@s and constructors given the @Name@ of a type</span><span>
</span><span id="line-90"></span><span id="local-6989586621679412254"><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#getDataD"><span class="hs-identifier hs-type">getDataD</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679412254"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-91"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>       </span><span class="hs-comment">-- ^ Print this out on failure</span><span>
</span><span id="line-92"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>         </span><span class="hs-comment">-- ^ Name of the datatype (@data@ or @newtype@) of interest</span><span>
</span><span id="line-93"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679412254"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-94"></span><span id="getDataD"><span class="annot"><span class="annottext">getDataD :: String -&gt; Name -&gt; q ([TyVarBndr], [Con])
</span><a href="Language.Haskell.TH.Desugar.Reify.html#getDataD"><span class="hs-identifier hs-var hs-var">getDataD</span></a></span></span><span> </span><span id="local-6989586621679412065"><span class="annot"><span class="annottext">err :: String
</span><a href="#local-6989586621679412065"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span id="local-6989586621679412064"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679412064"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-95"></span><span>  </span><span id="local-6989586621679412063"><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679412063"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Info
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q Info
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals"><span class="hs-identifier hs-var">reifyWithLocals</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412064"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-96"></span><span>  </span><span id="local-6989586621679412062"><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679412062"><span class="hs-identifier hs-var">dec</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679412063"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-97"></span><span>           </span><span class="annot"><span class="hs-identifier hs-type">TyConI</span></span><span> </span><span id="local-6989586621679412060"><span class="annot"><span class="annottext">dec :: Dec
</span><a href="#local-6989586621679412060"><span class="hs-identifier hs-var">dec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q Dec
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679412060"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-98"></span><span>           </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">q Dec
forall a. q a
</span><a href="#local-6989586621679412059"><span class="hs-identifier hs-var">badDeclaration</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679412062"><span class="hs-identifier hs-var">dec</span></a></span><span> </span><span class="hs-keyword">of</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span>    </span><span class="annot"><span class="hs-identifier hs-type">DataD</span></span><span> </span><span id="local-6989586621679412057"><span class="annot"><span class="annottext">_cxt :: Cxt
</span><a href="#local-6989586621679412057"><span class="hs-identifier hs-var">_cxt</span></a></span></span><span> </span><span id="local-6989586621679412056"><span class="annot"><span class="annottext">_name :: Name
</span><a href="#local-6989586621679412056"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679412055"><span class="annot"><span class="annottext">tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679412055"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679412054"><span class="annot"><span class="annottext">mk :: Maybe Kind
</span><a href="#local-6989586621679412054"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679412053"><span class="annot"><span class="annottext">cons :: [Con]
</span><a href="#local-6989586621679412053"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679412052"><span class="annot"><span class="annottext">_derivings :: [DerivClause]
</span><a href="#local-6989586621679412052"><span class="hs-identifier hs-var">_derivings</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; Maybe Kind -&gt; [Con] -&gt; q ([TyVarBndr], [Con])
forall (m :: * -&gt; *) b.
Quasi m =&gt;
[TyVarBndr] -&gt; Maybe Kind -&gt; b -&gt; m ([TyVarBndr], b)
</span><a href="#local-6989586621679412051"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679412055"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Kind
</span><a href="#local-6989586621679412054"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679412053"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">NewtypeD</span></span><span> </span><span id="local-6989586621679412049"><span class="annot"><span class="annottext">_cxt :: Cxt
</span><a href="#local-6989586621679412049"><span class="hs-identifier hs-var">_cxt</span></a></span></span><span> </span><span id="local-6989586621679412048"><span class="annot"><span class="annottext">_name :: Name
</span><a href="#local-6989586621679412048"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679412047"><span class="annot"><span class="annottext">tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679412047"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679412046"><span class="annot"><span class="annottext">mk :: Maybe Kind
</span><a href="#local-6989586621679412046"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679412045"><span class="annot"><span class="annottext">con :: Con
</span><a href="#local-6989586621679412045"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621679412044"><span class="annot"><span class="annottext">_derivings :: [DerivClause]
</span><a href="#local-6989586621679412044"><span class="hs-identifier hs-var">_derivings</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; Maybe Kind -&gt; [Con] -&gt; q ([TyVarBndr], [Con])
forall (m :: * -&gt; *) b.
Quasi m =&gt;
[TyVarBndr] -&gt; Maybe Kind -&gt; b -&gt; m ([TyVarBndr], b)
</span><a href="#local-6989586621679412051"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679412047"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Kind
</span><a href="#local-6989586621679412046"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679412045"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-identifier">DataD</span><span> </span><span class="hs-identifier">_cxt</span><span> </span><span class="hs-identifier">_name</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">_derivings</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">cons</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-identifier">NewtypeD</span><span> </span><span class="hs-identifier">_cxt</span><span> </span><span class="hs-identifier">_name</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">_derivings</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">con</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">q ([TyVarBndr], [Con])
forall a. q a
</span><a href="#local-6989586621679412059"><span class="hs-identifier hs-var">badDeclaration</span></a></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-109"></span><span>    </span><span id="local-6989586621679412051"><span class="annot"><span class="annottext">go :: [TyVarBndr] -&gt; Maybe Kind -&gt; b -&gt; m ([TyVarBndr], b)
</span><a href="#local-6989586621679412051"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679412043"><span class="annot"><span class="annottext">tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679412043"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679412042"><span class="annot"><span class="annottext">mk :: Maybe Kind
</span><a href="#local-6989586621679412042"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679412041"><span class="annot"><span class="annottext">cons :: b
</span><a href="#local-6989586621679412041"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-110"></span><span>      </span><span id="local-6989586621679412040"><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679412040"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Kind -&gt; (Kind -&gt; m Kind) -&gt; Maybe Kind -&gt; m Kind
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; m Kind
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Kind
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#typeKindName"><span class="hs-identifier hs-var">typeKindName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q Kind -&gt; m Kind
forall (m :: * -&gt; *) a. Quasi m =&gt; Q a -&gt; m a
</span><span class="hs-identifier hs-var">runQ</span></span><span> </span><span class="annot"><span class="annottext">(Q Kind -&gt; m Kind) -&gt; (Kind -&gt; Q Kind) -&gt; Kind -&gt; m Kind
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Q Kind
</span><span class="hs-identifier hs-var">resolveTypeSynonyms</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Kind
</span><a href="#local-6989586621679412042"><span class="hs-identifier hs-var">mk</span></a></span><span>
</span><span id="line-111"></span><span>      </span><span id="local-6989586621679412034"><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679412034"><span class="hs-identifier hs-var">extra_tvbs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Kind -&gt; ([TyVarBndr], Cxt, Cxt, Kind))
-&gt; (Name -&gt; Kind -&gt; TyVarBndr) -&gt; Kind -&gt; m [TyVarBndr]
forall (q :: * -&gt; *) kind tyVarBndr pred.
Quasi q =&gt;
(kind -&gt; ([tyVarBndr], [pred], [kind], kind))
-&gt; (Name -&gt; kind -&gt; tyVarBndr) -&gt; kind -&gt; q [tyVarBndr]
</span><a href="Language.Haskell.TH.Desugar.Util.html#mkExtraKindBindersGeneric"><span class="hs-identifier hs-var">mkExtraKindBindersGeneric</span></a></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; ([TyVarBndr], Cxt, Cxt, Kind)
</span><a href="Language.Haskell.TH.Desugar.Util.html#unravelType"><span class="hs-identifier hs-var">unravelType</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Kind -&gt; TyVarBndr
</span><span class="hs-identifier hs-var">KindedTV</span></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679412040"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-112"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679412030"><span class="annot"><span class="annottext">all_tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679412030"><span class="hs-identifier hs-var hs-var">all_tvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679412043"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; [TyVarBndr] -&gt; [TyVarBndr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679412034"><span class="hs-identifier hs-var">extra_tvbs</span></a></span><span>
</span><span id="line-113"></span><span>      </span><span class="annot"><span class="annottext">([TyVarBndr], b) -&gt; m ([TyVarBndr], b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679412030"><span class="hs-identifier hs-var">all_tvbs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679412041"><span class="hs-identifier hs-var">cons</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span>    </span><span id="local-6989586621679412059"><span class="annot"><span class="annottext">badDeclaration :: q a
</span><a href="#local-6989586621679412059"><span class="hs-identifier hs-var hs-var">badDeclaration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-116"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; q a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q a) -&gt; String -&gt; q a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;The name (&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412064"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;) refers to something &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-117"></span><span>                 </span><span class="annot"><span class="hs-string">&quot;other than a datatype. &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679412065"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- | From the name of a data constructor, retrive the datatype definition it</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- is a part of.</span><span>
</span><span id="line-121"></span><span id="local-6989586621679412255"><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToDataName"><span class="hs-identifier hs-type">dataConNameToDataName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679412255"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679412255"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span></span><span>
</span><span id="line-122"></span><span id="dataConNameToDataName"><span class="annot"><span class="annottext">dataConNameToDataName :: Name -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToDataName"><span class="hs-identifier hs-var hs-var">dataConNameToDataName</span></a></span></span><span> </span><span id="local-6989586621679412029"><span class="annot"><span class="annottext">con_name :: Name
</span><a href="#local-6989586621679412029"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621679412028"><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679412028"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Info
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q Info
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals"><span class="hs-identifier hs-var">reifyWithLocals</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412029"><span class="hs-identifier hs-var">con_name</span></a></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679412028"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-keyword">of</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span>    </span><span class="annot"><span class="hs-identifier hs-type">DataConI</span></span><span> </span><span id="local-6989586621679412026"><span class="annot"><span class="annottext">_name :: Name
</span><a href="#local-6989586621679412026"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679412025"><span class="annot"><span class="annottext">_type :: Kind
</span><a href="#local-6989586621679412025"><span class="hs-identifier hs-var">_type</span></a></span></span><span> </span><span id="local-6989586621679412024"><span class="annot"><span class="annottext">parent_name :: Name
</span><a href="#local-6989586621679412024"><span class="hs-identifier hs-var">parent_name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Name
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412024"><span class="hs-identifier hs-var">parent_name</span></a></span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-identifier">DataConI</span><span> </span><span class="hs-identifier">_name</span><span> </span><span class="hs-identifier">_type</span><span> </span><span class="hs-identifier">parent_name</span><span> </span><span class="hs-identifier">_fixity</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">parent_name</span><span class="hs-cpp">
#endif
</span><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q Name) -&gt; String -&gt; q Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;The name &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412029"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot; does not appear to be &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-131"></span><span>                </span><span class="annot"><span class="hs-string">&quot;a data constructor.&quot;</span></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">-- | From the name of a data constructor, retrieve its definition as a @Con@</span><span>
</span><span id="line-134"></span><span id="local-6989586621679412023"><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToCon"><span class="hs-identifier hs-type">dataConNameToCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679412023"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679412023"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Con</span></span></span><span>
</span><span id="line-135"></span><span id="dataConNameToCon"><span class="annot"><span class="annottext">dataConNameToCon :: Name -&gt; q Con
</span><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToCon"><span class="hs-identifier hs-var hs-var">dataConNameToCon</span></a></span></span><span> </span><span id="local-6989586621679412022"><span class="annot"><span class="annottext">con_name :: Name
</span><a href="#local-6989586621679412022"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-comment">-- we need to get the field ordering from the constructor. We must reify</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-comment">-- the constructor to get the tycon, and then reify the tycon to get the `Con`s</span><span>
</span><span id="line-138"></span><span>  </span><span id="local-6989586621679412021"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412021"><span class="hs-identifier hs-var">type_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Name
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToDataName"><span class="hs-identifier hs-var">dataConNameToDataName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412022"><span class="hs-identifier hs-var">con_name</span></a></span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412020"><span class="annot"><span class="annottext">cons :: [Con]
</span><a href="#local-6989586621679412020"><span class="hs-identifier hs-var">cons</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; q ([TyVarBndr], [Con])
forall (q :: * -&gt; *).
DsMonad q =&gt;
String -&gt; Name -&gt; q ([TyVarBndr], [Con])
</span><a href="Language.Haskell.TH.Desugar.Reify.html#getDataD"><span class="hs-identifier hs-var">getDataD</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;This seems to be an error in GHC.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412021"><span class="hs-identifier hs-var">type_name</span></a></span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679412019"><span class="annot"><span class="annottext">m_con :: Maybe Con
</span><a href="#local-6989586621679412019"><span class="hs-identifier hs-var hs-var">m_con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Con -&gt; Bool) -&gt; [Con] -&gt; Maybe Con
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Bool) -&gt; [Name] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412022"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; Bool) -&gt; (Con -&gt; [Name]) -&gt; Con -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Con -&gt; [Name]
</span><a href="#local-6989586621679412016"><span class="hs-identifier hs-var">get_con_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679412020"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Con
</span><a href="#local-6989586621679412019"><span class="hs-identifier hs-var">m_con</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679412015"><span class="annot"><span class="annottext">con :: Con
</span><a href="#local-6989586621679412015"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Con -&gt; q Con
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679412015"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Con
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Datatype does not contain one of its own constructors.&quot;</span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-146"></span><span>    </span><span id="local-6989586621679412016"><span class="annot"><span class="annottext">get_con_name :: Con -&gt; [Name]
</span><a href="#local-6989586621679412016"><span class="hs-identifier hs-var hs-var">get_con_name</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NormalC</span></span><span> </span><span id="local-6989586621679412012"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679412012"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412012"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><a href="#local-6989586621679412016"><span class="hs-identifier hs-var">get_con_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecC</span></span><span> </span><span id="local-6989586621679412010"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679412010"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412010"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-148"></span><span>    </span><span class="annot"><a href="#local-6989586621679412016"><span class="hs-identifier hs-var">get_con_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixC</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679412008"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679412008"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412008"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><a href="#local-6989586621679412016"><span class="hs-identifier hs-var">get_con_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallC</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679412006"><span class="annot"><span class="annottext">con :: Con
</span><a href="#local-6989586621679412006"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Con -&gt; [Name]
</span><a href="#local-6989586621679412016"><span class="hs-identifier hs-var">get_con_name</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679412006"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span>    </span><span class="annot"><a href="#local-6989586621679412016"><span class="hs-identifier hs-var">get_con_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GadtC</span></span><span> </span><span id="local-6989586621679412004"><span class="annot"><span class="annottext">names :: [Name]
</span><a href="#local-6989586621679412004"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679412004"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><a href="#local-6989586621679412016"><span class="hs-identifier hs-var">get_con_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecGadtC</span></span><span> </span><span id="local-6989586621679412002"><span class="annot"><span class="annottext">names :: [Name]
</span><a href="#local-6989586621679412002"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679412002"><span class="hs-identifier hs-var">names</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-155"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- DsMonad</span><span>
</span><span id="line-157"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">-- | A 'DsMonad' stores some list of declarations that should be considered</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- in scope. 'DsM' is the prototypical inhabitant of 'DsMonad'.</span><span>
</span><span id="line-161"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Quasi</span></span><span> </span><span class="annot"><a href="#local-6989586621679412298"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fail.MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679412298"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="DsMonad"><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-var">DsMonad</span></a></span></span><span> </span><span id="local-6989586621679412298"><span class="annot"><a href="#local-6989586621679412298"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-comment">-- | Produce a list of local declarations.</span><span>
</span><span id="line-163"></span><span>  </span><span id="localDeclarations"><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier hs-type">localDeclarations</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679412298"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-166"></span><span>  </span><span id="local-6989586621679411997"><span class="annot"><span class="annottext">localDeclarations :: Q [Dec]
</span><a href="#local-6989586621679411997"><span class="hs-identifier hs-var hs-var hs-var hs-var">localDeclarations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; Q [Dec]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-167"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-168"></span><span>  </span><span id="local-6989586621679411993"><span class="annot"><span class="annottext">localDeclarations :: IO [Dec]
</span><a href="#local-6989586621679411993"><span class="hs-identifier hs-var hs-var hs-var hs-var">localDeclarations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; IO [Dec]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">-- | A convenient implementation of the 'DsMonad' class. Use by calling</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- 'withLocalDeclarations'.</span><span>
</span><span id="line-172"></span><span class="hs-keyword">newtype</span><span> </span><span id="DsM"><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsM"><span class="hs-identifier hs-var">DsM</span></a></span></span><span> </span><span id="local-6989586621679412174"><span class="annot"><a href="#local-6989586621679412174"><span class="hs-identifier hs-type">q</span></a></span></span><span> </span><span id="local-6989586621679412173"><span class="annot"><a href="#local-6989586621679412173"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DsM"><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsM"><span class="hs-identifier hs-var">DsM</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679412174"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679412173"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span> </span><span id="local-6989586621679411988"><span id="local-6989586621679411990"><span class="annot"><span class="annottext">a -&gt; DsM q b -&gt; DsM q a
(a -&gt; b) -&gt; DsM q a -&gt; DsM q b
(forall a b. (a -&gt; b) -&gt; DsM q a -&gt; DsM q b)
-&gt; (forall a b. a -&gt; DsM q b -&gt; DsM q a) -&gt; Functor (DsM q)
forall a b. a -&gt; DsM q b -&gt; DsM q a
forall a b. (a -&gt; b) -&gt; DsM q a -&gt; DsM q b
forall (q :: * -&gt; *) a b. Functor q =&gt; a -&gt; DsM q b -&gt; DsM q a
forall (q :: * -&gt; *) a b.
Functor q =&gt;
(a -&gt; b) -&gt; DsM q a -&gt; DsM q b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; DsM q b -&gt; DsM q a
$c&lt;$ :: forall (q :: * -&gt; *) a b. Functor q =&gt; a -&gt; DsM q b -&gt; DsM q a
fmap :: (a -&gt; b) -&gt; DsM q a -&gt; DsM q b
$cfmap :: forall (q :: * -&gt; *) a b.
Functor q =&gt;
(a -&gt; b) -&gt; DsM q a -&gt; DsM q b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679411976"><span id="local-6989586621679411978"><span id="local-6989586621679411980"><span id="local-6989586621679411982"><span id="local-6989586621679411984"><span class="annot"><span class="annottext">Functor (DsM q)
a -&gt; DsM q a
Functor (DsM q) =&gt;
(forall a. a -&gt; DsM q a)
-&gt; (forall a b. DsM q (a -&gt; b) -&gt; DsM q a -&gt; DsM q b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; DsM q a -&gt; DsM q b -&gt; DsM q c)
-&gt; (forall a b. DsM q a -&gt; DsM q b -&gt; DsM q b)
-&gt; (forall a b. DsM q a -&gt; DsM q b -&gt; DsM q a)
-&gt; Applicative (DsM q)
DsM q a -&gt; DsM q b -&gt; DsM q b
DsM q a -&gt; DsM q b -&gt; DsM q a
DsM q (a -&gt; b) -&gt; DsM q a -&gt; DsM q b
(a -&gt; b -&gt; c) -&gt; DsM q a -&gt; DsM q b -&gt; DsM q c
forall a. a -&gt; DsM q a
forall a b. DsM q a -&gt; DsM q b -&gt; DsM q a
forall a b. DsM q a -&gt; DsM q b -&gt; DsM q b
forall a b. DsM q (a -&gt; b) -&gt; DsM q a -&gt; DsM q b
forall a b c. (a -&gt; b -&gt; c) -&gt; DsM q a -&gt; DsM q b -&gt; DsM q c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
forall (q :: * -&gt; *). Applicative q =&gt; Functor (DsM q)
forall (q :: * -&gt; *) a. Applicative q =&gt; a -&gt; DsM q a
forall (q :: * -&gt; *) a b.
Applicative q =&gt;
DsM q a -&gt; DsM q b -&gt; DsM q a
forall (q :: * -&gt; *) a b.
Applicative q =&gt;
DsM q a -&gt; DsM q b -&gt; DsM q b
forall (q :: * -&gt; *) a b.
Applicative q =&gt;
DsM q (a -&gt; b) -&gt; DsM q a -&gt; DsM q b
forall (q :: * -&gt; *) a b c.
Applicative q =&gt;
(a -&gt; b -&gt; c) -&gt; DsM q a -&gt; DsM q b -&gt; DsM q c
&lt;* :: DsM q a -&gt; DsM q b -&gt; DsM q a
$c&lt;* :: forall (q :: * -&gt; *) a b.
Applicative q =&gt;
DsM q a -&gt; DsM q b -&gt; DsM q a
*&gt; :: DsM q a -&gt; DsM q b -&gt; DsM q b
$c*&gt; :: forall (q :: * -&gt; *) a b.
Applicative q =&gt;
DsM q a -&gt; DsM q b -&gt; DsM q b
liftA2 :: (a -&gt; b -&gt; c) -&gt; DsM q a -&gt; DsM q b -&gt; DsM q c
$cliftA2 :: forall (q :: * -&gt; *) a b c.
Applicative q =&gt;
(a -&gt; b -&gt; c) -&gt; DsM q a -&gt; DsM q b -&gt; DsM q c
&lt;*&gt; :: DsM q (a -&gt; b) -&gt; DsM q a -&gt; DsM q b
$c&lt;*&gt; :: forall (q :: * -&gt; *) a b.
Applicative q =&gt;
DsM q (a -&gt; b) -&gt; DsM q a -&gt; DsM q b
pure :: a -&gt; DsM q a
$cpure :: forall (q :: * -&gt; *) a. Applicative q =&gt; a -&gt; DsM q a
$cp1Applicative :: forall (q :: * -&gt; *). Applicative q =&gt; Functor (DsM q)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679411968"><span id="local-6989586621679411970"><span id="local-6989586621679411972"><span class="annot"><span class="annottext">Applicative (DsM q)
a -&gt; DsM q a
Applicative (DsM q) =&gt;
(forall a b. DsM q a -&gt; (a -&gt; DsM q b) -&gt; DsM q b)
-&gt; (forall a b. DsM q a -&gt; DsM q b -&gt; DsM q b)
-&gt; (forall a. a -&gt; DsM q a)
-&gt; Monad (DsM q)
DsM q a -&gt; (a -&gt; DsM q b) -&gt; DsM q b
DsM q a -&gt; DsM q b -&gt; DsM q b
forall a. a -&gt; DsM q a
forall a b. DsM q a -&gt; DsM q b -&gt; DsM q b
forall a b. DsM q a -&gt; (a -&gt; DsM q b) -&gt; DsM q b
forall (q :: * -&gt; *). Monad q =&gt; Applicative (DsM q)
forall (q :: * -&gt; *) a. Monad q =&gt; a -&gt; DsM q a
forall (q :: * -&gt; *) a b. Monad q =&gt; DsM q a -&gt; DsM q b -&gt; DsM q b
forall (q :: * -&gt; *) a b.
Monad q =&gt;
DsM q a -&gt; (a -&gt; DsM q b) -&gt; DsM q b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: a -&gt; DsM q a
$creturn :: forall (q :: * -&gt; *) a. Monad q =&gt; a -&gt; DsM q a
&gt;&gt; :: DsM q a -&gt; DsM q b -&gt; DsM q b
$c&gt;&gt; :: forall (q :: * -&gt; *) a b. Monad q =&gt; DsM q a -&gt; DsM q b -&gt; DsM q b
&gt;&gt;= :: DsM q a -&gt; (a -&gt; DsM q b) -&gt; DsM q b
$c&gt;&gt;= :: forall (q :: * -&gt; *) a b.
Monad q =&gt;
DsM q a -&gt; (a -&gt; DsM q b) -&gt; DsM q b
$cp1Monad :: forall (q :: * -&gt; *). Monad q =&gt; Applicative (DsM q)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679411965"><span class="annot"><span class="annottext">m a -&gt; DsM m a
(forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; DsM m a)
-&gt; MonadTrans DsM
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; DsM m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *).
(forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; t m a) -&gt; MonadTrans t
lift :: m a -&gt; DsM m a
$clift :: forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; DsM m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">MonadTrans</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679411916"><span id="local-6989586621679411918"><span id="local-6989586621679411920"><span id="local-6989586621679411922"><span id="local-6989586621679411924"><span id="local-6989586621679411926"><span id="local-6989586621679411928"><span id="local-6989586621679411930"><span id="local-6989586621679411932"><span id="local-6989586621679411934"><span id="local-6989586621679411936"><span id="local-6989586621679411938"><span id="local-6989586621679411940"><span id="local-6989586621679411942"><span id="local-6989586621679411944"><span id="local-6989586621679411946"><span id="local-6989586621679411948"><span id="local-6989586621679411950"><span id="local-6989586621679411952"><span id="local-6989586621679411954"><span id="local-6989586621679411956"><span id="local-6989586621679411958"><span id="local-6989586621679411960"><span class="annot"><span class="annottext">MonadFail (DsM q)
MonadIO (DsM q)
DsM q [Extension]
DsM q (Maybe a)
DsM q Loc
a -&gt; DsM q ()
Bool -&gt; String -&gt; DsM q (Maybe Name)
Bool -&gt; String -&gt; DsM q ()
String -&gt; DsM q String
String -&gt; DsM q Name
String -&gt; DsM q ()
[Dec] -&gt; DsM q ()
IO a -&gt; DsM q a
Q () -&gt; DsM q ()
Name -&gt; DsM q [DecidedStrictness]
Name -&gt; DsM q [Role]
Name -&gt; DsM q (Maybe Fixity)
Name -&gt; DsM q Info
Name -&gt; Cxt -&gt; DsM q [Dec]
(MonadIO (DsM q), MonadFail (DsM q)) =&gt;
(String -&gt; DsM q Name)
-&gt; (Bool -&gt; String -&gt; DsM q ())
-&gt; (forall a. DsM q a -&gt; DsM q a -&gt; DsM q a)
-&gt; (Bool -&gt; String -&gt; DsM q (Maybe Name))
-&gt; (Name -&gt; DsM q Info)
-&gt; (Name -&gt; DsM q (Maybe Fixity))
-&gt; (Name -&gt; Cxt -&gt; DsM q [Dec])
-&gt; (Name -&gt; DsM q [Role])
-&gt; (forall a. Data a =&gt; AnnLookup -&gt; DsM q [a])
-&gt; (Module -&gt; DsM q ModuleInfo)
-&gt; (Name -&gt; DsM q [DecidedStrictness])
-&gt; DsM q Loc
-&gt; (forall a. IO a -&gt; DsM q a)
-&gt; (String -&gt; DsM q ())
-&gt; (String -&gt; DsM q String)
-&gt; ([Dec] -&gt; DsM q ())
-&gt; (ForeignSrcLang -&gt; String -&gt; DsM q ())
-&gt; (Q () -&gt; DsM q ())
-&gt; (String -&gt; DsM q ())
-&gt; (forall a. Typeable a =&gt; DsM q (Maybe a))
-&gt; (forall a. Typeable a =&gt; a -&gt; DsM q ())
-&gt; (Extension -&gt; DsM q Bool)
-&gt; DsM q [Extension]
-&gt; Quasi (DsM q)
Extension -&gt; DsM q Bool
ForeignSrcLang -&gt; String -&gt; DsM q ()
Module -&gt; DsM q ModuleInfo
AnnLookup -&gt; DsM q [a]
DsM q a -&gt; DsM q a -&gt; DsM q a
forall a. Data a =&gt; AnnLookup -&gt; DsM q [a]
forall a. Typeable a =&gt; DsM q (Maybe a)
forall a. Typeable a =&gt; a -&gt; DsM q ()
forall a. IO a -&gt; DsM q a
forall a. DsM q a -&gt; DsM q a -&gt; DsM q a
forall (m :: * -&gt; *).
(MonadIO m, MonadFail m) =&gt;
(String -&gt; m Name)
-&gt; (Bool -&gt; String -&gt; m ())
-&gt; (forall a. m a -&gt; m a -&gt; m a)
-&gt; (Bool -&gt; String -&gt; m (Maybe Name))
-&gt; (Name -&gt; m Info)
-&gt; (Name -&gt; m (Maybe Fixity))
-&gt; (Name -&gt; Cxt -&gt; m [Dec])
-&gt; (Name -&gt; m [Role])
-&gt; (forall a. Data a =&gt; AnnLookup -&gt; m [a])
-&gt; (Module -&gt; m ModuleInfo)
-&gt; (Name -&gt; m [DecidedStrictness])
-&gt; m Loc
-&gt; (forall a. IO a -&gt; m a)
-&gt; (String -&gt; m ())
-&gt; (String -&gt; m String)
-&gt; ([Dec] -&gt; m ())
-&gt; (ForeignSrcLang -&gt; String -&gt; m ())
-&gt; (Q () -&gt; m ())
-&gt; (String -&gt; m ())
-&gt; (forall a. Typeable a =&gt; m (Maybe a))
-&gt; (forall a. Typeable a =&gt; a -&gt; m ())
-&gt; (Extension -&gt; m Bool)
-&gt; m [Extension]
-&gt; Quasi m
forall (q :: * -&gt; *). Quasi q =&gt; MonadFail (DsM q)
forall (q :: * -&gt; *). Quasi q =&gt; MonadIO (DsM q)
forall (q :: * -&gt; *). Quasi q =&gt; DsM q [Extension]
forall (q :: * -&gt; *). Quasi q =&gt; DsM q Loc
forall (q :: * -&gt; *).
Quasi q =&gt;
Bool -&gt; String -&gt; DsM q (Maybe Name)
forall (q :: * -&gt; *). Quasi q =&gt; Bool -&gt; String -&gt; DsM q ()
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; DsM q String
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; DsM q Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; DsM q ()
forall (q :: * -&gt; *). Quasi q =&gt; [Dec] -&gt; DsM q ()
forall (q :: * -&gt; *). Quasi q =&gt; Q () -&gt; DsM q ()
forall (q :: * -&gt; *). Quasi q =&gt; Name -&gt; DsM q [DecidedStrictness]
forall (q :: * -&gt; *). Quasi q =&gt; Name -&gt; DsM q [Role]
forall (q :: * -&gt; *). Quasi q =&gt; Name -&gt; DsM q (Maybe Fixity)
forall (q :: * -&gt; *). Quasi q =&gt; Name -&gt; DsM q Info
forall (q :: * -&gt; *). Quasi q =&gt; Name -&gt; Cxt -&gt; DsM q [Dec]
forall (q :: * -&gt; *). Quasi q =&gt; Extension -&gt; DsM q Bool
forall (q :: * -&gt; *).
Quasi q =&gt;
ForeignSrcLang -&gt; String -&gt; DsM q ()
forall (q :: * -&gt; *). Quasi q =&gt; Module -&gt; DsM q ModuleInfo
forall (q :: * -&gt; *) a. (Quasi q, Data a) =&gt; AnnLookup -&gt; DsM q [a]
forall (q :: * -&gt; *) a. (Quasi q, Typeable a) =&gt; DsM q (Maybe a)
forall (q :: * -&gt; *) a. (Quasi q, Typeable a) =&gt; a -&gt; DsM q ()
forall (q :: * -&gt; *) a. Quasi q =&gt; IO a -&gt; DsM q a
forall (q :: * -&gt; *) a. Quasi q =&gt; DsM q a -&gt; DsM q a -&gt; DsM q a
qExtsEnabled :: DsM q [Extension]
$cqExtsEnabled :: forall (q :: * -&gt; *). Quasi q =&gt; DsM q [Extension]
qIsExtEnabled :: Extension -&gt; DsM q Bool
$cqIsExtEnabled :: forall (q :: * -&gt; *). Quasi q =&gt; Extension -&gt; DsM q Bool
qPutQ :: a -&gt; DsM q ()
$cqPutQ :: forall (q :: * -&gt; *) a. (Quasi q, Typeable a) =&gt; a -&gt; DsM q ()
qGetQ :: DsM q (Maybe a)
$cqGetQ :: forall (q :: * -&gt; *) a. (Quasi q, Typeable a) =&gt; DsM q (Maybe a)
qAddCorePlugin :: String -&gt; DsM q ()
$cqAddCorePlugin :: forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; DsM q ()
qAddModFinalizer :: Q () -&gt; DsM q ()
$cqAddModFinalizer :: forall (q :: * -&gt; *). Quasi q =&gt; Q () -&gt; DsM q ()
qAddForeignFilePath :: ForeignSrcLang -&gt; String -&gt; DsM q ()
$cqAddForeignFilePath :: forall (q :: * -&gt; *).
Quasi q =&gt;
ForeignSrcLang -&gt; String -&gt; DsM q ()
qAddTopDecls :: [Dec] -&gt; DsM q ()
$cqAddTopDecls :: forall (q :: * -&gt; *). Quasi q =&gt; [Dec] -&gt; DsM q ()
qAddTempFile :: String -&gt; DsM q String
$cqAddTempFile :: forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; DsM q String
qAddDependentFile :: String -&gt; DsM q ()
$cqAddDependentFile :: forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; DsM q ()
qRunIO :: IO a -&gt; DsM q a
$cqRunIO :: forall (q :: * -&gt; *) a. Quasi q =&gt; IO a -&gt; DsM q a
qLocation :: DsM q Loc
$cqLocation :: forall (q :: * -&gt; *). Quasi q =&gt; DsM q Loc
qReifyConStrictness :: Name -&gt; DsM q [DecidedStrictness]
$cqReifyConStrictness :: forall (q :: * -&gt; *). Quasi q =&gt; Name -&gt; DsM q [DecidedStrictness]
qReifyModule :: Module -&gt; DsM q ModuleInfo
$cqReifyModule :: forall (q :: * -&gt; *). Quasi q =&gt; Module -&gt; DsM q ModuleInfo
qReifyAnnotations :: AnnLookup -&gt; DsM q [a]
$cqReifyAnnotations :: forall (q :: * -&gt; *) a. (Quasi q, Data a) =&gt; AnnLookup -&gt; DsM q [a]
qReifyRoles :: Name -&gt; DsM q [Role]
$cqReifyRoles :: forall (q :: * -&gt; *). Quasi q =&gt; Name -&gt; DsM q [Role]
qReifyInstances :: Name -&gt; Cxt -&gt; DsM q [Dec]
$cqReifyInstances :: forall (q :: * -&gt; *). Quasi q =&gt; Name -&gt; Cxt -&gt; DsM q [Dec]
qReifyFixity :: Name -&gt; DsM q (Maybe Fixity)
$cqReifyFixity :: forall (q :: * -&gt; *). Quasi q =&gt; Name -&gt; DsM q (Maybe Fixity)
qReify :: Name -&gt; DsM q Info
$cqReify :: forall (q :: * -&gt; *). Quasi q =&gt; Name -&gt; DsM q Info
qLookupName :: Bool -&gt; String -&gt; DsM q (Maybe Name)
$cqLookupName :: forall (q :: * -&gt; *).
Quasi q =&gt;
Bool -&gt; String -&gt; DsM q (Maybe Name)
qRecover :: DsM q a -&gt; DsM q a -&gt; DsM q a
$cqRecover :: forall (q :: * -&gt; *) a. Quasi q =&gt; DsM q a -&gt; DsM q a -&gt; DsM q a
qReport :: Bool -&gt; String -&gt; DsM q ()
$cqReport :: forall (q :: * -&gt; *). Quasi q =&gt; Bool -&gt; String -&gt; DsM q ()
qNewName :: String -&gt; DsM q Name
$cqNewName :: forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; DsM q Name
$cp2Quasi :: forall (q :: * -&gt; *). Quasi q =&gt; MonadFail (DsM q)
$cp1Quasi :: forall (q :: * -&gt; *). Quasi q =&gt; MonadIO (DsM q)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Quasi</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679411912"><span class="annot"><span class="annottext">Monad (DsM q)
Monad (DsM q) =&gt; (forall a. String -&gt; DsM q a) -&gt; MonadFail (DsM q)
String -&gt; DsM q a
forall a. String -&gt; DsM q a
forall (m :: * -&gt; *).
Monad m =&gt;
(forall a. String -&gt; m a) -&gt; MonadFail m
forall (q :: * -&gt; *). MonadFail q =&gt; Monad (DsM q)
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; DsM q a
fail :: String -&gt; DsM q a
$cfail :: forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; DsM q a
$cp1MonadFail :: forall (q :: * -&gt; *). MonadFail q =&gt; Monad (DsM q)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">Fail.MonadFail</span></span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 803
</span><span>           </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679411908"><span class="annot"><span class="annottext">Monad (DsM q)
Monad (DsM q) =&gt; (forall a. IO a -&gt; DsM q a) -&gt; MonadIO (DsM q)
IO a -&gt; DsM q a
forall a. IO a -&gt; DsM q a
forall (m :: * -&gt; *).
Monad m =&gt;
(forall a. IO a -&gt; m a) -&gt; MonadIO m
forall (q :: * -&gt; *). MonadIO q =&gt; Monad (DsM q)
forall (q :: * -&gt; *) a. MonadIO q =&gt; IO a -&gt; DsM q a
liftIO :: IO a -&gt; DsM q a
$cliftIO :: forall (q :: * -&gt; *) a. MonadIO q =&gt; IO a -&gt; DsM q a
$cp1MonadIO :: forall (q :: * -&gt; *). MonadIO q =&gt; Monad (DsM q)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadIO</span></span></span><span class="hs-cpp">
#endif
</span><span>           </span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span id="local-6989586621679411906"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Quasi</span></span><span> </span><span class="annot"><a href="#local-6989586621679411906"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fail.MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679411906"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679411906"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621679411902"><span class="annot"><span class="annottext">localDeclarations :: DsM q [Dec]
</span><a href="#local-6989586621679411902"><span class="hs-identifier hs-var hs-var hs-var hs-var">localDeclarations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT [Dec] q [Dec] -&gt; DsM q [Dec]
forall (q :: * -&gt; *) a. ReaderT [Dec] q a -&gt; DsM q a
</span><a href="Language.Haskell.TH.Desugar.Reify.html#DsM"><span class="hs-identifier hs-var">DsM</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT [Dec] q [Dec]
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span id="local-6989586621679411899"><span id="local-6989586621679411900"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679411900"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679411899"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679411900"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>  </span><span id="local-6989586621679411895"><span class="annot"><span class="annottext">localDeclarations :: ReaderT r m [Dec]
</span><a href="#local-6989586621679411895"><span class="hs-identifier hs-var hs-var hs-var hs-var">localDeclarations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [Dec] -&gt; ReaderT r m [Dec]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [Dec]
forall (m :: * -&gt; *). DsMonad m =&gt; m [Dec]
</span><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier hs-var">localDeclarations</span></a></span></span></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span id="local-6989586621679411892"><span id="local-6989586621679411893"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679411893"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="#local-6989586621679411892"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679411893"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-186"></span><span>  </span><span id="local-6989586621679411888"><span class="annot"><span class="annottext">localDeclarations :: StateT s m [Dec]
</span><a href="#local-6989586621679411888"><span class="hs-identifier hs-var hs-var hs-var hs-var">localDeclarations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [Dec] -&gt; StateT s m [Dec]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [Dec]
forall (m :: * -&gt; *). DsMonad m =&gt; m [Dec]
</span><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier hs-var">localDeclarations</span></a></span></span></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span id="local-6989586621679411886"><span id="local-6989586621679411887"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679411887"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679411886"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679411886"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679411887"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-189"></span><span>  </span><span id="local-6989586621679411882"><span class="annot"><span class="annottext">localDeclarations :: WriterT w m [Dec]
</span><a href="#local-6989586621679411882"><span class="hs-identifier hs-var hs-var hs-var hs-var">localDeclarations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [Dec] -&gt; WriterT w m [Dec]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [Dec]
forall (m :: * -&gt; *). DsMonad m =&gt; m [Dec]
</span><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier hs-var">localDeclarations</span></a></span></span></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span id="local-6989586621679411878"><span id="local-6989586621679411879"><span id="local-6989586621679411880"><span id="local-6989586621679411881"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679411881"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679411880"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RWST</span></span><span> </span><span class="annot"><a href="#local-6989586621679411879"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679411880"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679411878"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679411881"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-192"></span><span>  </span><span id="local-6989586621679411874"><span class="annot"><span class="annottext">localDeclarations :: RWST r w s m [Dec]
</span><a href="#local-6989586621679411874"><span class="hs-identifier hs-var hs-var hs-var hs-var">localDeclarations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [Dec] -&gt; RWST r w s m [Dec]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m [Dec]
forall (m :: * -&gt; *). DsMonad m =&gt; m [Dec]
</span><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier hs-var">localDeclarations</span></a></span></span></span></span></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- | Add a list of declarations to be considered when reifying local</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- declarations.</span><span>
</span><span id="line-196"></span><span id="local-6989586621679411872"><span id="local-6989586621679411873"><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#withLocalDeclarations"><span class="hs-identifier hs-type">withLocalDeclarations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679411873"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679411873"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679411872"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679411873"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679411872"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-197"></span><span id="withLocalDeclarations"><span class="annot"><span class="annottext">withLocalDeclarations :: [Dec] -&gt; DsM q a -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Reify.html#withLocalDeclarations"><span class="hs-identifier hs-var hs-var">withLocalDeclarations</span></a></span></span><span> </span><span id="local-6989586621679411871"><span class="annot"><span class="annottext">new_decs :: [Dec]
</span><a href="#local-6989586621679411871"><span class="hs-identifier hs-var">new_decs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsM"><span class="hs-identifier hs-type">DsM</span></a></span><span> </span><span id="local-6989586621679411870"><span class="annot"><span class="annottext">x :: ReaderT [Dec] q a
</span><a href="#local-6989586621679411870"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-198"></span><span>  </span><span id="local-6989586621679411869"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411869"><span class="hs-identifier hs-var">orig_decs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">q [Dec]
forall (m :: * -&gt; *). DsMonad m =&gt; m [Dec]
</span><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier hs-var">localDeclarations</span></a></span><span>
</span><span id="line-199"></span><span>  </span><span class="annot"><span class="annottext">ReaderT [Dec] q a -&gt; [Dec] -&gt; q a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">ReaderT [Dec] q a
</span><a href="#local-6989586621679411870"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411869"><span class="hs-identifier hs-var">orig_decs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; [Dec] -&gt; [Dec]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411871"><span class="hs-identifier hs-var">new_decs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">---------------------------</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- Reifying local declarations</span><span>
</span><span id="line-203"></span><span class="hs-comment">---------------------------</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">-- | Look through a list of declarations and possibly return a relevant 'Info'</span><span>
</span><span id="line-206"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDecs"><span class="hs-identifier hs-type">reifyInDecs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Info</span></span><span>
</span><span id="line-207"></span><span id="reifyInDecs"><span class="annot"><span class="annottext">reifyInDecs :: Name -&gt; [Dec] -&gt; Maybe Info
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDecs"><span class="hs-identifier hs-var hs-var">reifyInDecs</span></a></span></span><span> </span><span id="local-6989586621679411867"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411867"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411866"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679411866"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Info
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Name, Info) -&gt; Info) -&gt; Maybe (Name, Info) -&gt; Maybe Info
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">`fmap`</span></span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; Maybe (Name, Info)) -&gt; [Dec] -&gt; Maybe (Name, Info)
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; Maybe b
</span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; Dec -&gt; Maybe (Name, Info)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411867"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411866"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411866"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- | Look through a list of declarations and possibly return a fixity.</span><span>
</span><span id="line-210"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFixityInDecs"><span class="hs-identifier hs-type">reifyFixityInDecs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fixity</span></span><span>
</span><span id="line-211"></span><span id="reifyFixityInDecs"><span class="annot"><span class="annottext">reifyFixityInDecs :: Name -&gt; [Dec] -&gt; Maybe Fixity
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFixityInDecs"><span class="hs-identifier hs-var hs-var">reifyFixityInDecs</span></a></span></span><span> </span><span id="local-6989586621679411863"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411863"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; Maybe Fixity) -&gt; [Dec] -&gt; Maybe Fixity
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; Maybe b
</span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Dec -&gt; Maybe Fixity
</span><a href="#local-6989586621679411862"><span class="hs-identifier hs-var">match_fixity</span></a></span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679411862"><span class="annot"><span class="annottext">match_fixity :: Dec -&gt; Maybe Fixity
</span><a href="#local-6989586621679411862"><span class="hs-identifier hs-var hs-var">match_fixity</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixD</span></span><span> </span><span id="local-6989586621679411860"><span class="annot"><span class="annottext">fixity :: Fixity
</span><a href="#local-6989586621679411860"><span class="hs-identifier hs-var">fixity</span></a></span></span><span> </span><span id="local-6989586621679411859"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411859"><span class="hs-identifier hs-var">n'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411863"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411859"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fixity -&gt; Maybe Fixity
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621679411860"><span class="hs-identifier hs-var">fixity</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><a href="#local-6989586621679411862"><span class="hs-identifier hs-var">match_fixity</span></a></span><span> </span><span class="hs-identifier">_</span><span>                                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Fixity
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- | A reified thing along with the name of that thing.</span><span>
</span><span id="line-217"></span><span class="hs-keyword">type</span><span> </span><span id="Named"><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#Named"><span class="hs-identifier hs-var">Named</span></a></span></span><span> </span><span id="local-6989586621679411857"><span class="annot"><a href="#local-6989586621679411857"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679411857"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-type">reifyInDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Info</span></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span id="reifyInDec"><span class="annot"><span class="annottext">reifyInDec :: Name -&gt; [Dec] -&gt; Dec -&gt; Maybe (Name, Info)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var hs-var">reifyInDec</span></a></span></span><span> </span><span id="local-6989586621679411856"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411856"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411855"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679411855"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FunD</span></span><span> </span><span id="local-6989586621679411853"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411853"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411856"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411853"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411853"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; Info
</span><a href="Language.Haskell.TH.Desugar.Reify.html#mkVarI"><span class="hs-identifier hs-var">mkVarI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411856"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411855"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span id="local-6989586621679411851"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411851"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411850"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679411850"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ValD</span></span><span> </span><span id="local-6989586621679411848"><span class="annot"><span class="annottext">pat :: Pat
</span><a href="#local-6989586621679411848"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679411847"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411847"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Bool) -&gt; [Name] -&gt; Maybe Name
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-identifier hs-var">nameMatches</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411851"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OSet Name -&gt; [Name]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pat -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesPat"><span class="hs-identifier hs-var">extractBoundNamesPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679411848"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411847"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; Info
</span><a href="Language.Haskell.TH.Desugar.Reify.html#mkVarI"><span class="hs-identifier hs-var">mkVarI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411851"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411850"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span id="local-6989586621679411844"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411844"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-identifier">_</span><span>    </span><span id="local-6989586621679411843"><span class="annot"><span class="annottext">dec :: Dec
</span><a href="#local-6989586621679411843"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DataD</span></span><span>    </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411842"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411842"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411844"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411842"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411842"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; Info
</span><span class="hs-identifier hs-var">TyConI</span></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679411843"><span class="hs-identifier hs-var">dec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span id="local-6989586621679411841"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411841"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-identifier">_</span><span>    </span><span id="local-6989586621679411840"><span class="annot"><span class="annottext">dec :: Dec
</span><a href="#local-6989586621679411840"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NewtypeD</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411839"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411839"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411841"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411839"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411839"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; Info
</span><span class="hs-identifier hs-var">TyConI</span></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679411840"><span class="hs-identifier hs-var">dec</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-identifier">dec</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">DataD</span><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">nameMatches</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">TyConI</span><span> </span><span class="hs-identifier">dec</span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-identifier">dec</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">NewtypeD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">nameMatches</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">TyConI</span><span> </span><span class="hs-identifier">dec</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span id="local-6989586621679411838"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411838"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-identifier">_</span><span>    </span><span id="local-6989586621679411837"><span class="annot"><span class="annottext">dec :: Dec
</span><a href="#local-6989586621679411837"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TySynD</span></span><span> </span><span id="local-6989586621679411835"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411835"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411838"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411835"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411835"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; Info
</span><span class="hs-identifier hs-var">TyConI</span></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679411837"><span class="hs-identifier hs-var">dec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span id="local-6989586621679411834"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411834"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411833"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679411833"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span id="local-6989586621679411832"><span class="annot"><span class="annottext">dec :: Dec
</span><a href="#local-6989586621679411832"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClassD</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411830"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411830"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411834"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411830"><span class="hs-identifier hs-var">n'</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411830"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; [Dec] -&gt; Info
</span><span class="hs-identifier hs-var">ClassI</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dec -&gt; Dec
</span><a href="Language.Haskell.TH.Desugar.Reify.html#quantifyClassDecMethods"><span class="hs-identifier hs-var">quantifyClassDecMethods</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679411832"><span class="hs-identifier hs-var">dec</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; [Dec]
</span><a href="Language.Haskell.TH.Desugar.Reify.html#findInstances"><span class="hs-identifier hs-var">findInstances</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411834"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411833"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span id="local-6989586621679411826"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411826"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411825"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679411825"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImportF</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411822"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411822"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span id="local-6989586621679411821"><span class="annot"><span class="annottext">ty :: Kind
</span><a href="#local-6989586621679411821"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411826"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411822"><span class="hs-identifier hs-var">n'</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411822"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; Kind -&gt; Info
</span><a href="Language.Haskell.TH.Desugar.Reify.html#mkVarITy"><span class="hs-identifier hs-var">mkVarITy</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411826"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411825"><span class="hs-identifier hs-var">decs</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411821"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span id="local-6989586621679411819"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411819"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411818"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679411818"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExportF</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411816"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411816"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span id="local-6989586621679411815"><span class="annot"><span class="annottext">ty :: Kind
</span><a href="#local-6989586621679411815"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411819"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411816"><span class="hs-identifier hs-var">n'</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411816"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; Kind -&gt; Info
</span><a href="Language.Haskell.TH.Desugar.Reify.html#mkVarITy"><span class="hs-identifier hs-var">mkVarITy</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411819"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411818"><span class="hs-identifier hs-var">decs</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411815"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span id="local-6989586621679411814"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411814"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411813"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679411813"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span id="local-6989586621679411812"><span class="annot"><span class="annottext">dec :: Dec
</span><a href="#local-6989586621679411812"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OpenTypeFamilyD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TypeFamilyHead</span></span><span> </span><span id="local-6989586621679411809"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411809"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411814"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411809"><span class="hs-identifier hs-var">n'</span></a></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411809"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; [Dec] -&gt; Info
</span><span class="hs-identifier hs-var">FamilyI</span></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679411812"><span class="hs-identifier hs-var">dec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; [Dec]
</span><a href="Language.Haskell.TH.Desugar.Reify.html#findInstances"><span class="hs-identifier hs-var">findInstances</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411814"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411813"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span id="local-6989586621679411807"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411807"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411806"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679411806"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span id="local-6989586621679411805"><span class="annot"><span class="annottext">dec :: Dec
</span><a href="#local-6989586621679411805"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DataFamilyD</span></span><span> </span><span id="local-6989586621679411803"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411803"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411807"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411803"><span class="hs-identifier hs-var">n'</span></a></span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411803"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; [Dec] -&gt; Info
</span><span class="hs-identifier hs-var">FamilyI</span></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679411805"><span class="hs-identifier hs-var">dec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; [Dec]
</span><a href="Language.Haskell.TH.Desugar.Reify.html#findInstances"><span class="hs-identifier hs-var">findInstances</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411807"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411806"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span id="local-6989586621679411802"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411802"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-identifier">_</span><span>    </span><span id="local-6989586621679411801"><span class="annot"><span class="annottext">dec :: Dec
</span><a href="#local-6989586621679411801"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClosedTypeFamilyD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TypeFamilyHead</span></span><span> </span><span id="local-6989586621679411799"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411799"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411802"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411799"><span class="hs-identifier hs-var">n'</span></a></span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411799"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; [Dec] -&gt; Info
</span><span class="hs-identifier hs-var">FamilyI</span></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679411801"><span class="hs-identifier hs-var">dec</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-identifier">dec</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">FamilyD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">nameMatches</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">n'</span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">FamilyI</span><span> </span><span class="hs-identifier">dec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">findInstances</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-identifier">dec</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">ClosedTypeFamilyD</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">nameMatches</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">n'</span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">FamilyI</span><span> </span><span class="hs-identifier">dec</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span id="local-6989586621679411798"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411798"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411797"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679411797"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PatSynD</span></span><span> </span><span id="local-6989586621679411795"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411795"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411798"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411795"><span class="hs-identifier hs-var">n'</span></a></span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411795"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; Info
</span><a href="Language.Haskell.TH.Desugar.Reify.html#mkPatSynI"><span class="hs-identifier hs-var">mkPatSynI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411798"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411797"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span id="local-6989586621679411793"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411793"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411792"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679411792"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DataD</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411791"><span class="annot"><span class="annottext">ty_name :: Name
</span><a href="#local-6989586621679411791"><span class="hs-identifier hs-var">ty_name</span></a></span></span><span> </span><span id="local-6989586621679411790"><span class="annot"><span class="annottext">tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679411790"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679411789"><span class="annot"><span class="annottext">_mk :: Maybe Kind
</span><a href="#local-6989586621679411789"><span class="hs-identifier hs-var">_mk</span></a></span></span><span> </span><span id="local-6989586621679411788"><span class="annot"><span class="annottext">cons :: [Con]
</span><a href="#local-6989586621679411788"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679411787"><span class="annot"><span class="annottext">info :: (Name, Info)
</span><a href="#local-6989586621679411787"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; Name -&gt; [TypeArg] -&gt; [Con] -&gt; Maybe (Name, Info)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#maybeReifyCon"><span class="hs-identifier hs-var">maybeReifyCon</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411793"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411792"><span class="hs-identifier hs-var">decs</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411791"><span class="hs-identifier hs-var">ty_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyVarBndr -&gt; TypeArg) -&gt; [TyVarBndr] -&gt; [TypeArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; TypeArg
</span><a href="Language.Haskell.TH.Desugar.Util.html#tvbToTANormalWithSig"><span class="hs-identifier hs-var">tvbToTANormalWithSig</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411790"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679411788"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Name, Info)
</span><a href="#local-6989586621679411787"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-259"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span id="local-6989586621679411784"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411784"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411783"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679411783"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NewtypeD</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411782"><span class="annot"><span class="annottext">ty_name :: Name
</span><a href="#local-6989586621679411782"><span class="hs-identifier hs-var">ty_name</span></a></span></span><span> </span><span id="local-6989586621679411781"><span class="annot"><span class="annottext">tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679411781"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679411780"><span class="annot"><span class="annottext">_mk :: Maybe Kind
</span><a href="#local-6989586621679411780"><span class="hs-identifier hs-var">_mk</span></a></span></span><span> </span><span id="local-6989586621679411779"><span class="annot"><span class="annottext">con :: Con
</span><a href="#local-6989586621679411779"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679411778"><span class="annot"><span class="annottext">info :: (Name, Info)
</span><a href="#local-6989586621679411778"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; Name -&gt; [TypeArg] -&gt; [Con] -&gt; Maybe (Name, Info)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#maybeReifyCon"><span class="hs-identifier hs-var">maybeReifyCon</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411784"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411783"><span class="hs-identifier hs-var">decs</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411782"><span class="hs-identifier hs-var">ty_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyVarBndr -&gt; TypeArg) -&gt; [TyVarBndr] -&gt; [TypeArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; TypeArg
</span><a href="Language.Haskell.TH.Desugar.Util.html#tvbToTANormalWithSig"><span class="hs-identifier hs-var">tvbToTANormalWithSig</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411781"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679411779"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Name, Info)
</span><a href="#local-6989586621679411778"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DataD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">info</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">maybeReifyCon</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">tvbToTANormalWithSig</span><span> </span><span class="hs-identifier">tvbs</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">cons</span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">info</span><span>
</span><span id="line-266"></span><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NewtypeD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">info</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">maybeReifyCon</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">tvbToTANormalWithSig</span><span> </span><span class="hs-identifier">tvbs</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">con</span><span class="hs-special">]</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">info</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span id="local-6989586621679411777"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411777"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411776"><span class="annot"><span class="annottext">_decs :: [Dec]
</span><a href="#local-6989586621679411776"><span class="hs-identifier hs-var">_decs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClassD</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411775"><span class="annot"><span class="annottext">ty_name :: Name
</span><a href="#local-6989586621679411775"><span class="hs-identifier hs-var">ty_name</span></a></span></span><span> </span><span id="local-6989586621679411774"><span class="annot"><span class="annottext">tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679411774"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411773"><span class="annot"><span class="annottext">sub_decs :: [Dec]
</span><a href="#local-6989586621679411773"><span class="hs-identifier hs-var">sub_decs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679411772"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411772"><span class="hs-identifier hs-var">n'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679411771"><span class="annot"><span class="annottext">ty :: Kind
</span><a href="#local-6989586621679411771"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; Maybe (Named Kind)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#findType"><span class="hs-identifier hs-var">findType</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411777"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411773"><span class="hs-identifier hs-var">sub_decs</span></a></span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411772"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Kind -&gt; Name -&gt; Info
</span><span class="hs-identifier hs-var">ClassOpI</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411777"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [TyVarBndr] -&gt; Bool -&gt; Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Reify.html#quantifyClassMethodType"><span class="hs-identifier hs-var">quantifyClassMethodType</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411775"><span class="hs-identifier hs-var">ty_name</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411774"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411771"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411775"><span class="hs-identifier hs-var">ty_name</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ClassD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">sub_decs</span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ty</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">findType</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">sub_decs</span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ClassOpI</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">quantifyClassMethodType</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">True</span><span> </span><span class="hs-identifier">ty</span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>                       </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromMaybe</span><span> </span><span class="hs-identifier">defaultFixity</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-279"></span><span>                                </span><span class="hs-identifier">reifyFixityInDecs</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">sub_decs</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-identifier">decs</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span id="local-6989586621679411767"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411767"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411766"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679411766"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClassD</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411765"><span class="annot"><span class="annottext">sub_decs :: [Dec]
</span><a href="#local-6989586621679411765"><span class="hs-identifier hs-var">sub_decs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679411764"><span class="annot"><span class="annottext">info :: (Name, Info)
</span><a href="#local-6989586621679411764"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; Maybe (Name, Info)) -&gt; [Dec] -&gt; Maybe (Name, Info)
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; Maybe b
</span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; Dec -&gt; Maybe (Name, Info)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411767"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411765"><span class="hs-identifier hs-var">sub_decs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; [Dec] -&gt; [Dec]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411766"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411765"><span class="hs-identifier hs-var">sub_decs</span></a></span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Name, Info)
</span><a href="#local-6989586621679411764"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 711
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span id="local-6989586621679411763"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411763"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411762"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679411762"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InstanceD</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411760"><span class="annot"><span class="annottext">sub_decs :: [Dec]
</span><a href="#local-6989586621679411760"><span class="hs-identifier hs-var">sub_decs</span></a></span></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">InstanceD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">sub_decs</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679411759"><span class="annot"><span class="annottext">info :: (Name, Info)
</span><a href="#local-6989586621679411759"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; Maybe (Name, Info)) -&gt; [Dec] -&gt; Maybe (Name, Info)
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; Maybe b
</span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Dec -&gt; Maybe (Name, Info)
</span><a href="#local-6989586621679411758"><span class="hs-identifier hs-var">reify_in_instance</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411760"><span class="hs-identifier hs-var">sub_decs</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Name, Info)
</span><a href="#local-6989586621679411759"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-292"></span><span>    </span><span id="local-6989586621679411758"><span class="annot"><span class="annottext">reify_in_instance :: Dec -&gt; Maybe (Name, Info)
</span><a href="#local-6989586621679411758"><span class="hs-identifier hs-var hs-var">reify_in_instance</span></a></span></span><span> </span><span id="local-6989586621679411757"><span class="annot"><span class="annottext">dec :: Dec
</span><a href="#local-6989586621679411757"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DataInstD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; Dec -&gt; Maybe (Name, Info)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411763"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411760"><span class="hs-identifier hs-var">sub_decs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; [Dec] -&gt; [Dec]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411762"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679411757"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span class="annot"><a href="#local-6989586621679411758"><span class="hs-identifier hs-var">reify_in_instance</span></a></span><span> </span><span id="local-6989586621679411755"><span class="annot"><span class="annottext">dec :: Dec
</span><a href="#local-6989586621679411755"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NewtypeInstD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; Dec -&gt; Maybe (Name, Info)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411763"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411760"><span class="hs-identifier hs-var">sub_decs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; [Dec] -&gt; [Dec]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411762"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679411755"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><a href="#local-6989586621679411758"><span class="hs-identifier hs-var">reify_in_instance</span></a></span><span> </span><span class="hs-identifier">_</span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Name, Info)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span id="local-6989586621679411753"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411753"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411752"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679411752"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DataInstD</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411751"><span class="annot"><span class="annottext">lhs :: Kind
</span><a href="#local-6989586621679411751"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411750"><span class="annot"><span class="annottext">cons :: [Con]
</span><a href="#local-6989586621679411750"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679411749"><span class="annot"><span class="annottext">ty_name :: Name
</span><a href="#local-6989586621679411749"><span class="hs-identifier hs-var">ty_name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679411748"><span class="annot"><span class="annottext">tys :: [TypeArg]
</span><a href="#local-6989586621679411748"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; (Kind, [TypeArg])
</span><a href="Language.Haskell.TH.Desugar.Util.html#unfoldType"><span class="hs-identifier hs-var">unfoldType</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411751"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679411746"><span class="annot"><span class="annottext">info :: (Name, Info)
</span><a href="#local-6989586621679411746"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; Name -&gt; [TypeArg] -&gt; [Con] -&gt; Maybe (Name, Info)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#maybeReifyCon"><span class="hs-identifier hs-var">maybeReifyCon</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411753"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411752"><span class="hs-identifier hs-var">decs</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411749"><span class="hs-identifier hs-var">ty_name</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679411748"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679411750"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Name, Info)
</span><a href="#local-6989586621679411746"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-300"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span id="local-6989586621679411745"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411745"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411744"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679411744"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NewtypeInstD</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411743"><span class="annot"><span class="annottext">lhs :: Kind
</span><a href="#local-6989586621679411743"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411742"><span class="annot"><span class="annottext">con :: Con
</span><a href="#local-6989586621679411742"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679411741"><span class="annot"><span class="annottext">ty_name :: Name
</span><a href="#local-6989586621679411741"><span class="hs-identifier hs-var">ty_name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679411740"><span class="annot"><span class="annottext">tys :: [TypeArg]
</span><a href="#local-6989586621679411740"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; (Kind, [TypeArg])
</span><a href="Language.Haskell.TH.Desugar.Util.html#unfoldType"><span class="hs-identifier hs-var">unfoldType</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411743"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679411739"><span class="annot"><span class="annottext">info :: (Name, Info)
</span><a href="#local-6989586621679411739"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; Name -&gt; [TypeArg] -&gt; [Con] -&gt; Maybe (Name, Info)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#maybeReifyCon"><span class="hs-identifier hs-var">maybeReifyCon</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411745"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411744"><span class="hs-identifier hs-var">decs</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411741"><span class="hs-identifier hs-var">ty_name</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679411740"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679411742"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Name, Info)
</span><a href="#local-6989586621679411739"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-cpp">
#elif __GLASGOW_HASKELL__ &gt; 710
</span><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DataInstD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">info</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">maybeReifyCon</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">TANormal</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">cons</span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">info</span><span>
</span><span id="line-308"></span><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NewtypeInstD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">info</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">maybeReifyCon</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">TANormal</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">con</span><span class="hs-special">]</span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">info</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DataInstD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">info</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">maybeReifyCon</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">TANormal</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">cons</span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">info</span><span>
</span><span id="line-315"></span><span class="hs-identifier">reifyInDec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NewtypeInstD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">info</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">maybeReifyCon</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">TANormal</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">con</span><span class="hs-special">]</span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">info</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-320"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Name, Info)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#maybeReifyCon"><span class="hs-identifier hs-type">maybeReifyCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Info</span></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span id="maybeReifyCon"><span class="annot"><span class="annottext">maybeReifyCon :: Name -&gt; [Dec] -&gt; Name -&gt; [TypeArg] -&gt; [Con] -&gt; Maybe (Name, Info)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#maybeReifyCon"><span class="hs-identifier hs-var hs-var">maybeReifyCon</span></a></span></span><span> </span><span id="local-6989586621679411738"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411738"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411737"><span class="annot"><span class="annottext">_decs :: [Dec]
</span><a href="#local-6989586621679411737"><span class="hs-identifier hs-var">_decs</span></a></span></span><span> </span><span id="local-6989586621679411736"><span class="annot"><span class="annottext">ty_name :: Name
</span><a href="#local-6989586621679411736"><span class="hs-identifier hs-var">ty_name</span></a></span></span><span> </span><span id="local-6989586621679411735"><span class="annot"><span class="annottext">ty_args :: [TypeArg]
</span><a href="#local-6989586621679411735"><span class="hs-identifier hs-var">ty_args</span></a></span></span><span> </span><span id="local-6989586621679411734"><span class="annot"><span class="annottext">cons :: [Con]
</span><a href="#local-6989586621679411734"><span class="hs-identifier hs-var">cons</span></a></span></span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679411733"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411733"><span class="hs-identifier hs-var">n'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679411732"><span class="annot"><span class="annottext">con :: Con
</span><a href="#local-6989586621679411732"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Con] -&gt; Maybe (Named Con)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#findCon"><span class="hs-identifier hs-var">findCon</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411738"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679411734"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411733"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Kind -&gt; Name -&gt; Info
</span><span class="hs-identifier hs-var">DataConI</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411738"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; Cxt -&gt; Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Reify.html#maybeForallT"><span class="hs-identifier hs-var">maybeForallT</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411729"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Kind -&gt; Kind) -&gt; Kind -&gt; Kind
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Con -&gt; Kind
</span><a href="#local-6989586621679411728"><span class="hs-identifier hs-var">con_to_type</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679411732"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411736"><span class="hs-identifier hs-var">ty_name</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">maybeReifyCon</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-identifier">ty_args</span><span> </span><span class="hs-identifier">cons</span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">con</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">findCon</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">cons</span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">DataConI</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">maybeForallT</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">con_to_type</span><span> </span><span class="hs-identifier">con</span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>                         </span><span class="hs-identifier">ty_name</span><span> </span><span class="hs-identifier">fixity</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679411727"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411727"><span class="hs-identifier hs-var">n'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679411726"><span class="annot"><span class="annottext">ty :: Kind
</span><a href="#local-6989586621679411726"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Con] -&gt; Maybe (Named Kind)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#findRecSelector"><span class="hs-identifier hs-var">findRecSelector</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411738"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679411734"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-335"></span><span>      </span><span class="hs-comment">-- we don't try to ferret out naughty record selectors.</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe (Name, Info)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411727"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Kind -&gt; Maybe Dec -&gt; Info
</span><span class="hs-identifier hs-var">VarI</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411738"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; Cxt -&gt; Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Reify.html#maybeForallT"><span class="hs-identifier hs-var">maybeForallT</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411729"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Kind -&gt; Kind) -&gt; Kind -&gt; Kind
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Reify.html#mkArrows"><span class="hs-identifier hs-var">mkArrows</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411722"><span class="hs-identifier hs-var">result_ty</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411726"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Dec
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n'</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">VarI</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">maybeForallT</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">mkArrows</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">result_ty</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">ty</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">fixity</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-342"></span><span>    </span><span id="local-6989586621679411722"><span class="annot"><span class="annottext">result_ty :: Kind
</span><a href="#local-6989586621679411722"><span class="hs-identifier hs-var hs-var">result_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; [TypeArg] -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#applyType"><span class="hs-identifier hs-var">applyType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Kind
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411736"><span class="hs-identifier hs-var">ty_name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TypeArg -&gt; TypeArg) -&gt; [TypeArg] -&gt; [TypeArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TypeArg -&gt; TypeArg
</span><a href="Language.Haskell.TH.Desugar.Util.html#unSigTypeArg"><span class="hs-identifier hs-var">unSigTypeArg</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679411735"><span class="hs-identifier hs-var">ty_args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>      </span><span class="hs-comment">-- Make sure to call unSigTypeArg here. Otherwise, if you have this:</span><span>
</span><span id="line-344"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-345"></span><span>      </span><span class="hs-comment">--   data D (a :: k) = MkD { unD :: Proxy a }</span><span>
</span><span id="line-346"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-347"></span><span>      </span><span class="hs-comment">-- Then the type of unD will be reified as:</span><span>
</span><span id="line-348"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-349"></span><span>      </span><span class="hs-comment">--   unD :: forall k (a :: k). D (a :: k) -&gt; Proxy a</span><span>
</span><span id="line-350"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-351"></span><span>      </span><span class="hs-comment">-- This is contrast to GHC's own reification, which will produce `D a`</span><span>
</span><span id="line-352"></span><span>      </span><span class="hs-comment">-- (without the explicit kind signature) as the type of the first argument.</span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span>    </span><span id="local-6989586621679411728"><span class="annot"><span class="annottext">con_to_type :: Con -&gt; Kind
</span><a href="#local-6989586621679411728"><span class="hs-identifier hs-var hs-var">con_to_type</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NormalC</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411719"><span class="annot"><span class="annottext">stys :: [BangType]
</span><a href="#local-6989586621679411719"><span class="hs-identifier hs-var">stys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Reify.html#mkArrows"><span class="hs-identifier hs-var">mkArrows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BangType -&gt; Kind) -&gt; [BangType] -&gt; Cxt
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">BangType -&gt; Kind
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span>    </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679411719"><span class="hs-identifier hs-var">stys</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411722"><span class="hs-identifier hs-var">result_ty</span></a></span><span>
</span><span id="line-355"></span><span>    </span><span class="annot"><a href="#local-6989586621679411728"><span class="hs-identifier hs-var">con_to_type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecC</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411718"><span class="annot"><span class="annottext">vstys :: [VarBangType]
</span><a href="#local-6989586621679411718"><span class="hs-identifier hs-var">vstys</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Reify.html#mkArrows"><span class="hs-identifier hs-var">mkArrows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(VarBangType -&gt; Kind) -&gt; [VarBangType] -&gt; Cxt
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">VarBangType -&gt; Kind
forall a b c. (a, b, c) -&gt; c
</span><a href="Language.Haskell.TH.Desugar.Util.html#thdOf3"><span class="hs-identifier hs-var">thdOf3</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679411718"><span class="hs-identifier hs-var">vstys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411722"><span class="hs-identifier hs-var">result_ty</span></a></span><span>
</span><span id="line-356"></span><span>    </span><span class="annot"><a href="#local-6989586621679411728"><span class="hs-identifier hs-var">con_to_type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixC</span></span><span> </span><span id="local-6989586621679411716"><span class="annot"><span class="annottext">t1 :: BangType
</span><a href="#local-6989586621679411716"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411715"><span class="annot"><span class="annottext">t2 :: BangType
</span><a href="#local-6989586621679411715"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Reify.html#mkArrows"><span class="hs-identifier hs-var">mkArrows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BangType -&gt; Kind) -&gt; [BangType] -&gt; Cxt
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">BangType -&gt; Kind
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679411716"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679411715"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411722"><span class="hs-identifier hs-var">result_ty</span></a></span><span>
</span><span id="line-357"></span><span>    </span><span class="annot"><a href="#local-6989586621679411728"><span class="hs-identifier hs-var">con_to_type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallC</span></span><span> </span><span id="local-6989586621679411714"><span class="annot"><span class="annottext">bndrs :: [TyVarBndr]
</span><a href="#local-6989586621679411714"><span class="hs-identifier hs-var">bndrs</span></a></span></span><span> </span><span id="local-6989586621679411713"><span class="annot"><span class="annottext">cxt :: Cxt
</span><a href="#local-6989586621679411713"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679411712"><span class="annot"><span class="annottext">c :: Con
</span><a href="#local-6989586621679411712"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; Cxt -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411714"><span class="hs-identifier hs-var">bndrs</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679411713"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Con -&gt; Kind
</span><a href="#local-6989586621679411728"><span class="hs-identifier hs-var">con_to_type</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679411712"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span>    </span><span class="annot"><a href="#local-6989586621679411728"><span class="hs-identifier hs-var">con_to_type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GadtC</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411710"><span class="annot"><span class="annottext">stys :: [BangType]
</span><a href="#local-6989586621679411710"><span class="hs-identifier hs-var">stys</span></a></span></span><span> </span><span id="local-6989586621679411709"><span class="annot"><span class="annottext">rty :: Kind
</span><a href="#local-6989586621679411709"><span class="hs-identifier hs-var">rty</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Reify.html#mkArrows"><span class="hs-identifier hs-var">mkArrows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BangType -&gt; Kind) -&gt; [BangType] -&gt; Cxt
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">BangType -&gt; Kind
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span>    </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679411710"><span class="hs-identifier hs-var">stys</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411709"><span class="hs-identifier hs-var">rty</span></a></span><span>
</span><span id="line-360"></span><span>    </span><span class="annot"><a href="#local-6989586621679411728"><span class="hs-identifier hs-var">con_to_type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecGadtC</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411708"><span class="annot"><span class="annottext">vstys :: [VarBangType]
</span><a href="#local-6989586621679411708"><span class="hs-identifier hs-var">vstys</span></a></span></span><span> </span><span id="local-6989586621679411707"><span class="annot"><span class="annottext">rty :: Kind
</span><a href="#local-6989586621679411707"><span class="hs-identifier hs-var">rty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Reify.html#mkArrows"><span class="hs-identifier hs-var">mkArrows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(VarBangType -&gt; Kind) -&gt; [VarBangType] -&gt; Cxt
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">VarBangType -&gt; Kind
forall a b c. (a, b, c) -&gt; c
</span><a href="Language.Haskell.TH.Desugar.Util.html#thdOf3"><span class="hs-identifier hs-var">thdOf3</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679411708"><span class="hs-identifier hs-var">vstys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411707"><span class="hs-identifier hs-var">rty</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &lt; 711
</span><span>    </span><span class="hs-identifier">fixity</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fromMaybe</span><span> </span><span class="hs-identifier">defaultFixity</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">reifyFixityInDecs</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span class="hs-cpp">
#endif
</span><span>    </span><span id="local-6989586621679411729"><span class="annot"><span class="annottext">tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679411729"><span class="hs-identifier hs-var hs-var">tvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; [TyVarBndr]
</span><span class="hs-identifier hs-var">freeVariablesWellScoped</span></span><span> </span><span class="annot"><span class="annottext">(Cxt -&gt; [TyVarBndr]) -&gt; Cxt -&gt; [TyVarBndr]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(TypeArg -&gt; Kind) -&gt; [TypeArg] -&gt; Cxt
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TypeArg -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#probablyWrongUnTypeArg"><span class="hs-identifier hs-var">probablyWrongUnTypeArg</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679411735"><span class="hs-identifier hs-var">ty_args</span></a></span><span>
</span><span id="line-366"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#maybeReifyCon"><span class="hs-identifier hs-var">maybeReifyCon</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Name, Info)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#mkVarI"><span class="hs-identifier hs-type">mkVarI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Info</span></span><span>
</span><span id="line-369"></span><span id="mkVarI"><span class="annot"><span class="annottext">mkVarI :: Name -&gt; [Dec] -&gt; Info
</span><a href="Language.Haskell.TH.Desugar.Reify.html#mkVarI"><span class="hs-identifier hs-var hs-var">mkVarI</span></a></span></span><span> </span><span id="local-6989586621679411704"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411704"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411703"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679411703"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; Kind -&gt; Info
</span><a href="Language.Haskell.TH.Desugar.Reify.html#mkVarITy"><span class="hs-identifier hs-var">mkVarITy</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411704"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411703"><span class="hs-identifier hs-var">decs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; (Named Kind -&gt; Kind) -&gt; Maybe (Named Kind) -&gt; Kind
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Reify.html#no_type"><span class="hs-identifier hs-var">no_type</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411704"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Named Kind -&gt; Kind
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Named Kind) -&gt; Kind) -&gt; Maybe (Named Kind) -&gt; Kind
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; Maybe (Named Kind)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#findType"><span class="hs-identifier hs-var">findType</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411704"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411703"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#mkVarITy"><span class="hs-identifier hs-type">mkVarITy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Info</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span id="mkVarITy"><span class="annot"><span class="annottext">mkVarITy :: Name -&gt; [Dec] -&gt; Kind -&gt; Info
</span><a href="Language.Haskell.TH.Desugar.Reify.html#mkVarITy"><span class="hs-identifier hs-var hs-var">mkVarITy</span></a></span></span><span> </span><span id="local-6989586621679411701"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411701"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411700"><span class="annot"><span class="annottext">_decs :: [Dec]
</span><a href="#local-6989586621679411700"><span class="hs-identifier hs-var">_decs</span></a></span></span><span> </span><span id="local-6989586621679411699"><span class="annot"><span class="annottext">ty :: Kind
</span><a href="#local-6989586621679411699"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Kind -&gt; Maybe Dec -&gt; Info
</span><span class="hs-identifier hs-var">VarI</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411701"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411699"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Dec
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">mkVarITy</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">VarI</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromMaybe</span><span> </span><span class="hs-identifier">defaultFixity</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-376"></span><span>                                        </span><span class="hs-identifier">reifyFixityInDecs</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">decs</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-379"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#findType"><span class="hs-identifier hs-type">findType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span id="findType"><span class="annot"><span class="annottext">findType :: Name -&gt; [Dec] -&gt; Maybe (Named Kind)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#findType"><span class="hs-identifier hs-var hs-var">findType</span></a></span></span><span> </span><span id="local-6989586621679411698"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411698"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; Maybe (Named Kind)) -&gt; [Dec] -&gt; Maybe (Named Kind)
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; Maybe b
</span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Dec -&gt; Maybe (Named Kind)
</span><a href="#local-6989586621679411697"><span class="hs-identifier hs-var">match_type</span></a></span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-382"></span><span>    </span><span id="local-6989586621679411697"><span class="annot"><span class="annottext">match_type :: Dec -&gt; Maybe (Named Kind)
</span><a href="#local-6989586621679411697"><span class="hs-identifier hs-var hs-var">match_type</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigD</span></span><span> </span><span id="local-6989586621679411695"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411695"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span id="local-6989586621679411694"><span class="annot"><span class="annottext">ty :: Kind
</span><a href="#local-6989586621679411694"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411698"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411695"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Named Kind -&gt; Maybe (Named Kind)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411695"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411694"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>    </span><span class="annot"><a href="#local-6989586621679411697"><span class="hs-identifier hs-var">match_type</span></a></span><span> </span><span class="hs-identifier">_</span><span>                                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Named Kind)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#mkPatSynI"><span class="hs-identifier hs-type">mkPatSynI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Info</span></span><span>
</span><span id="line-387"></span><span id="mkPatSynI"><span class="annot"><span class="annottext">mkPatSynI :: Name -&gt; [Dec] -&gt; Info
</span><a href="Language.Haskell.TH.Desugar.Reify.html#mkPatSynI"><span class="hs-identifier hs-var hs-var">mkPatSynI</span></a></span></span><span> </span><span id="local-6989586621679411693"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411693"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411692"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679411692"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Kind -&gt; Info
</span><span class="hs-identifier hs-var">PatSynI</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411693"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Maybe Kind -&gt; Kind
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Reify.html#no_type"><span class="hs-identifier hs-var">no_type</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411693"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Kind -&gt; Kind) -&gt; Maybe Kind -&gt; Kind
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; Maybe Kind
</span><a href="Language.Haskell.TH.Desugar.Reify.html#findPatSynType"><span class="hs-identifier hs-var">findPatSynType</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411693"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411692"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#findPatSynType"><span class="hs-identifier hs-type">findPatSynType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PatSynType</span></span><span>
</span><span id="line-390"></span><span id="findPatSynType"><span class="annot"><span class="annottext">findPatSynType :: Name -&gt; [Dec] -&gt; Maybe Kind
</span><a href="Language.Haskell.TH.Desugar.Reify.html#findPatSynType"><span class="hs-identifier hs-var hs-var">findPatSynType</span></a></span></span><span> </span><span id="local-6989586621679411687"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411687"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; Maybe Kind) -&gt; [Dec] -&gt; Maybe Kind
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; Maybe b
</span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Dec -&gt; Maybe Kind
</span><a href="#local-6989586621679411686"><span class="hs-identifier hs-var">match_pat_syn_type</span></a></span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-392"></span><span>    </span><span id="local-6989586621679411686"><span class="annot"><span class="annottext">match_pat_syn_type :: Dec -&gt; Maybe Kind
</span><a href="#local-6989586621679411686"><span class="hs-identifier hs-var hs-var">match_pat_syn_type</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PatSynSigD</span></span><span> </span><span id="local-6989586621679411684"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411684"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span id="local-6989586621679411683"><span class="annot"><span class="annottext">psty :: Kind
</span><a href="#local-6989586621679411683"><span class="hs-identifier hs-var">psty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411687"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411684"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Maybe Kind
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411683"><span class="hs-identifier hs-var">psty</span></a></span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><a href="#local-6989586621679411686"><span class="hs-identifier hs-var">match_pat_syn_type</span></a></span><span> </span><span class="hs-identifier">_</span><span>                                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Kind
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-396"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#no_type"><span class="hs-identifier hs-type">no_type</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-397"></span><span id="no_type"><span class="annot"><span class="annottext">no_type :: Name -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Reify.html#no_type"><span class="hs-identifier hs-var hs-var">no_type</span></a></span></span><span> </span><span id="local-6989586621679411682"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411682"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Kind
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Kind) -&gt; String -&gt; Kind
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;No type information found in local declaration for &quot;</span></span><span>
</span><span id="line-398"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411682"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#findInstances"><span class="hs-identifier hs-type">findInstances</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>
</span><span id="line-401"></span><span id="findInstances"><span class="annot"><span class="annottext">findInstances :: Name -&gt; [Dec] -&gt; [Dec]
</span><a href="Language.Haskell.TH.Desugar.Reify.html#findInstances"><span class="hs-identifier hs-var hs-var">findInstances</span></a></span></span><span> </span><span id="local-6989586621679411680"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411680"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; Dec) -&gt; [Dec] -&gt; [Dec]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Dec -&gt; Dec
</span><a href="Language.Haskell.TH.Desugar.Reify.html#stripInstanceDec"><span class="hs-identifier hs-var">stripInstanceDec</span></a></span><span> </span><span class="annot"><span class="annottext">([Dec] -&gt; [Dec]) -&gt; ([Dec] -&gt; [Dec]) -&gt; [Dec] -&gt; [Dec]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; [Dec]) -&gt; [Dec] -&gt; [Dec]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Dec -&gt; [Dec]
</span><a href="#local-6989586621679411677"><span class="hs-identifier hs-var">match_instance</span></a></span><span>
</span><span id="line-402"></span><span>  </span><span class="hs-keyword">where</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 711
</span><span>    </span><span id="local-6989586621679411677"><span class="annot"><span class="annottext">match_instance :: Dec -&gt; [Dec]
</span><a href="#local-6989586621679411677"><span class="hs-identifier hs-var hs-var">match_instance</span></a></span></span><span> </span><span id="local-6989586621679411676"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679411676"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InstanceD</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411675"><span class="annot"><span class="annottext">ty :: Kind
</span><a href="#local-6989586621679411675"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-identifier">match_instance</span><span> </span><span class="hs-identifier">d</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">InstanceD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>                                               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679411674"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411674"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="#local-6989586621679411673"><span class="hs-identifier hs-var">ty_head</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411675"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-409"></span><span>                                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411680"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411674"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679411676"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span>    </span><span class="annot"><a href="#local-6989586621679411677"><span class="hs-identifier hs-var">match_instance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DataInstD</span></span><span> </span><span id="local-6989586621679411672"><span class="annot"><span class="annottext">ctxt :: Cxt
</span><a href="#local-6989586621679411672"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411671"><span class="annot"><span class="annottext">lhs :: Kind
</span><a href="#local-6989586621679411671"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679411670"><span class="annot"><span class="annottext">mk :: Maybe Kind
</span><a href="#local-6989586621679411670"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679411669"><span class="annot"><span class="annottext">cons :: [Con]
</span><a href="#local-6989586621679411669"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679411668"><span class="annot"><span class="annottext">derivs :: [DerivClause]
</span><a href="#local-6989586621679411668"><span class="hs-identifier hs-var">derivs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>                                                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679411667"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411667"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="#local-6989586621679411673"><span class="hs-identifier hs-var">ty_head</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411671"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-413"></span><span>                                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411680"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411667"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679411666"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-414"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-415"></span><span>        </span><span id="local-6989586621679411665"><span class="annot"><span class="annottext">mtvbs :: Maybe [TyVarBndr]
</span><a href="#local-6989586621679411665"><span class="hs-identifier hs-var hs-var">mtvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; Kind -&gt; Maybe Kind -&gt; Maybe [TyVarBndr]
</span><a href="#local-6989586621679411664"><span class="hs-identifier hs-var">rejig_data_inst_tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679411672"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411671"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Kind
</span><a href="#local-6989586621679411670"><span class="hs-identifier hs-var">mk</span></a></span><span>
</span><span id="line-416"></span><span>        </span><span id="local-6989586621679411666"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679411666"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cxt
-&gt; Maybe [TyVarBndr]
-&gt; Kind
-&gt; Maybe Kind
-&gt; [Con]
-&gt; [DerivClause]
-&gt; Dec
</span><span class="hs-identifier hs-var">DataInstD</span></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679411672"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndr]
</span><a href="#local-6989586621679411665"><span class="hs-identifier hs-var">mtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411671"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Kind
</span><a href="#local-6989586621679411670"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679411669"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679411668"><span class="hs-identifier hs-var">derivs</span></a></span><span>
</span><span id="line-417"></span><span>    </span><span class="annot"><a href="#local-6989586621679411677"><span class="hs-identifier hs-var">match_instance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NewtypeInstD</span></span><span> </span><span id="local-6989586621679411663"><span class="annot"><span class="annottext">ctxt :: Cxt
</span><a href="#local-6989586621679411663"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411662"><span class="annot"><span class="annottext">lhs :: Kind
</span><a href="#local-6989586621679411662"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679411661"><span class="annot"><span class="annottext">mk :: Maybe Kind
</span><a href="#local-6989586621679411661"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679411660"><span class="annot"><span class="annottext">con :: Con
</span><a href="#local-6989586621679411660"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621679411659"><span class="annot"><span class="annottext">derivs :: [DerivClause]
</span><a href="#local-6989586621679411659"><span class="hs-identifier hs-var">derivs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>                                                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679411658"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411658"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="#local-6989586621679411673"><span class="hs-identifier hs-var">ty_head</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411662"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-419"></span><span>                                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411680"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411658"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679411657"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-420"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-421"></span><span>        </span><span id="local-6989586621679411656"><span class="annot"><span class="annottext">mtvbs :: Maybe [TyVarBndr]
</span><a href="#local-6989586621679411656"><span class="hs-identifier hs-var hs-var">mtvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; Kind -&gt; Maybe Kind -&gt; Maybe [TyVarBndr]
</span><a href="#local-6989586621679411664"><span class="hs-identifier hs-var">rejig_data_inst_tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679411663"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411662"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Kind
</span><a href="#local-6989586621679411661"><span class="hs-identifier hs-var">mk</span></a></span><span>
</span><span id="line-422"></span><span>        </span><span id="local-6989586621679411657"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679411657"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cxt
-&gt; Maybe [TyVarBndr]
-&gt; Kind
-&gt; Maybe Kind
-&gt; Con
-&gt; [DerivClause]
-&gt; Dec
</span><span class="hs-identifier hs-var">NewtypeInstD</span></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679411663"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndr]
</span><a href="#local-6989586621679411656"><span class="hs-identifier hs-var">mtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411662"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Kind
</span><a href="#local-6989586621679411661"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679411660"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679411659"><span class="hs-identifier hs-var">derivs</span></a></span><span class="hs-cpp">
#elif __GLASGOW_HASKELL__ &gt; 710
</span><span>    </span><span class="hs-identifier">match_instance</span><span> </span><span class="hs-identifier">d</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">DataInstD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">nameMatches</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">d</span><span class="hs-special">]</span><span>
</span><span id="line-425"></span><span>    </span><span class="hs-identifier">match_instance</span><span> </span><span class="hs-identifier">d</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">NewtypeInstD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">nameMatches</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">d</span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-identifier">match_instance</span><span> </span><span class="hs-identifier">d</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">DataInstD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">nameMatches</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">d</span><span class="hs-special">]</span><span>
</span><span id="line-428"></span><span>    </span><span class="hs-identifier">match_instance</span><span> </span><span class="hs-identifier">d</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">NewtypeInstD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">nameMatches</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">d</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span>    </span><span class="annot"><a href="#local-6989586621679411677"><span class="hs-identifier hs-var">match_instance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TySynInstD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TySynEqn</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411653"><span class="annot"><span class="annottext">lhs :: Kind
</span><a href="#local-6989586621679411653"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679411652"><span class="annot"><span class="annottext">rhs :: Kind
</span><a href="#local-6989586621679411652"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>                                               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679411651"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411651"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="#local-6989586621679411673"><span class="hs-identifier hs-var">ty_head</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411653"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-433"></span><span>                                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411680"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411651"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679411650"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-434"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-435"></span><span>        </span><span id="local-6989586621679411649"><span class="annot"><span class="annottext">mtvbs :: Maybe [TyVarBndr]
</span><a href="#local-6989586621679411649"><span class="hs-identifier hs-var hs-var">mtvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; Maybe [TyVarBndr]
</span><a href="#local-6989586621679411648"><span class="hs-identifier hs-var">rejig_tvbs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411653"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411652"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-436"></span><span>        </span><span id="local-6989586621679411650"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679411650"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TySynEqn -&gt; Dec
</span><span class="hs-identifier hs-var">TySynInstD</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe [TyVarBndr] -&gt; Kind -&gt; Kind -&gt; TySynEqn
</span><span class="hs-identifier hs-var">TySynEqn</span></span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndr]
</span><a href="#local-6989586621679411649"><span class="hs-identifier hs-var">mtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411653"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411652"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-identifier">match_instance</span><span> </span><span class="hs-identifier">d</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">TySynInstD</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">nameMatches</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">n'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">d</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 711
</span><span>    </span><span class="annot"><a href="#local-6989586621679411677"><span class="hs-identifier hs-var">match_instance</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InstanceD</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411647"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679411647"><span class="hs-identifier hs-var">decs</span></a></span></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-identifier">match_instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">InstanceD</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">decs</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>                                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; [Dec]) -&gt; [Dec] -&gt; [Dec]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Dec -&gt; [Dec]
</span><a href="#local-6989586621679411677"><span class="hs-identifier hs-var">match_instance</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411647"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-447"></span><span>    </span><span class="annot"><a href="#local-6989586621679411677"><span class="hs-identifier hs-var">match_instance</span></a></span><span> </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 807
</span><span>    </span><span class="hs-comment">-- See Note [Rejigging reified type family equations variable binders]</span><span>
</span><span id="line-451"></span><span>    </span><span class="hs-comment">-- for why this is necessary.</span><span>
</span><span id="line-452"></span><span>    </span><span class="annot"><a href="#local-6989586621679411648"><span class="hs-identifier hs-type">rejig_tvbs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span class="hs-special">]</span><span>
</span><span id="line-453"></span><span>    </span><span id="local-6989586621679411648"><span class="annot"><span class="annottext">rejig_tvbs :: Cxt -&gt; Maybe [TyVarBndr]
</span><a href="#local-6989586621679411648"><span class="hs-identifier hs-var hs-var">rejig_tvbs</span></a></span></span><span> </span><span id="local-6989586621679411646"><span class="annot"><span class="annottext">ts :: Cxt
</span><a href="#local-6989586621679411646"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-454"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679411645"><span class="annot"><span class="annottext">tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679411645"><span class="hs-identifier hs-var hs-var">tvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; [TyVarBndr]
</span><span class="hs-identifier hs-var">freeVariablesWellScoped</span></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679411646"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-455"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411645"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-456"></span><span>         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndr]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-457"></span><span>         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; Maybe [TyVarBndr]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411645"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span>    </span><span class="annot"><a href="#local-6989586621679411664"><span class="hs-identifier hs-type">rejig_data_inst_tvbs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Kind</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span class="hs-special">]</span><span>
</span><span id="line-460"></span><span>    </span><span id="local-6989586621679411664"><span class="annot"><span class="annottext">rejig_data_inst_tvbs :: Cxt -&gt; Kind -&gt; Maybe Kind -&gt; Maybe [TyVarBndr]
</span><a href="#local-6989586621679411664"><span class="hs-identifier hs-var hs-var">rejig_data_inst_tvbs</span></a></span></span><span> </span><span id="local-6989586621679411643"><span class="annot"><span class="annottext">cxt :: Cxt
</span><a href="#local-6989586621679411643"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679411642"><span class="annot"><span class="annottext">lhs :: Kind
</span><a href="#local-6989586621679411642"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679411641"><span class="annot"><span class="annottext">mk :: Maybe Kind
</span><a href="#local-6989586621679411641"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-461"></span><span>      </span><span class="annot"><span class="annottext">Cxt -&gt; Maybe [TyVarBndr]
</span><a href="#local-6989586621679411648"><span class="hs-identifier hs-var">rejig_tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">(Cxt -&gt; Maybe [TyVarBndr]) -&gt; Cxt -&gt; Maybe [TyVarBndr]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679411643"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; Cxt -&gt; Cxt
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411642"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; Cxt -&gt; Cxt
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Maybe Kind -&gt; Cxt
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="annot"><span class="annottext">Maybe Kind
</span><a href="#local-6989586621679411641"><span class="hs-identifier hs-var">mk</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-464"></span><span>    </span><span id="local-6989586621679411673"><span class="annot"><span class="annottext">ty_head :: Kind -&gt; Kind
</span><a href="#local-6989586621679411673"><span class="hs-identifier hs-var hs-var">ty_head</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Kind, [TypeArg]) -&gt; Kind
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Kind, [TypeArg]) -&gt; Kind)
-&gt; (Kind -&gt; (Kind, [TypeArg])) -&gt; Kind -&gt; Kind
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; (Kind, [TypeArg])
</span><a href="Language.Haskell.TH.Desugar.Util.html#unfoldType"><span class="hs-identifier hs-var">unfoldType</span></a></span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span class="hs-comment">{-
Note [Rejigging reified type family equations variable binders]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
When reifying a type family instance (on GHC 8.8 or later), which quantified
type variables do you use? This might seem like a strange question to ask since
these instances already come equipped with a field of type `Maybe [TyVarBndr]`,
but it's not always the case that you want to use exactly that field. Here is
an example to better explain it:

  class C a where
    type T b a
  instance C (Maybe a) where
    type forall b. T b (Maybe a) = a

If the above instance were quoted, it would give you `Just [PlainTV b]`. But if
you were to reify ''T (and therefore retrieve the instance for T), you wouldn't
want to use that as your list of type variable binders! This is because
reifiying any type family always presents the information as though the type
family were top-level. Therefore, reifying T (in GHC, at least) would yield:

  type family T b a
  type instance forall b a. T b (Maybe a) = a

Note that we quantify over `b` *and* `a` here, not just `b`. To emulate this
GHC quirk, whenever we reify any type family instance, we just ignore the field
of type `Maybe [TyVarBndr]` and quantify over the instance afresh. It's a bit
tedious, but it gets the job done. (This is accomplished by the rejig_tvbs
function.)
-}</span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span class="hs-comment">-- Consider the following class declaration:</span><span>
</span><span id="line-497"></span><span class="hs-comment">--</span><span>
</span><span id="line-498"></span><span class="hs-comment">--   [d| class C a where</span><span>
</span><span id="line-499"></span><span class="hs-comment">--         method :: a -&gt; b -&gt; a |]</span><span>
</span><span id="line-500"></span><span class="hs-comment">--</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- When reifying C locally, quantifyClassDecMethods serves two purposes:</span><span>
</span><span id="line-502"></span><span class="hs-comment">--</span><span>
</span><span id="line-503"></span><span class="hs-comment">-- 1. It quantifies the class method's local type variables. To illustrate this</span><span>
</span><span id="line-504"></span><span class="hs-comment">--    point, this is how GHC would reify C:</span><span>
</span><span id="line-505"></span><span class="hs-comment">--</span><span>
</span><span id="line-506"></span><span class="hs-comment">--      class C a where</span><span>
</span><span id="line-507"></span><span class="hs-comment">--        method :: forall b. a -&gt; b -&gt; a</span><span>
</span><span id="line-508"></span><span class="hs-comment">--</span><span>
</span><span id="line-509"></span><span class="hs-comment">--    Notice the presence of the explicit `forall b.`. quantifyClassDecMethods</span><span>
</span><span id="line-510"></span><span class="hs-comment">--    performs this explicit quantification if necessary (as in the case in the</span><span>
</span><span id="line-511"></span><span class="hs-comment">--    local C declaration, where `b` is implicitly quantified.)</span><span>
</span><span id="line-512"></span><span class="hs-comment">-- 2. It emulates a quirk in the way old versions of GHC would reify class</span><span>
</span><span id="line-513"></span><span class="hs-comment">--    declarations (Trac #15551). On versions of GHC older than 8.8, it would</span><span>
</span><span id="line-514"></span><span class="hs-comment">--    reify C like so:</span><span>
</span><span id="line-515"></span><span class="hs-comment">--</span><span>
</span><span id="line-516"></span><span class="hs-comment">--      class C a where</span><span>
</span><span id="line-517"></span><span class="hs-comment">--        method :: forall a. C a =&gt; forall b. a -&gt; b -&gt; a</span><span>
</span><span id="line-518"></span><span class="hs-comment">--</span><span>
</span><span id="line-519"></span><span class="hs-comment">--    Notice how GHC has added the (totally extraneous) `forall a. C a =&gt;`</span><span>
</span><span id="line-520"></span><span class="hs-comment">--    part! This is weird, but our primary goal in this module is to mimic</span><span>
</span><span id="line-521"></span><span class="hs-comment">--    GHC's reification, so we play the part by adding the `forall`/class</span><span>
</span><span id="line-522"></span><span class="hs-comment">--    context to each class method in quantifyClassDecMethods.</span><span>
</span><span id="line-523"></span><span class="hs-comment">--</span><span>
</span><span id="line-524"></span><span class="hs-comment">--    Since Trac #15551 was fixed in GHC 8.8, this function doesn't perform</span><span>
</span><span id="line-525"></span><span class="hs-comment">--    this step on 8.7 or later.</span><span>
</span><span id="line-526"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#quantifyClassDecMethods"><span class="hs-identifier hs-type">quantifyClassDecMethods</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span>
</span><span id="line-527"></span><span id="quantifyClassDecMethods"><span class="annot"><span class="annottext">quantifyClassDecMethods :: Dec -&gt; Dec
</span><a href="Language.Haskell.TH.Desugar.Reify.html#quantifyClassDecMethods"><span class="hs-identifier hs-var hs-var">quantifyClassDecMethods</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClassD</span></span><span> </span><span id="local-6989586621679411639"><span class="annot"><span class="annottext">cxt :: Cxt
</span><a href="#local-6989586621679411639"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679411638"><span class="annot"><span class="annottext">cls_name :: Name
</span><a href="#local-6989586621679411638"><span class="hs-identifier hs-var">cls_name</span></a></span></span><span> </span><span id="local-6989586621679411637"><span class="annot"><span class="annottext">cls_tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679411637"><span class="hs-identifier hs-var">cls_tvbs</span></a></span></span><span> </span><span id="local-6989586621679411636"><span class="annot"><span class="annottext">fds :: [FunDep]
</span><a href="#local-6989586621679411636"><span class="hs-identifier hs-var">fds</span></a></span></span><span> </span><span id="local-6989586621679411635"><span class="annot"><span class="annottext">sub_decs :: [Dec]
</span><a href="#local-6989586621679411635"><span class="hs-identifier hs-var">sub_decs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; Name -&gt; [TyVarBndr] -&gt; [FunDep] -&gt; [Dec] -&gt; Dec
</span><span class="hs-identifier hs-var">ClassD</span></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679411639"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411638"><span class="hs-identifier hs-var">cls_name</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411637"><span class="hs-identifier hs-var">cls_tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[FunDep]
</span><a href="#local-6989586621679411636"><span class="hs-identifier hs-var">fds</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411634"><span class="hs-identifier hs-var">sub_decs'</span></a></span><span>
</span><span id="line-529"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-530"></span><span>    </span><span id="local-6989586621679411634"><span class="annot"><span class="annottext">sub_decs' :: [Dec]
</span><a href="#local-6989586621679411634"><span class="hs-identifier hs-var hs-var">sub_decs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; Maybe Dec) -&gt; [Dec] -&gt; [Dec]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">Dec -&gt; Maybe Dec
</span><a href="#local-6989586621679411632"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411635"><span class="hs-identifier hs-var">sub_decs</span></a></span><span>
</span><span id="line-531"></span><span>    </span><span id="local-6989586621679411632"><span class="annot"><span class="annottext">go :: Dec -&gt; Maybe Dec
</span><a href="#local-6989586621679411632"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigD</span></span><span> </span><span id="local-6989586621679411631"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411631"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679411630"><span class="annot"><span class="annottext">ty :: Kind
</span><a href="#local-6989586621679411630"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-532"></span><span>      </span><span class="annot"><span class="annottext">Dec -&gt; Maybe Dec
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; Maybe Dec) -&gt; Dec -&gt; Maybe Dec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Kind -&gt; Dec
</span><span class="hs-identifier hs-var">SigD</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411631"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-533"></span><span>           </span><span class="annot"><span class="annottext">(Kind -&gt; Dec) -&gt; Kind -&gt; Dec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBndr] -&gt; Bool -&gt; Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Reify.html#quantifyClassMethodType"><span class="hs-identifier hs-var">quantifyClassMethodType</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411638"><span class="hs-identifier hs-var">cls_name</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411637"><span class="hs-identifier hs-var">cls_tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679411629"><span class="hs-identifier hs-var">prepend_cls</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411630"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span>    </span><span class="annot"><a href="#local-6989586621679411632"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679411628"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679411628"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OpenTypeFamilyD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; Maybe Dec
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679411628"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-536"></span><span>    </span><span class="annot"><a href="#local-6989586621679411632"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679411627"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679411627"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DataFamilyD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; Maybe Dec
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679411627"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-cpp">
#endif
</span><span>    </span><span class="annot"><a href="#local-6989586621679411632"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Dec
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span>    </span><span class="hs-comment">-- See (2) in the comments for quantifyClassDecMethods.</span><span>
</span><span id="line-541"></span><span>    </span><span class="annot"><a href="#local-6989586621679411629"><span class="hs-identifier hs-type">prepend_cls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span>    </span><span id="local-6989586621679411629"><span class="annot"><span class="annottext">prepend_cls :: Bool
</span><a href="#local-6989586621679411629"><span class="hs-identifier hs-var hs-var">prepend_cls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-identifier">prepend_cls</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#quantifyClassDecMethods"><span class="hs-identifier hs-var">quantifyClassDecMethods</span></a></span><span> </span><span id="local-6989586621679411626"><span class="annot"><span class="annottext">dec :: Dec
</span><a href="#local-6989586621679411626"><span class="hs-identifier hs-var">dec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679411626"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-548"></span><span>
</span><span id="line-549"></span><span class="hs-comment">-- Add explicit quantification to a class method's type if necessary. In this</span><span>
</span><span id="line-550"></span><span class="hs-comment">-- example:</span><span>
</span><span id="line-551"></span><span class="hs-comment">--</span><span>
</span><span id="line-552"></span><span class="hs-comment">--   [d| class C a where</span><span>
</span><span id="line-553"></span><span class="hs-comment">--         method :: a -&gt; b -&gt; a |]</span><span>
</span><span id="line-554"></span><span class="hs-comment">--</span><span>
</span><span id="line-555"></span><span class="hs-comment">-- If one invokes `quantifyClassMethodType C [a] prepend (a -&gt; b -&gt; a)`, then</span><span>
</span><span id="line-556"></span><span class="hs-comment">-- the output will be:</span><span>
</span><span id="line-557"></span><span class="hs-comment">--</span><span>
</span><span id="line-558"></span><span class="hs-comment">-- 1. `forall a. C a =&gt; forall b. a -&gt; b -&gt; a` (if `prepend` is True)</span><span>
</span><span id="line-559"></span><span class="hs-comment">-- 2.                  `forall b. a -&gt; b -&gt; a` (if `prepend` is False)</span><span>
</span><span id="line-560"></span><span class="hs-comment">--</span><span>
</span><span id="line-561"></span><span class="hs-comment">-- Whether you want `prepend` to be True or False depends on the situation.</span><span>
</span><span id="line-562"></span><span class="hs-comment">-- When reifying an entire type class, like C, one does not need to prepend a</span><span>
</span><span id="line-563"></span><span class="hs-comment">-- class context to each of the bundled method types (see the comments for</span><span>
</span><span id="line-564"></span><span class="hs-comment">-- quantifyClassDecMethods), so False is appropriate. When one is only reifying</span><span>
</span><span id="line-565"></span><span class="hs-comment">-- a single class method, like `method`, then one needs the class context to</span><span>
</span><span id="line-566"></span><span class="hs-comment">-- appear in the reified type, so `True` is appropriate.</span><span>
</span><span id="line-567"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#quantifyClassMethodType"><span class="hs-identifier hs-type">quantifyClassMethodType</span></a></span><span>
</span><span id="line-568"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>        </span><span class="hs-comment">-- ^ The class name.</span><span>
</span><span id="line-569"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ The class's type variable binders.</span><span>
</span><span id="line-570"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>        </span><span class="hs-comment">-- ^ If 'True', prepend a class predicate.</span><span>
</span><span id="line-571"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>        </span><span class="hs-comment">-- ^ The method type.</span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-573"></span><span id="quantifyClassMethodType"><span class="annot"><span class="annottext">quantifyClassMethodType :: Name -&gt; [TyVarBndr] -&gt; Bool -&gt; Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Reify.html#quantifyClassMethodType"><span class="hs-identifier hs-var hs-var">quantifyClassMethodType</span></a></span></span><span> </span><span id="local-6989586621679411625"><span class="annot"><span class="annottext">cls_name :: Name
</span><a href="#local-6989586621679411625"><span class="hs-identifier hs-var">cls_name</span></a></span></span><span> </span><span id="local-6989586621679411624"><span class="annot"><span class="annottext">cls_tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679411624"><span class="hs-identifier hs-var">cls_tvbs</span></a></span></span><span> </span><span id="local-6989586621679411623"><span class="annot"><span class="annottext">prepend :: Bool
</span><a href="#local-6989586621679411623"><span class="hs-identifier hs-var">prepend</span></a></span></span><span> </span><span id="local-6989586621679411622"><span class="annot"><span class="annottext">meth_ty :: Kind
</span><a href="#local-6989586621679411622"><span class="hs-identifier hs-var">meth_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-574"></span><span>  </span><span class="annot"><span class="annottext">Kind -&gt; Kind
</span><a href="#local-6989586621679411621"><span class="hs-identifier hs-var">add_cls_cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411620"><span class="hs-identifier hs-var">quantified_meth_ty</span></a></span><span>
</span><span id="line-575"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-576"></span><span>    </span><span class="annot"><a href="#local-6989586621679411621"><span class="hs-identifier hs-type">add_cls_cxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-577"></span><span>    </span><span id="local-6989586621679411621"><span class="annot"><span class="annottext">add_cls_cxt :: Kind -&gt; Kind
</span><a href="#local-6989586621679411621"><span class="hs-identifier hs-var hs-var">add_cls_cxt</span></a></span></span><span>
</span><span id="line-578"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679411623"><span class="hs-identifier hs-var">prepend</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; Cxt -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411619"><span class="hs-identifier hs-var">all_cls_tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679411618"><span class="hs-identifier hs-var">cls_cxt</span></a></span><span>
</span><span id="line-579"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-580"></span><span>
</span><span id="line-581"></span><span>    </span><span class="annot"><a href="#local-6989586621679411618"><span class="hs-identifier hs-type">cls_cxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 709
</span><span>    </span><span class="hs-identifier">cls_cxt</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">ClassP</span><span> </span><span class="hs-identifier">cls_name</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">tvbToType</span><span> </span><span class="hs-identifier">cls_tvbs</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span>    </span><span id="local-6989586621679411618"><span class="annot"><span class="annottext">cls_cxt :: Cxt
</span><a href="#local-6989586621679411618"><span class="hs-identifier hs-var hs-var">cls_cxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Kind -&gt; Kind -&gt; Kind) -&gt; Kind -&gt; Cxt -&gt; Kind
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">AppT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Kind
</span><span class="hs-identifier hs-var">ConT</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411625"><span class="hs-identifier hs-var">cls_name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyVarBndr -&gt; Kind) -&gt; [TyVarBndr] -&gt; Cxt
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#tvbToType"><span class="hs-identifier hs-var">tvbToType</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411624"><span class="hs-identifier hs-var">cls_tvbs</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-588"></span><span>    </span><span class="annot"><a href="#local-6989586621679411620"><span class="hs-identifier hs-type">quantified_meth_ty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-589"></span><span>    </span><span id="local-6989586621679411620"><span class="annot"><span class="annottext">quantified_meth_ty :: Kind
</span><a href="#local-6989586621679411620"><span class="hs-identifier hs-var hs-var">quantified_meth_ty</span></a></span></span><span>
</span><span id="line-590"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411613"><span class="hs-identifier hs-var">meth_tvbs</span></a></span><span>
</span><span id="line-591"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411622"><span class="hs-identifier hs-var">meth_ty</span></a></span><span>
</span><span id="line-592"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span id="local-6989586621679411612"><span class="annot"><span class="annottext">meth_tvbs' :: [TyVarBndr]
</span><a href="#local-6989586621679411612"><span class="hs-identifier hs-var">meth_tvbs'</span></a></span></span><span> </span><span id="local-6989586621679411611"><span class="annot"><span class="annottext">meth_ctxt :: Cxt
</span><a href="#local-6989586621679411611"><span class="hs-identifier hs-var">meth_ctxt</span></a></span></span><span> </span><span id="local-6989586621679411610"><span class="annot"><span class="annottext">meth_tau :: Kind
</span><a href="#local-6989586621679411610"><span class="hs-identifier hs-var">meth_tau</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411622"><span class="hs-identifier hs-var">meth_ty</span></a></span><span>
</span><span id="line-593"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; Cxt -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411613"><span class="hs-identifier hs-var">meth_tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; [TyVarBndr] -&gt; [TyVarBndr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411612"><span class="hs-identifier hs-var">meth_tvbs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679411611"><span class="hs-identifier hs-var">meth_ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411610"><span class="hs-identifier hs-var">meth_tau</span></a></span><span>
</span><span id="line-594"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-595"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; Cxt -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411613"><span class="hs-identifier hs-var">meth_tvbs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411622"><span class="hs-identifier hs-var">meth_ty</span></a></span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span>    </span><span class="annot"><a href="#local-6989586621679411613"><span class="hs-identifier hs-type">meth_tvbs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span class="hs-special">]</span><span>
</span><span id="line-598"></span><span>    </span><span id="local-6989586621679411613"><span class="annot"><span class="annottext">meth_tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679411613"><span class="hs-identifier hs-var hs-var">meth_tvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TyVarBndr -&gt; TyVarBndr -&gt; Bool)
-&gt; [TyVarBndr] -&gt; [TyVarBndr] -&gt; [TyVarBndr]
forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">deleteFirstsBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Name -&gt; Bool)
-&gt; (TyVarBndr -&gt; Name) -&gt; TyVarBndr -&gt; TyVarBndr -&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; Name
</span><span class="hs-identifier hs-var">tvName</span></span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cxt -&gt; [TyVarBndr]
</span><span class="hs-identifier hs-var">freeVariablesWellScoped</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411622"><span class="hs-identifier hs-var">meth_ty</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411619"><span class="hs-identifier hs-var">all_cls_tvbs</span></a></span><span>
</span><span id="line-600"></span><span>
</span><span id="line-601"></span><span>    </span><span class="hs-comment">-- Explicitly quantify any kind variables bound by the class, if any.</span><span>
</span><span id="line-602"></span><span>    </span><span class="annot"><a href="#local-6989586621679411619"><span class="hs-identifier hs-type">all_cls_tvbs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span class="hs-special">]</span><span>
</span><span id="line-603"></span><span>    </span><span id="local-6989586621679411619"><span class="annot"><span class="annottext">all_cls_tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679411619"><span class="hs-identifier hs-var hs-var">all_cls_tvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; [TyVarBndr]
</span><span class="hs-identifier hs-var">freeVariablesWellScoped</span></span><span> </span><span class="annot"><span class="annottext">(Cxt -&gt; [TyVarBndr]) -&gt; Cxt -&gt; [TyVarBndr]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(TyVarBndr -&gt; Kind) -&gt; [TyVarBndr] -&gt; Cxt
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Util.html#tvbToTypeWithSig"><span class="hs-identifier hs-var">tvbToTypeWithSig</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411624"><span class="hs-identifier hs-var">cls_tvbs</span></a></span><span>
</span><span id="line-604"></span><span>
</span><span id="line-605"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#stripInstanceDec"><span class="hs-identifier hs-type">stripInstanceDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 711
</span><span id="stripInstanceDec"><span class="annot"><span class="annottext">stripInstanceDec :: Dec -&gt; Dec
</span><a href="Language.Haskell.TH.Desugar.Reify.html#stripInstanceDec"><span class="hs-identifier hs-var hs-var">stripInstanceDec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InstanceD</span></span><span> </span><span id="local-6989586621679411606"><span class="annot"><span class="annottext">over :: Maybe Overlap
</span><a href="#local-6989586621679411606"><span class="hs-identifier hs-var">over</span></a></span></span><span> </span><span id="local-6989586621679411605"><span class="annot"><span class="annottext">cxt :: Cxt
</span><a href="#local-6989586621679411605"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679411604"><span class="annot"><span class="annottext">ty :: Kind
</span><a href="#local-6989586621679411604"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Overlap -&gt; Cxt -&gt; Kind -&gt; [Dec] -&gt; Dec
</span><span class="hs-identifier hs-var">InstanceD</span></span><span> </span><span class="annot"><span class="annottext">Maybe Overlap
</span><a href="#local-6989586621679411606"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679411605"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411604"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">stripInstanceDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">InstanceD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">InstanceD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#stripInstanceDec"><span class="hs-identifier hs-var">stripInstanceDec</span></a></span><span> </span><span id="local-6989586621679411603"><span class="annot"><span class="annottext">dec :: Dec
</span><a href="#local-6989586621679411603"><span class="hs-identifier hs-var">dec</span></a></span></span><span>                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679411603"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#mkArrows"><span class="hs-identifier hs-type">mkArrows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-614"></span><span id="mkArrows"><span class="annot"><span class="annottext">mkArrows :: Cxt -&gt; Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Reify.html#mkArrows"><span class="hs-identifier hs-var hs-var">mkArrows</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span id="local-6989586621679411602"><span class="annot"><span class="annottext">res_ty :: Kind
</span><a href="#local-6989586621679411602"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411602"><span class="hs-identifier hs-var">res_ty</span></a></span><span>
</span><span id="line-615"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#mkArrows"><span class="hs-identifier hs-var">mkArrows</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679411601"><span class="annot"><span class="annottext">t :: Kind
</span><a href="#local-6989586621679411601"><span class="hs-identifier hs-var">t</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679411600"><span class="annot"><span class="annottext">ts :: Cxt
</span><a href="#local-6989586621679411600"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679411599"><span class="annot"><span class="annottext">res_ty :: Kind
</span><a href="#local-6989586621679411599"><span class="hs-identifier hs-var">res_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">AppT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kind -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">AppT</span></span><span> </span><span class="annot"><span class="annottext">Kind
</span><span class="hs-identifier hs-var">ArrowT</span></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411601"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Kind -&gt; Kind) -&gt; Kind -&gt; Kind
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Reify.html#mkArrows"><span class="hs-identifier hs-var">mkArrows</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679411600"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411599"><span class="hs-identifier hs-var">res_ty</span></a></span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#maybeForallT"><span class="hs-identifier hs-type">maybeForallT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-618"></span><span id="maybeForallT"><span class="annot"><span class="annottext">maybeForallT :: [TyVarBndr] -&gt; Cxt -&gt; Kind -&gt; Kind
</span><a href="Language.Haskell.TH.Desugar.Reify.html#maybeForallT"><span class="hs-identifier hs-var hs-var">maybeForallT</span></a></span></span><span> </span><span id="local-6989586621679411597"><span class="annot"><span class="annottext">tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679411597"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679411596"><span class="annot"><span class="annottext">cxt :: Cxt
</span><a href="#local-6989586621679411596"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679411595"><span class="annot"><span class="annottext">ty :: Kind
</span><a href="#local-6989586621679411595"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-619"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411597"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679411596"><span class="hs-identifier hs-var">cxt</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411595"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-620"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span id="local-6989586621679411593"><span class="annot"><span class="annottext">tvbs2 :: [TyVarBndr]
</span><a href="#local-6989586621679411593"><span class="hs-identifier hs-var">tvbs2</span></a></span></span><span> </span><span id="local-6989586621679411592"><span class="annot"><span class="annottext">cxt2 :: Cxt
</span><a href="#local-6989586621679411592"><span class="hs-identifier hs-var">cxt2</span></a></span></span><span> </span><span id="local-6989586621679411591"><span class="annot"><span class="annottext">ty2 :: Kind
</span><a href="#local-6989586621679411591"><span class="hs-identifier hs-var">ty2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411595"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; Cxt -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411597"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; [TyVarBndr] -&gt; [TyVarBndr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411593"><span class="hs-identifier hs-var">tvbs2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679411596"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; Cxt -&gt; Cxt
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679411592"><span class="hs-identifier hs-var">cxt2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411591"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-621"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVarBndr] -&gt; Cxt -&gt; Kind -&gt; Kind
</span><span class="hs-identifier hs-var">ForallT</span></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679411597"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679411596"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Kind
</span><a href="#local-6989586621679411595"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-622"></span><span>
</span><span id="line-623"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#findCon"><span class="hs-identifier hs-type">findCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span id="findCon"><span class="annot"><span class="annottext">findCon :: Name -&gt; [Con] -&gt; Maybe (Named Con)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#findCon"><span class="hs-identifier hs-var hs-var">findCon</span></a></span></span><span> </span><span id="local-6989586621679411590"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411590"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Con -&gt; Maybe (Named Con)) -&gt; [Con] -&gt; Maybe (Named Con)
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; Maybe b
</span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Con -&gt; Maybe (Named Con)
</span><a href="#local-6989586621679411589"><span class="hs-identifier hs-var">match_con</span></a></span><span>
</span><span id="line-625"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-626"></span><span>    </span><span class="annot"><a href="#local-6989586621679411589"><span class="hs-identifier hs-type">match_con</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span class="hs-special">)</span><span>
</span><span id="line-627"></span><span>    </span><span id="local-6989586621679411589"><span class="annot"><span class="annottext">match_con :: Con -&gt; Maybe (Named Con)
</span><a href="#local-6989586621679411589"><span class="hs-identifier hs-var hs-var">match_con</span></a></span></span><span> </span><span id="local-6989586621679411588"><span class="annot"><span class="annottext">con :: Con
</span><a href="#local-6989586621679411588"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-628"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679411588"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-629"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">NormalC</span></span><span> </span><span id="local-6989586621679411587"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411587"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411590"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411587"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Named Con -&gt; Maybe (Named Con)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411587"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679411588"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">RecC</span></span><span> </span><span id="local-6989586621679411586"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411586"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411590"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411586"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Named Con -&gt; Maybe (Named Con)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411586"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679411588"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">InfixC</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411585"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411585"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411590"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411585"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Named Con -&gt; Maybe (Named Con)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411585"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679411588"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-632"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">ForallC</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411584"><span class="annot"><span class="annottext">c :: Con
</span><a href="#local-6989586621679411584"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Con -&gt; Maybe (Named Con)
</span><a href="#local-6989586621679411589"><span class="hs-identifier hs-var">match_con</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679411584"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-633"></span><span>                           </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679411583"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411583"><span class="hs-identifier hs-var">n'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Named Con -&gt; Maybe (Named Con)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411583"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679411588"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>                           </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Named Con)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span>        </span><span class="annot"><span class="hs-identifier hs-type">GadtC</span></span><span> </span><span id="local-6989586621679411582"><span class="annot"><span class="annottext">nms :: [Name]
</span><a href="#local-6989586621679411582"><span class="hs-identifier hs-var">nms</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Con -&gt; [Name] -&gt; Maybe (Named Con)
</span><a href="#local-6989586621679411581"><span class="hs-identifier hs-var">gadt_case</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679411588"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679411582"><span class="hs-identifier hs-var">nms</span></a></span><span>
</span><span id="line-637"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">RecGadtC</span></span><span> </span><span id="local-6989586621679411580"><span class="annot"><span class="annottext">nms :: [Name]
</span><a href="#local-6989586621679411580"><span class="hs-identifier hs-var">nms</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Con -&gt; [Name] -&gt; Maybe (Named Con)
</span><a href="#local-6989586621679411581"><span class="hs-identifier hs-var">gadt_case</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679411588"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679411580"><span class="hs-identifier hs-var">nms</span></a></span><span class="hs-cpp">
#endif
</span><span>        </span><span class="hs-identifier">_</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Named Con)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt; 710
</span><span>    </span><span class="annot"><a href="#local-6989586621679411581"><span class="hs-identifier hs-type">gadt_case</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span>    </span><span id="local-6989586621679411581"><span class="annot"><span class="annottext">gadt_case :: Con -&gt; [Name] -&gt; Maybe (Named Con)
</span><a href="#local-6989586621679411581"><span class="hs-identifier hs-var hs-var">gadt_case</span></a></span></span><span> </span><span id="local-6989586621679411579"><span class="annot"><span class="annottext">con :: Con
</span><a href="#local-6989586621679411579"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621679411578"><span class="annot"><span class="annottext">nms :: [Name]
</span><a href="#local-6989586621679411578"><span class="hs-identifier hs-var">nms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Bool) -&gt; [Name] -&gt; Maybe Name
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411590"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679411578"><span class="hs-identifier hs-var">nms</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-644"></span><span>                          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679411577"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411577"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Named Con -&gt; Maybe (Named Con)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411577"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679411579"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-645"></span><span>                          </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Named Con)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-648"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#findRecSelector"><span class="hs-identifier hs-type">findRecSelector</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-649"></span><span id="findRecSelector"><span class="annot"><span class="annottext">findRecSelector :: Name -&gt; [Con] -&gt; Maybe (Named Kind)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#findRecSelector"><span class="hs-identifier hs-var hs-var">findRecSelector</span></a></span></span><span> </span><span id="local-6989586621679411576"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411576"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Con -&gt; Maybe (Named Kind)) -&gt; [Con] -&gt; Maybe (Named Kind)
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; Maybe b
</span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Con -&gt; Maybe (Named Kind)
</span><a href="#local-6989586621679411575"><span class="hs-identifier hs-var">match_con</span></a></span><span>
</span><span id="line-650"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-651"></span><span>    </span><span id="local-6989586621679411575"><span class="annot"><span class="annottext">match_con :: Con -&gt; Maybe (Named Kind)
</span><a href="#local-6989586621679411575"><span class="hs-identifier hs-var hs-var">match_con</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecC</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411574"><span class="annot"><span class="annottext">vstys :: [VarBangType]
</span><a href="#local-6989586621679411574"><span class="hs-identifier hs-var">vstys</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarBangType -&gt; Maybe (Named Kind))
-&gt; [VarBangType] -&gt; Maybe (Named Kind)
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; Maybe b
</span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a></span><span> </span><span class="annot"><span class="annottext">VarBangType -&gt; Maybe (Named Kind)
forall b b. (Name, b, b) -&gt; Maybe (Name, b)
</span><a href="#local-6989586621679411573"><span class="hs-identifier hs-var">match_rec_sel</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679411574"><span class="hs-identifier hs-var">vstys</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>    </span><span class="annot"><a href="#local-6989586621679411575"><span class="hs-identifier hs-var">match_con</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecGadtC</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411572"><span class="annot"><span class="annottext">vstys :: [VarBangType]
</span><a href="#local-6989586621679411572"><span class="hs-identifier hs-var">vstys</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarBangType -&gt; Maybe (Named Kind))
-&gt; [VarBangType] -&gt; Maybe (Named Kind)
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; Maybe b
</span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a></span><span> </span><span class="annot"><span class="annottext">VarBangType -&gt; Maybe (Named Kind)
forall b b. (Name, b, b) -&gt; Maybe (Name, b)
</span><a href="#local-6989586621679411573"><span class="hs-identifier hs-var">match_rec_sel</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679411572"><span class="hs-identifier hs-var">vstys</span></a></span><span class="hs-cpp">
#endif
</span><span>    </span><span class="annot"><a href="#local-6989586621679411575"><span class="hs-identifier hs-var">match_con</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallC</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411571"><span class="annot"><span class="annottext">c :: Con
</span><a href="#local-6989586621679411571"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Con -&gt; Maybe (Named Kind)
</span><a href="#local-6989586621679411575"><span class="hs-identifier hs-var">match_con</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679411571"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-656"></span><span>    </span><span class="annot"><a href="#local-6989586621679411575"><span class="hs-identifier hs-var">match_con</span></a></span><span> </span><span class="hs-identifier">_</span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Named Kind)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-657"></span><span>
</span><span id="line-658"></span><span>    </span><span id="local-6989586621679411573"><span class="annot"><span class="annottext">match_rec_sel :: (Name, b, b) -&gt; Maybe (Name, b)
</span><a href="#local-6989586621679411573"><span class="hs-identifier hs-var hs-var">match_rec_sel</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679411570"><span class="annot"><span class="annottext">n' :: Name
</span><a href="#local-6989586621679411570"><span class="hs-identifier hs-var">n'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679411569"><span class="annot"><span class="annottext">ty :: b
</span><a href="#local-6989586621679411569"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411576"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#nameMatches"><span class="hs-operator hs-var">`nameMatches`</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411570"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Name, b) -&gt; Maybe (Name, b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411570"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679411569"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-659"></span><span>    </span><span class="annot"><a href="#local-6989586621679411573"><span class="hs-identifier hs-var">match_rec_sel</span></a></span><span> </span><span class="hs-identifier">_</span><span>                                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Name, b)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-660"></span><span>
</span><span id="line-661"></span><span class="hs-comment">---------------------------------</span><span>
</span><span id="line-662"></span><span class="hs-comment">-- Reifying fixities</span><span>
</span><span id="line-663"></span><span class="hs-comment">---------------------------------</span><span>
</span><span id="line-664"></span><span class="hs-comment">--</span><span>
</span><span id="line-665"></span><span class="hs-comment">-- This section allows GHC 7.x to call reifyFixity</span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &lt; 711
</span><span class="hs-identifier">qReifyFixity</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Quasi</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">Fixity</span><span class="hs-special">)</span><span>
</span><span id="line-669"></span><span class="hs-identifier">qReifyFixity</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-670"></span><span>  </span><span class="hs-identifier">info</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">qReify</span><span> </span><span class="hs-identifier">name</span><span>
</span><span id="line-671"></span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">info</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-672"></span><span>    </span><span class="hs-identifier">ClassOpI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">fixity</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">fixity</span><span>
</span><span id="line-673"></span><span>    </span><span class="hs-identifier">DataConI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">fixity</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">fixity</span><span>
</span><span id="line-674"></span><span>    </span><span class="hs-identifier">VarI</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">fixity</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">fixity</span><span>
</span><span id="line-675"></span><span>    </span><span class="hs-identifier">_</span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-676"></span><span>
</span><span id="line-677"></span><span class="hs-comment">{- | @reifyFixity nm@ attempts to find a fixity declaration for @nm@. For
example, if the function @foo@ has the fixity declaration @infixr 7 foo@, then
@reifyFixity 'foo@ would return @'Just' ('Fixity' 7 'InfixR')@. If the function
@bar@ does not have a fixity declaration, then @reifyFixity 'bar@ returns
'Nothing', so you may assume @bar@ has 'defaultFixity'.
-}</span><span>
</span><span id="line-683"></span><span class="hs-identifier">reifyFixity</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Q</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">Fixity</span><span class="hs-special">)</span><span>
</span><span id="line-684"></span><span class="hs-identifier">reifyFixity</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">qReifyFixity</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-687"></span><span class="hs-comment">-- | Like 'reifyWithLocals_maybe', but for fixities. Note that a return of</span><span>
</span><span id="line-688"></span><span class="hs-comment">-- @Nothing@ might mean that the name is not in scope, or it might mean</span><span>
</span><span id="line-689"></span><span class="hs-comment">-- that the name has no assigned fixity. (Use 'reifyWithLocals_maybe' if</span><span>
</span><span id="line-690"></span><span class="hs-comment">-- you really need to tell the difference.)</span><span>
</span><span id="line-691"></span><span id="local-6989586621679411568"><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFixityWithLocals"><span class="hs-identifier hs-type">reifyFixityWithLocals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679411568"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679411568"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fixity</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-692"></span><span id="reifyFixityWithLocals"><span class="annot"><span class="annottext">reifyFixityWithLocals :: Name -&gt; q (Maybe Fixity)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFixityWithLocals"><span class="hs-identifier hs-var hs-var">reifyFixityWithLocals</span></a></span></span><span> </span><span id="local-6989586621679411567"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679411567"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">q (Maybe Fixity) -&gt; q (Maybe Fixity) -&gt; q (Maybe Fixity)
forall (m :: * -&gt; *) a. Quasi m =&gt; m a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">qRecover</span></span><span>
</span><span id="line-693"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Fixity -&gt; q (Maybe Fixity)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Fixity -&gt; q (Maybe Fixity))
-&gt; ([Dec] -&gt; Maybe Fixity) -&gt; [Dec] -&gt; q (Maybe Fixity)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; Maybe Fixity
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFixityInDecs"><span class="hs-identifier hs-var">reifyFixityInDecs</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411567"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">([Dec] -&gt; q (Maybe Fixity)) -&gt; q [Dec] -&gt; q (Maybe Fixity)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">q [Dec]
forall (m :: * -&gt; *). DsMonad m =&gt; m [Dec]
</span><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier hs-var">localDeclarations</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-694"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; q (Maybe Fixity)
forall (m :: * -&gt; *). Quasi m =&gt; Name -&gt; m (Maybe Fixity)
</span><span class="hs-identifier hs-var">qReifyFixity</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411567"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-695"></span><span>
</span><span id="line-696"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-697"></span><span class="hs-comment">-- Lookuping name value and type names</span><span>
</span><span id="line-698"></span><span class="hs-comment">--------------------------------------</span><span>
</span><span id="line-699"></span><span>
</span><span id="line-700"></span><span class="hs-comment">-- | Like 'lookupValueName' from Template Haskell, but looks also in 'Names' of</span><span>
</span><span id="line-701"></span><span class="hs-comment">-- not-yet-typechecked declarations. To establish this list of not-yet-typechecked</span><span>
</span><span id="line-702"></span><span class="hs-comment">-- declarations, use 'withLocalDeclarations'. Returns 'Nothing' if no value</span><span>
</span><span id="line-703"></span><span class="hs-comment">-- with the same name can be found.</span><span>
</span><span id="line-704"></span><span id="local-6989586621679412101"><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#lookupValueNameWithLocals"><span class="hs-identifier hs-type">lookupValueNameWithLocals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679412101"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679412101"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-705"></span><span id="lookupValueNameWithLocals"><span class="annot"><span class="annottext">lookupValueNameWithLocals :: String -&gt; q (Maybe Name)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#lookupValueNameWithLocals"><span class="hs-identifier hs-var hs-var">lookupValueNameWithLocals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; q (Maybe Name)
forall (q :: * -&gt; *). DsMonad q =&gt; Bool -&gt; String -&gt; q (Maybe Name)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#lookupNameWithLocals"><span class="hs-identifier hs-var">lookupNameWithLocals</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-706"></span><span>
</span><span id="line-707"></span><span class="hs-comment">-- | Like 'lookupTypeName' from Template Haskell, but looks also in 'Names' of</span><span>
</span><span id="line-708"></span><span class="hs-comment">-- not-yet-typechecked declarations. To establish this list of not-yet-typechecked</span><span>
</span><span id="line-709"></span><span class="hs-comment">-- declarations, use 'withLocalDeclarations'. Returns 'Nothing' if no type</span><span>
</span><span id="line-710"></span><span class="hs-comment">-- with the same name can be found.</span><span>
</span><span id="line-711"></span><span id="local-6989586621679411565"><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#lookupTypeNameWithLocals"><span class="hs-identifier hs-type">lookupTypeNameWithLocals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679411565"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679411565"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-712"></span><span id="lookupTypeNameWithLocals"><span class="annot"><span class="annottext">lookupTypeNameWithLocals :: String -&gt; q (Maybe Name)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#lookupTypeNameWithLocals"><span class="hs-identifier hs-var hs-var">lookupTypeNameWithLocals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; q (Maybe Name)
forall (q :: * -&gt; *). DsMonad q =&gt; Bool -&gt; String -&gt; q (Maybe Name)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#lookupNameWithLocals"><span class="hs-identifier hs-var">lookupNameWithLocals</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-713"></span><span>
</span><span id="line-714"></span><span id="local-6989586621679412108"><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#lookupNameWithLocals"><span class="hs-identifier hs-type">lookupNameWithLocals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679412108"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679412108"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-715"></span><span id="lookupNameWithLocals"><span class="annot"><span class="annottext">lookupNameWithLocals :: Bool -&gt; String -&gt; q (Maybe Name)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#lookupNameWithLocals"><span class="hs-identifier hs-var hs-var">lookupNameWithLocals</span></a></span></span><span> </span><span id="local-6989586621679411564"><span class="annot"><span class="annottext">ns :: Bool
</span><a href="#local-6989586621679411564"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span id="local-6989586621679411563"><span class="annot"><span class="annottext">s :: String
</span><a href="#local-6989586621679411563"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-716"></span><span>    </span><span id="local-6989586621679411562"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679411562"><span class="hs-identifier hs-var">mb_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; q (Maybe Name)
forall (m :: * -&gt; *). Quasi m =&gt; Bool -&gt; String -&gt; m (Maybe Name)
</span><span class="hs-identifier hs-var">qLookupName</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679411564"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679411563"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-717"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679411562"><span class="hs-identifier hs-var">mb_name</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-718"></span><span>      </span><span id="local-6989586621679411560"><span class="annot"><span class="annottext">j_name :: Maybe Name
</span><a href="#local-6989586621679411560"><span class="hs-identifier hs-var">j_name</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Name -&gt; q (Maybe Name)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679411560"><span class="hs-identifier hs-var">j_name</span></a></span><span>
</span><span id="line-719"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">q (Maybe Name)
</span><a href="#local-6989586621679411559"><span class="hs-identifier hs-var">consult_locals</span></a></span><span>
</span><span id="line-720"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-721"></span><span>    </span><span id="local-6989586621679411558"><span class="annot"><span class="annottext">built_name :: Name
</span><a href="#local-6989586621679411558"><span class="hs-identifier hs-var hs-var">built_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><span class="hs-identifier hs-var">mkName</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679411563"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-722"></span><span>
</span><span id="line-723"></span><span>    </span><span id="local-6989586621679411559"><span class="annot"><span class="annottext">consult_locals :: q (Maybe Name)
</span><a href="#local-6989586621679411559"><span class="hs-identifier hs-var hs-var">consult_locals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-724"></span><span>      </span><span id="local-6989586621679411557"><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411557"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">q [Dec]
forall (m :: * -&gt; *). DsMonad m =&gt; m [Dec]
</span><a href="Language.Haskell.TH.Desugar.Reify.html#localDeclarations"><span class="hs-identifier hs-var">localDeclarations</span></a></span><span>
</span><span id="line-725"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679411556"><span class="annot"><span class="annottext">mb_infos :: [Maybe (Name, Info)]
</span><a href="#local-6989586621679411556"><span class="hs-identifier hs-var hs-var">mb_infos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; Maybe (Name, Info)) -&gt; [Dec] -&gt; [Maybe (Name, Info)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Dec] -&gt; Dec -&gt; Maybe (Name, Info)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyInDec"><span class="hs-identifier hs-var">reifyInDec</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411558"><span class="hs-identifier hs-var">built_name</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411557"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679411557"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-726"></span><span>          </span><span id="local-6989586621679411555"><span class="annot"><span class="annottext">infos :: [(Name, Info)]
</span><a href="#local-6989586621679411555"><span class="hs-identifier hs-var hs-var">infos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe (Name, Info)] -&gt; [(Name, Info)]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (Name, Info)]
</span><a href="#local-6989586621679411556"><span class="hs-identifier hs-var">mb_infos</span></a></span><span>
</span><span id="line-727"></span><span>      </span><span class="annot"><span class="annottext">Maybe Name -&gt; q (Maybe Name)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Name -&gt; q (Maybe Name)) -&gt; Maybe Name -&gt; q (Maybe Name)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Name, Info) -&gt; Maybe Name) -&gt; [(Name, Info)] -&gt; Maybe Name
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; Maybe b
</span><a href="Language.Haskell.TH.Desugar.Util.html#firstMatch"><span class="hs-identifier hs-var">firstMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679411564"><span class="hs-identifier hs-var">ns</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe Name
</span><a href="#local-6989586621679411553"><span class="hs-identifier hs-var">find_type_name</span></a></span><span>
</span><span id="line-728"></span><span>                                 </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Name, Info) -&gt; Maybe Name
</span><a href="#local-6989586621679411552"><span class="hs-identifier hs-var">find_value_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Name, Info)]
</span><a href="#local-6989586621679411555"><span class="hs-identifier hs-var">infos</span></a></span><span>
</span><span id="line-729"></span><span>
</span><span id="line-730"></span><span>    </span><span class="hs-comment">-- These functions work over Named Infos so we can avoid performing</span><span>
</span><span id="line-731"></span><span>    </span><span class="hs-comment">-- tiresome pattern-matching to retrieve the name associated with each Info.</span><span>
</span><span id="line-732"></span><span>    </span><span class="annot"><a href="#local-6989586621679411553"><span class="hs-identifier hs-type">find_type_name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679411552"><span class="hs-identifier hs-type">find_value_name</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#Named"><span class="hs-identifier hs-type">Named</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Info</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-733"></span><span>    </span><span id="local-6989586621679411553"><span class="annot"><span class="annottext">find_type_name :: (Name, Info) -&gt; Maybe Name
</span><a href="#local-6989586621679411553"><span class="hs-identifier hs-var hs-var">find_type_name</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679411551"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411551"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679411550"><span class="annot"><span class="annottext">info :: Info
</span><a href="#local-6989586621679411550"><span class="hs-identifier hs-var">info</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-734"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Info -&gt; NameSpace
</span><a href="Language.Haskell.TH.Desugar.Reify.html#infoNameSpace"><span class="hs-identifier hs-var">infoNameSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679411550"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-735"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">TcClsName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411551"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-736"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">VarName</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-737"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">DataName</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-738"></span><span>
</span><span id="line-739"></span><span>    </span><span id="local-6989586621679411552"><span class="annot"><span class="annottext">find_value_name :: (Name, Info) -&gt; Maybe Name
</span><a href="#local-6989586621679411552"><span class="hs-identifier hs-var hs-var">find_value_name</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679411545"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411545"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679411544"><span class="annot"><span class="annottext">info :: Info
</span><a href="#local-6989586621679411544"><span class="hs-identifier hs-var">info</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-740"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Info -&gt; NameSpace
</span><a href="Language.Haskell.TH.Desugar.Reify.html#infoNameSpace"><span class="hs-identifier hs-var">infoNameSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679411544"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-741"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">VarName</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411545"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-742"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">DataName</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411545"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-743"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">TcClsName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-744"></span><span>
</span><span id="line-745"></span><span class="hs-comment">-- | Like TH's @lookupValueName@, but if this name is not bound, then we assume</span><span>
</span><span id="line-746"></span><span class="hs-comment">-- it is declared in the current module.</span><span>
</span><span id="line-747"></span><span class="hs-comment">--</span><span>
</span><span id="line-748"></span><span class="hs-comment">-- Unlike 'mkDataName', this also consults the local declarations in scope when</span><span>
</span><span id="line-749"></span><span class="hs-comment">-- determining if the name is currently bound.</span><span>
</span><span id="line-750"></span><span id="local-6989586621679411543"><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#mkDataNameWithLocals"><span class="hs-identifier hs-type">mkDataNameWithLocals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679411543"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679411543"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span></span><span>
</span><span id="line-751"></span><span id="mkDataNameWithLocals"><span class="annot"><span class="annottext">mkDataNameWithLocals :: String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Reify.html#mkDataNameWithLocals"><span class="hs-identifier hs-var hs-var">mkDataNameWithLocals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; q (Maybe Name))
-&gt; (String -&gt; String -&gt; String -&gt; Name) -&gt; String -&gt; q Name
forall (q :: * -&gt; *).
Quasi q =&gt;
(String -&gt; q (Maybe Name))
-&gt; (String -&gt; String -&gt; String -&gt; Name) -&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#mkNameWith"><span class="hs-identifier hs-var">mkNameWith</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; q (Maybe Name)
forall (q :: * -&gt; *). DsMonad q =&gt; String -&gt; q (Maybe Name)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#lookupValueNameWithLocals"><span class="hs-identifier hs-var">lookupValueNameWithLocals</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; Name
</span><span class="hs-identifier hs-var">mkNameG_d</span></span><span>
</span><span id="line-752"></span><span>
</span><span id="line-753"></span><span class="hs-comment">-- | Like TH's @lookupTypeName@, but if this name is not bound, then we assume</span><span>
</span><span id="line-754"></span><span class="hs-comment">-- it is declared in the current module.</span><span>
</span><span id="line-755"></span><span class="hs-comment">--</span><span>
</span><span id="line-756"></span><span class="hs-comment">-- Unlike 'mkTypeName', this also consults the local declarations in scope when</span><span>
</span><span id="line-757"></span><span class="hs-comment">-- determining if the name is currently bound.</span><span>
</span><span id="line-758"></span><span id="local-6989586621679411541"><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#mkTypeNameWithLocals"><span class="hs-identifier hs-type">mkTypeNameWithLocals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679411541"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679411541"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span></span><span>
</span><span id="line-759"></span><span id="mkTypeNameWithLocals"><span class="annot"><span class="annottext">mkTypeNameWithLocals :: String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Reify.html#mkTypeNameWithLocals"><span class="hs-identifier hs-var hs-var">mkTypeNameWithLocals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; q (Maybe Name))
-&gt; (String -&gt; String -&gt; String -&gt; Name) -&gt; String -&gt; q Name
forall (q :: * -&gt; *).
Quasi q =&gt;
(String -&gt; q (Maybe Name))
-&gt; (String -&gt; String -&gt; String -&gt; Name) -&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#mkNameWith"><span class="hs-identifier hs-var">mkNameWith</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; q (Maybe Name)
forall (q :: * -&gt; *). DsMonad q =&gt; String -&gt; q (Maybe Name)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#lookupTypeNameWithLocals"><span class="hs-identifier hs-var">lookupTypeNameWithLocals</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; Name
</span><span class="hs-identifier hs-var">mkNameG_tc</span></span><span>
</span><span id="line-760"></span><span>
</span><span id="line-761"></span><span class="hs-comment">-- | Determines a `Name`'s 'NameSpace'. If the 'NameSpace' is attached to</span><span>
</span><span id="line-762"></span><span class="hs-comment">-- the 'Name' itself (i.e., it is unambiguous), then that 'NameSpace' is</span><span>
</span><span id="line-763"></span><span class="hs-comment">-- immediately returned. Otherwise, reification is used to lookup up the</span><span>
</span><span id="line-764"></span><span class="hs-comment">-- 'NameSpace' (consulting local declarations if necessary).</span><span>
</span><span id="line-765"></span><span class="hs-comment">--</span><span>
</span><span id="line-766"></span><span class="hs-comment">-- Note that if a 'Name' lives in two different 'NameSpaces' (which can</span><span>
</span><span id="line-767"></span><span class="hs-comment">-- genuinely happen--for instance, @'mkName' \&quot;==\&quot;@, where @==@ is both</span><span>
</span><span id="line-768"></span><span class="hs-comment">-- a function and a type family), then this function will simply return</span><span>
</span><span id="line-769"></span><span class="hs-comment">-- whichever 'NameSpace' is discovered first via reification. If you wish</span><span>
</span><span id="line-770"></span><span class="hs-comment">-- to find a 'Name' in a particular 'NameSpace', use the</span><span>
</span><span id="line-771"></span><span class="hs-comment">-- 'lookupValueNameWithLocals' or 'lookupTypeNameWithLocals' functions.</span><span>
</span><span id="line-772"></span><span id="local-6989586621679411540"><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#reifyNameSpace"><span class="hs-identifier hs-type">reifyNameSpace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679411540"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679411540"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NameSpace</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-773"></span><span id="reifyNameSpace"><span class="annot"><span class="annottext">reifyNameSpace :: Name -&gt; q (Maybe NameSpace)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyNameSpace"><span class="hs-identifier hs-var hs-var">reifyNameSpace</span></a></span></span><span> </span><span id="local-6989586621679411539"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679411539"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679411537"><span class="annot"><span class="annottext">nf :: NameFlavour
</span><a href="#local-6989586621679411537"><span class="hs-identifier hs-var">nf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-774"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NameFlavour
</span><a href="#local-6989586621679411537"><span class="hs-identifier hs-var">nf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-775"></span><span>    </span><span class="hs-comment">-- NameGs are simple, as they have a NameSpace attached.</span><span>
</span><span id="line-776"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">NameG</span></span><span> </span><span id="local-6989586621679411535"><span class="annot"><span class="annottext">ns :: NameSpace
</span><a href="#local-6989586621679411535"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe NameSpace -&gt; q (Maybe NameSpace)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe NameSpace -&gt; q (Maybe NameSpace))
-&gt; Maybe NameSpace -&gt; q (Maybe NameSpace)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NameSpace -&gt; Maybe NameSpace
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><a href="#local-6989586621679411535"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-777"></span><span>
</span><span id="line-778"></span><span>    </span><span class="hs-comment">-- For other names, we must use reification to determine what NameSpace</span><span>
</span><span id="line-779"></span><span>    </span><span class="hs-comment">-- it lives in (if any).</span><span>
</span><span id="line-780"></span><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679411534"><span class="annot"><span class="annottext">Maybe Info
</span><a href="#local-6989586621679411534"><span class="hs-identifier hs-var">mb_info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q (Maybe Info)
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q (Maybe Info)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals_maybe"><span class="hs-identifier hs-var">reifyWithLocals_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679411539"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-781"></span><span>            </span><span class="annot"><span class="annottext">Maybe NameSpace -&gt; q (Maybe NameSpace)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe NameSpace -&gt; q (Maybe NameSpace))
-&gt; Maybe NameSpace -&gt; q (Maybe NameSpace)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Info -&gt; NameSpace) -&gt; Maybe Info -&gt; Maybe NameSpace
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Info -&gt; NameSpace
</span><a href="Language.Haskell.TH.Desugar.Reify.html#infoNameSpace"><span class="hs-identifier hs-var">infoNameSpace</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Info
</span><a href="#local-6989586621679411534"><span class="hs-identifier hs-var">mb_info</span></a></span><span>
</span><span id="line-782"></span><span>
</span><span id="line-783"></span><span class="hs-comment">-- | Determine a name's 'NameSpace' from its 'Info'.</span><span>
</span><span id="line-784"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#infoNameSpace"><span class="hs-identifier hs-type">infoNameSpace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Info</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NameSpace</span></span><span>
</span><span id="line-785"></span><span id="infoNameSpace"><span class="annot"><span class="annottext">infoNameSpace :: Info -&gt; NameSpace
</span><a href="Language.Haskell.TH.Desugar.Reify.html#infoNameSpace"><span class="hs-identifier hs-var hs-var">infoNameSpace</span></a></span></span><span> </span><span id="local-6989586621679411533"><span class="annot"><span class="annottext">info :: Info
</span><a href="#local-6989586621679411533"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-786"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679411533"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-787"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">ClassI</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><span class="hs-identifier hs-var">TcClsName</span></span><span>
</span><span id="line-788"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">TyConI</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><span class="hs-identifier hs-var">TcClsName</span></span><span>
</span><span id="line-789"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">FamilyI</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><span class="hs-identifier hs-var">TcClsName</span></span><span>
</span><span id="line-790"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">PrimTyConI</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><span class="hs-identifier hs-var">TcClsName</span></span><span>
</span><span id="line-791"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">TyVarI</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><span class="hs-identifier hs-var">TcClsName</span></span><span>
</span><span id="line-792"></span><span>
</span><span id="line-793"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">ClassOpI</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><span class="hs-identifier hs-var">VarName</span></span><span>
</span><span id="line-794"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">VarI</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><span class="hs-identifier hs-var">VarName</span></span><span>
</span><span id="line-795"></span><span>
</span><span id="line-796"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">DataConI</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><span class="hs-identifier hs-var">DataName</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span>    </span><span class="annot"><span class="hs-identifier hs-type">PatSynI</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NameSpace
</span><span class="hs-identifier hs-var">DataName</span></span><span class="hs-cpp">
#endif
</span></pre></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- Language/Haskell/TH/Desugar/Core.hs

(c) Richard Eisenberg 2013
rae@cs.brynmawr.edu

Desugars full Template Haskell syntax into a smaller core syntax for further
processing. The desugared types and constructors are prefixed with a D.
-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell, LambdaCase, CPP, ScopedTypeVariables,
             TupleSections, DeriveDataTypeable, DeriveGeneric #-}</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Haskell.TH.Desugar.Core</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldl</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">all</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">elem</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">exp</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">concatMap</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">and</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">match</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">clause</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cxt</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Syntax</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lift</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Datatype</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">resolveTypeSynonyms</span></span><span> </span><span class="hs-special">)</span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &lt; 709
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Applicative</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">forM_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapM</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Fail</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Fail</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Zip</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Writer</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">forM_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapM</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Data</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Data</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lefts</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">concat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">notElem</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Traversable</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Fail</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MonadFail</span></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 803
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.OverloadedLabels</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">fromLabel</span></span><span> </span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Classes</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IP</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Exts</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.AST</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.FV.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.FV</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.OSet</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">OS</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.OSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html#OSet"><span class="hs-identifier">OSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.Util</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html"><span class="hs-identifier">Language.Haskell.TH.Desugar.Reify</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- | Desugar an expression</span><span>
</span><span id="line-64"></span><span id="local-6989586621679414024"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-type">dsExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679414024"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679414024"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-65"></span><span id="dsExp"><span class="annot"><span class="annottext">dsExp :: Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var hs-var">dsExp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarE</span></span><span> </span><span id="local-6989586621679413600"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679413600"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413600"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-66"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConE</span></span><span> </span><span id="local-6989586621679413597"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679413597"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413597"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-67"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LitE</span></span><span> </span><span id="local-6989586621679413594"><span class="annot"><span class="annottext">lit :: Lit
</span><a href="#local-6989586621679413594"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span> </span><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679413594"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-68"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppE</span></span><span> </span><span id="local-6989586621679413591"><span class="annot"><span class="annottext">e1 :: Exp
</span><a href="#local-6989586621679413591"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679413590"><span class="annot"><span class="annottext">e2 :: Exp
</span><a href="#local-6989586621679413590"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; q DExp -&gt; q (DExp -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413591"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">q (DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413590"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-69"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixE</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span id="local-6989586621679413586"><span class="annot"><span class="annottext">op :: Exp
</span><a href="#local-6989586621679413586"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413586"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-70"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679413585"><span class="annot"><span class="annottext">lhs :: Exp
</span><a href="#local-6989586621679413585"><span class="hs-identifier hs-var">lhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679413584"><span class="annot"><span class="annottext">op :: Exp
</span><a href="#local-6989586621679413584"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; q DExp -&gt; q (DExp -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413584"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">q (DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413585"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixE</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span id="local-6989586621679413583"><span class="annot"><span class="annottext">op :: Exp
</span><a href="#local-6989586621679413583"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679413582"><span class="annot"><span class="annottext">rhs :: Exp
</span><a href="#local-6989586621679413582"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-72"></span><span>  </span><span id="local-6989586621679413581"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413581"><span class="hs-identifier hs-var">lhsName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;lhs&quot;</span></span><span>
</span><span id="line-73"></span><span>  </span><span id="local-6989586621679413579"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413579"><span class="hs-identifier hs-var">op'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413583"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span id="local-6989586621679413578"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413578"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413582"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLamE"><span class="hs-identifier hs-var">DLamE</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413581"><span class="hs-identifier hs-var">lhsName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; DExp -&gt; [DExp] -&gt; DExp
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413579"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413581"><span class="hs-identifier hs-var">lhsName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413578"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679413576"><span class="annot"><span class="annottext">lhs :: Exp
</span><a href="#local-6989586621679413576"><span class="hs-identifier hs-var">lhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679413575"><span class="annot"><span class="annottext">op :: Exp
</span><a href="#local-6989586621679413575"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679413574"><span class="annot"><span class="annottext">rhs :: Exp
</span><a href="#local-6989586621679413574"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-77"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; q DExp -&gt; q (DExp -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; q DExp -&gt; q (DExp -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413575"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">q (DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413576"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">q (DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413574"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-78"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UInfixE</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; q DExp
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Cannot desugar unresolved infix operators.&quot;</span></span><span>
</span><span id="line-80"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensE</span></span><span> </span><span id="local-6989586621679413571"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413571"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413571"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-81"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LamE</span></span><span> </span><span id="local-6989586621679413569"><span class="annot"><span class="annottext">pats :: [Pat]
</span><a href="#local-6989586621679413569"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span id="local-6989586621679413568"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413568"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Pat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLam"><span class="hs-identifier hs-var">dsLam</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679413569"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; q DExp -&gt; q DExp
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413568"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-82"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LamCaseE</span></span><span> </span><span id="local-6989586621679413564"><span class="annot"><span class="annottext">matches :: [Match]
</span><a href="#local-6989586621679413564"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-83"></span><span>  </span><span id="local-6989586621679413563"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413563"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;x&quot;</span></span><span>
</span><span id="line-84"></span><span>  </span><span id="local-6989586621679413562"><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679413562"><span class="hs-identifier hs-var">matches'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Match] -&gt; q [DMatch]
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; [Match] -&gt; q [DMatch]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsMatches"><span class="hs-identifier hs-var">dsMatches</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413563"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[Match]
</span><a href="#local-6989586621679413564"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLamE"><span class="hs-identifier hs-var">DLamE</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413563"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413563"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679413562"><span class="hs-identifier hs-var">matches'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TupE</span></span><span> </span><span id="local-6989586621679413558"><span class="annot"><span class="annottext">exps :: [Exp]
</span><a href="#local-6989586621679413558"><span class="hs-identifier hs-var">exps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Name) -&gt; [Exp] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; (Int -&gt; Name) -&gt; [Exp] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTup"><span class="hs-identifier hs-var">dsTup</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679413558"><span class="hs-identifier hs-var">exps</span></a></span><span>
</span><span id="line-87"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedTupE</span></span><span> </span><span id="local-6989586621679413554"><span class="annot"><span class="annottext">exps :: [Exp]
</span><a href="#local-6989586621679413554"><span class="hs-identifier hs-var">exps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Name) -&gt; [Exp] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; (Int -&gt; Name) -&gt; [Exp] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTup"><span class="hs-identifier hs-var">dsTup</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">unboxedTupleDataName</span></span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679413554"><span class="hs-identifier hs-var">exps</span></a></span><span>
</span><span id="line-88"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CondE</span></span><span> </span><span id="local-6989586621679413551"><span class="annot"><span class="annottext">e1 :: Exp
</span><a href="#local-6989586621679413551"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679413550"><span class="annot"><span class="annottext">e2 :: Exp
</span><a href="#local-6989586621679413550"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621679413549"><span class="annot"><span class="annottext">e3 :: Exp
</span><a href="#local-6989586621679413549"><span class="hs-identifier hs-var">e3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-89"></span><span>  </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; [Match] -&gt; Exp
</span><span class="hs-identifier hs-var">CaseE</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413551"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Body -&gt; [Dec] -&gt; Match
</span><span class="hs-identifier hs-var">Match</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Pat
</span><span class="hs-identifier hs-var">ConP</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">True</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Body
</span><span class="hs-identifier hs-var">NormalB</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413550"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-90"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Body -&gt; [Dec] -&gt; Match
</span><span class="hs-identifier hs-var">Match</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Pat
</span><span class="hs-identifier hs-var">ConP</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">False</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Body
</span><span class="hs-identifier hs-var">NormalB</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413549"><span class="hs-identifier hs-var">e3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MultiIfE</span></span><span> </span><span id="local-6989586621679413543"><span class="annot"><span class="annottext">guarded_exps :: [(Guard, Exp)]
</span><a href="#local-6989586621679413543"><span class="hs-identifier hs-var">guarded_exps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679413542"><span class="annot"><span class="annottext">failure :: DExp
</span><a href="#local-6989586621679413542"><span class="hs-identifier hs-var hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">error</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Lit
</span><span class="hs-identifier hs-var">StringL</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Non-exhaustive guards in multi-way if&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><span class="annottext">[(Guard, Exp)] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [(Guard, Exp)] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var">dsGuards</span></a></span><span> </span><span class="annot"><span class="annottext">[(Guard, Exp)]
</span><a href="#local-6989586621679413543"><span class="hs-identifier hs-var">guarded_exps</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413542"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-94"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LetE</span></span><span> </span><span id="local-6989586621679413538"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679413538"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span id="local-6989586621679413537"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413537"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679413536"><span class="annot"><span class="annottext">decs' :: [DLetDec]
</span><a href="#local-6989586621679413536"><span class="hs-identifier hs-var">decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679413535"><span class="annot"><span class="annottext">ip_binder :: DExp -&gt; DExp
</span><a href="#local-6989586621679413535"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679413538"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-96"></span><span>  </span><span id="local-6989586621679413533"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413533"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413537"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetE"><span class="hs-identifier hs-var">DLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679413536"><span class="hs-identifier hs-var">decs'</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; DExp -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679413535"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413533"><span class="hs-identifier hs-var">exp'</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-comment">-- the following special case avoids creating a new &quot;let&quot; when it's not</span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-comment">-- necessary. See #34.</span><span>
</span><span id="line-100"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CaseE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarE</span></span><span> </span><span id="local-6989586621679413531"><span class="annot"><span class="annottext">scrutinee :: Name
</span><a href="#local-6989586621679413531"><span class="hs-identifier hs-var">scrutinee</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679413530"><span class="annot"><span class="annottext">matches :: [Match]
</span><a href="#local-6989586621679413530"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-101"></span><span>  </span><span id="local-6989586621679413529"><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679413529"><span class="hs-identifier hs-var">matches'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Match] -&gt; q [DMatch]
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; [Match] -&gt; q [DMatch]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsMatches"><span class="hs-identifier hs-var">dsMatches</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413531"><span class="hs-identifier hs-var">scrutinee</span></a></span><span> </span><span class="annot"><span class="annottext">[Match]
</span><a href="#local-6989586621679413530"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413531"><span class="hs-identifier hs-var">scrutinee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679413529"><span class="hs-identifier hs-var">matches'</span></a></span><span>
</span><span id="line-103"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CaseE</span></span><span> </span><span id="local-6989586621679413528"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413528"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679413527"><span class="annot"><span class="annottext">matches :: [Match]
</span><a href="#local-6989586621679413527"><span class="hs-identifier hs-var">matches</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-104"></span><span>  </span><span id="local-6989586621679413526"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413526"><span class="hs-identifier hs-var">scrutinee</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;scrutinee&quot;</span></span><span>
</span><span id="line-105"></span><span>  </span><span id="local-6989586621679413525"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413525"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413528"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span id="local-6989586621679413524"><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679413524"><span class="hs-identifier hs-var">matches'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Match] -&gt; q [DMatch]
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; [Match] -&gt; q [DMatch]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsMatches"><span class="hs-identifier hs-var">dsMatches</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413526"><span class="hs-identifier hs-var">scrutinee</span></a></span><span> </span><span class="annot"><span class="annottext">[Match]
</span><a href="#local-6989586621679413527"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetE"><span class="hs-identifier hs-var">DLetE</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DValD"><span class="hs-identifier hs-var">DValD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413526"><span class="hs-identifier hs-var">scrutinee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413525"><span class="hs-identifier hs-var">exp'</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; DExp -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-108"></span><span>           </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413526"><span class="hs-identifier hs-var">scrutinee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679413524"><span class="hs-identifier hs-var">matches'</span></a></span><span>
</span><span id="line-109"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DoE</span></span><span> </span><span id="local-6989586621679413520"><span class="annot"><span class="annottext">stmts :: [Stmt]
</span><a href="#local-6989586621679413520"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679413520"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-110"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CompE</span></span><span> </span><span id="local-6989586621679413517"><span class="annot"><span class="annottext">stmts :: [Stmt]
</span><a href="#local-6989586621679413517"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679413517"><span class="hs-identifier hs-var">stmts</span></a></span><span>
</span><span id="line-111"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArithSeqE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromR</span></span><span> </span><span id="local-6989586621679413513"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413513"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">enumFrom</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413513"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-112"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArithSeqE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromThenR</span></span><span> </span><span id="local-6989586621679413511"><span class="annot"><span class="annottext">exp1 :: Exp
</span><a href="#local-6989586621679413511"><span class="hs-identifier hs-var">exp1</span></a></span></span><span> </span><span id="local-6989586621679413510"><span class="annot"><span class="annottext">exp2 :: Exp
</span><a href="#local-6989586621679413510"><span class="hs-identifier hs-var">exp2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; q DExp -&gt; q (DExp -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">enumFromThen</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413511"><span class="hs-identifier hs-var">exp1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">q (DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413510"><span class="hs-identifier hs-var">exp2</span></a></span><span>
</span><span id="line-114"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArithSeqE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromToR</span></span><span> </span><span id="local-6989586621679413508"><span class="annot"><span class="annottext">exp1 :: Exp
</span><a href="#local-6989586621679413508"><span class="hs-identifier hs-var">exp1</span></a></span></span><span> </span><span id="local-6989586621679413507"><span class="annot"><span class="annottext">exp2 :: Exp
</span><a href="#local-6989586621679413507"><span class="hs-identifier hs-var">exp2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; q DExp -&gt; q (DExp -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">enumFromTo</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413508"><span class="hs-identifier hs-var">exp1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">q (DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413507"><span class="hs-identifier hs-var">exp2</span></a></span><span>
</span><span id="line-116"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArithSeqE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromThenToR</span></span><span> </span><span id="local-6989586621679413505"><span class="annot"><span class="annottext">e1 :: Exp
</span><a href="#local-6989586621679413505"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679413504"><span class="annot"><span class="annottext">e2 :: Exp
</span><a href="#local-6989586621679413504"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621679413503"><span class="annot"><span class="annottext">e3 :: Exp
</span><a href="#local-6989586621679413503"><span class="hs-identifier hs-var">e3</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; q DExp -&gt; q (DExp -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; q DExp -&gt; q (DExp -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">enumFromThenTo</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413505"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">q (DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span>
</span><span id="line-118"></span><span>                               </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413504"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">q (DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span>
</span><span id="line-119"></span><span>            </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413503"><span class="hs-identifier hs-var">e3</span></a></span><span>
</span><span id="line-120"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ListE</span></span><span> </span><span id="local-6989586621679413501"><span class="annot"><span class="annottext">exps :: [Exp]
</span><a href="#local-6989586621679413501"><span class="hs-identifier hs-var">exps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Exp] -&gt; q DExp
forall (m :: * -&gt; *). DsMonad m =&gt; [Exp] -&gt; m DExp
</span><a href="#local-6989586621679413500"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679413501"><span class="hs-identifier hs-var">exps</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679413500"><span class="annot"><span class="annottext">go :: [Exp] -&gt; m DExp
</span><a href="#local-6989586621679413500"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; m DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; m DExp) -&gt; DExp -&gt; m DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><a href="#local-6989586621679413500"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679413499"><span class="annot"><span class="annottext">h :: Exp
</span><a href="#local-6989586621679413499"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679413498"><span class="annot"><span class="annottext">t :: [Exp]
</span><a href="#local-6989586621679413498"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; m DExp -&gt; m (DExp -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; m DExp -&gt; m DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; m DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413499"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m (DExp -&gt; DExp) -&gt; m DExp -&gt; m DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Exp] -&gt; m DExp
</span><a href="#local-6989586621679413500"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679413498"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-123"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigE</span></span><span> </span><span id="local-6989586621679413496"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413496"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679413495"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679413495"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DType -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigE"><span class="hs-identifier hs-var">DSigE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DType -&gt; DExp) -&gt; q DExp -&gt; q (DType -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413496"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DExp) -&gt; q DType -&gt; q DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679413495"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-124"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecConE</span></span><span> </span><span id="local-6989586621679413491"><span class="annot"><span class="annottext">con_name :: Name
</span><a href="#local-6989586621679413491"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679413490"><span class="annot"><span class="annottext">field_exps :: [FieldExp]
</span><a href="#local-6989586621679413490"><span class="hs-identifier hs-var">field_exps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621679413489"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679413489"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Con
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q Con
</span><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToCon"><span class="hs-identifier hs-var">dataConNameToCon</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413491"><span class="hs-identifier hs-var">con_name</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621679413487"><span class="annot"><span class="annottext">[DExp]
</span><a href="#local-6989586621679413487"><span class="hs-identifier hs-var">reordered</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Con -&gt; q [DExp]
forall (m :: * -&gt; *). DsMonad m =&gt; Con -&gt; m [DExp]
</span><a href="#local-6989586621679413486"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679413489"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; DExp -&gt; [DExp] -&gt; DExp
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413491"><span class="hs-identifier hs-var">con_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DExp]
</span><a href="#local-6989586621679413487"><span class="hs-identifier hs-var">reordered</span></a></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>    </span><span id="local-6989586621679413486"><span class="annot"><span class="annottext">reorder :: Con -&gt; m [DExp]
</span><a href="#local-6989586621679413486"><span class="hs-identifier hs-var hs-var">reorder</span></a></span></span><span> </span><span id="local-6989586621679413485"><span class="annot"><span class="annottext">con :: Con
</span><a href="#local-6989586621679413485"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679413485"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-130"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">NormalC</span></span><span> </span><span id="local-6989586621679413483"><span class="annot"><span class="annottext">_name :: Name
</span><a href="#local-6989586621679413483"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679413482"><span class="annot"><span class="annottext">fields :: [BangType]
</span><a href="#local-6989586621679413482"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BangType] -&gt; m [DExp]
forall (m :: * -&gt; *) (t :: * -&gt; *) a.
(Foldable t, MonadFail m) =&gt;
t a -&gt; m [DExp]
</span><a href="#local-6989586621679413481"><span class="hs-identifier hs-var">non_record</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679413482"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-131"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">InfixC</span></span><span> </span><span id="local-6989586621679413479"><span class="annot"><span class="annottext">field1 :: BangType
</span><a href="#local-6989586621679413479"><span class="hs-identifier hs-var">field1</span></a></span></span><span> </span><span id="local-6989586621679413478"><span class="annot"><span class="annottext">_name :: Name
</span><a href="#local-6989586621679413478"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679413477"><span class="annot"><span class="annottext">field2 :: BangType
</span><a href="#local-6989586621679413477"><span class="hs-identifier hs-var">field2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BangType] -&gt; m [DExp]
forall (m :: * -&gt; *) (t :: * -&gt; *) a.
(Foldable t, MonadFail m) =&gt;
t a -&gt; m [DExp]
</span><a href="#local-6989586621679413481"><span class="hs-identifier hs-var">non_record</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679413479"><span class="hs-identifier hs-var">field1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679413477"><span class="hs-identifier hs-var">field2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-132"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">RecC</span></span><span> </span><span id="local-6989586621679413475"><span class="annot"><span class="annottext">_name :: Name
</span><a href="#local-6989586621679413475"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679413474"><span class="annot"><span class="annottext">fields :: [VarBangType]
</span><a href="#local-6989586621679413474"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[VarBangType] -&gt; m [DExp]
forall (q :: * -&gt; *). DsMonad q =&gt; [VarBangType] -&gt; q [DExp]
</span><a href="#local-6989586621679413473"><span class="hs-identifier hs-var">reorder_fields</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679413474"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-133"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">ForallC</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679413471"><span class="annot"><span class="annottext">c :: Con
</span><a href="#local-6989586621679413471"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Con -&gt; m [DExp]
</span><a href="#local-6989586621679413486"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679413471"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">GadtC</span></span><span> </span><span id="local-6989586621679413469"><span class="annot"><span class="annottext">_names :: [Name]
</span><a href="#local-6989586621679413469"><span class="hs-identifier hs-var">_names</span></a></span></span><span> </span><span id="local-6989586621679413468"><span class="annot"><span class="annottext">fields :: [BangType]
</span><a href="#local-6989586621679413468"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679413467"><span class="annot"><span class="annottext">_ret_ty :: Type
</span><a href="#local-6989586621679413467"><span class="hs-identifier hs-var">_ret_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BangType] -&gt; m [DExp]
forall (m :: * -&gt; *) (t :: * -&gt; *) a.
(Foldable t, MonadFail m) =&gt;
t a -&gt; m [DExp]
</span><a href="#local-6989586621679413481"><span class="hs-identifier hs-var">non_record</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679413468"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-136"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">RecGadtC</span></span><span> </span><span id="local-6989586621679413465"><span class="annot"><span class="annottext">_names :: [Name]
</span><a href="#local-6989586621679413465"><span class="hs-identifier hs-var">_names</span></a></span></span><span> </span><span id="local-6989586621679413464"><span class="annot"><span class="annottext">fields :: [VarBangType]
</span><a href="#local-6989586621679413464"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679413463"><span class="annot"><span class="annottext">_ret_ty :: Type
</span><a href="#local-6989586621679413463"><span class="hs-identifier hs-var">_ret_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[VarBangType] -&gt; m [DExp]
forall (q :: * -&gt; *). DsMonad q =&gt; [VarBangType] -&gt; q [DExp]
</span><a href="#local-6989586621679413473"><span class="hs-identifier hs-var">reorder_fields</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679413464"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621679413473"><span class="annot"><span class="annottext">reorder_fields :: [VarBangType] -&gt; q [DExp]
</span><a href="#local-6989586621679413473"><span class="hs-identifier hs-var hs-var">reorder_fields</span></a></span></span><span> </span><span id="local-6989586621679413462"><span class="annot"><span class="annottext">fields :: [VarBangType]
</span><a href="#local-6989586621679413462"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [VarBangType] -&gt; [FieldExp] -&gt; [DExp] -&gt; q [DExp]
forall (q :: * -&gt; *).
DsMonad q =&gt;
Name -&gt; [VarBangType] -&gt; [FieldExp] -&gt; [DExp] -&gt; q [DExp]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields"><span class="hs-identifier hs-var">reorderFields</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413491"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679413462"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldExp]
</span><a href="#local-6989586621679413490"><span class="hs-identifier hs-var">field_exps</span></a></span><span>
</span><span id="line-140"></span><span>                                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; [DExp]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; [DExp]) -&gt; DExp -&gt; [DExp]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">undefined</span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span>    </span><span id="local-6989586621679413481"><span class="annot"><span class="annottext">non_record :: t a -&gt; m [DExp]
</span><a href="#local-6989586621679413481"><span class="hs-identifier hs-var hs-var">non_record</span></a></span></span><span> </span><span id="local-6989586621679413459"><span class="annot"><span class="annottext">fields :: t a
</span><a href="#local-6989586621679413459"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[FieldExp] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[FieldExp]
</span><a href="#local-6989586621679413490"><span class="hs-identifier hs-var">field_exps</span></a></span><span>
</span><span id="line-143"></span><span>                        </span><span class="hs-comment">-- Special case: record construction is allowed for any</span><span>
</span><span id="line-144"></span><span>                        </span><span class="hs-comment">-- constructor, regardless of whether the constructor</span><span>
</span><span id="line-145"></span><span>                        </span><span class="hs-comment">-- actually was declared with records, provided that no</span><span>
</span><span id="line-146"></span><span>                        </span><span class="hs-comment">-- records are given in the expression itself. (See #59).</span><span>
</span><span id="line-147"></span><span>                        </span><span class="hs-comment">--</span><span>
</span><span id="line-148"></span><span>                        </span><span class="hs-comment">-- Con{} desugars down to Con undefined ... undefined.</span><span>
</span><span id="line-149"></span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DExp] -&gt; m [DExp]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([DExp] -&gt; m [DExp]) -&gt; [DExp] -&gt; m [DExp]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; DExp -&gt; [DExp]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679413459"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; [DExp]) -&gt; DExp -&gt; [DExp]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">undefined</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-152"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; m [DExp]
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m [DExp]) -&gt; String -&gt; m [DExp]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Record syntax used with non-record constructor &quot;</span></span><span>
</span><span id="line-153"></span><span>                                       </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413491"><span class="hs-identifier hs-var">con_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecUpdE</span></span><span> </span><span id="local-6989586621679413452"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413452"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679413451"><span class="annot"><span class="annottext">field_exps :: [FieldExp]
</span><a href="#local-6989586621679413451"><span class="hs-identifier hs-var">field_exps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-comment">-- here, we need to use one of the field names to find the tycon, somewhat dodgily</span><span>
</span><span id="line-157"></span><span>  </span><span id="local-6989586621679413450"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413450"><span class="hs-identifier hs-var">first_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[FieldExp]
</span><a href="#local-6989586621679413451"><span class="hs-identifier hs-var">field_exps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-158"></span><span>                  </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679413449"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679413449"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Name
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413449"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-159"></span><span>                  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Record update with no fields listed.&quot;</span></span><span>
</span><span id="line-160"></span><span>  </span><span id="local-6989586621679413448"><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679413448"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Info
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q Info
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals"><span class="hs-identifier hs-var">reifyWithLocals</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413450"><span class="hs-identifier hs-var">first_name</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621679413446"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679413446"><span class="hs-identifier hs-var">applied_type</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Info
</span><a href="#local-6989586621679413448"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-keyword">of</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">VarI</span></span><span> </span><span id="local-6989586621679413444"><span class="annot"><span class="annottext">_name :: Name
</span><a href="#local-6989586621679413444"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679413443"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679413443"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679413442"><span class="annot"><span class="annottext">_m_dec :: Maybe Dec
</span><a href="#local-6989586621679413442"><span class="hs-identifier hs-var">_m_dec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q Type
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q Type
</span><a href="#local-6989586621679413441"><span class="hs-identifier hs-var">extract_first_arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679413443"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#else
</span><span>                    </span><span class="hs-identifier">VarI</span><span> </span><span class="hs-identifier">_name</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">_m_dec</span><span> </span><span class="hs-identifier">_fixity</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">extract_first_arg</span><span> </span><span class="hs-identifier">ty</span><span class="hs-cpp">
#endif
</span><span>                    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Type
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Record update with an invalid field name.&quot;</span></span><span>
</span><span id="line-168"></span><span>  </span><span id="local-6989586621679413440"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413440"><span class="hs-identifier hs-var">type_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q Name
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q Name
</span><a href="#local-6989586621679413439"><span class="hs-identifier hs-var">extract_type_name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679413446"><span class="hs-identifier hs-var">applied_type</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679413438"><span class="annot"><span class="annottext">cons :: [Con]
</span><a href="#local-6989586621679413438"><span class="hs-identifier hs-var">cons</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; q ([TyVarBndr], [Con])
forall (q :: * -&gt; *).
DsMonad q =&gt;
String -&gt; Name -&gt; q ([TyVarBndr], [Con])
</span><a href="Language.Haskell.TH.Desugar.Reify.html#getDataD"><span class="hs-identifier hs-var">getDataD</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;This seems to be an error in GHC.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413440"><span class="hs-identifier hs-var">type_name</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679413436"><span class="annot"><span class="annottext">filtered_cons :: [Con]
</span><a href="#local-6989586621679413436"><span class="hs-identifier hs-var hs-var">filtered_cons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Con] -&gt; [Name] -&gt; [Con]
forall (t :: * -&gt; *). Foldable t =&gt; [Con] -&gt; t Name -&gt; [Con]
</span><a href="#local-6989586621679413435"><span class="hs-identifier hs-var">filter_cons_with_names</span></a></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679413438"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FieldExp -&gt; Name) -&gt; [FieldExp] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">FieldExp -&gt; Name
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[FieldExp]
</span><a href="#local-6989586621679413451"><span class="hs-identifier hs-var">field_exps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>  </span><span id="local-6989586621679413434"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413434"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413452"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span id="local-6989586621679413433"><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679413433"><span class="hs-identifier hs-var">matches</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Con -&gt; q DMatch) -&gt; [Con] -&gt; q [DMatch]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Con -&gt; q DMatch
forall (q :: * -&gt; *). DsMonad q =&gt; Con -&gt; q DMatch
</span><a href="#local-6989586621679413432"><span class="hs-identifier hs-var">con_to_dmatch</span></a></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679413436"><span class="hs-identifier hs-var">filtered_cons</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679413431"><span class="annot"><span class="annottext">all_matches :: [DMatch]
</span><a href="#local-6989586621679413431"><span class="hs-identifier hs-var hs-var">all_matches</span></a></span></span><span>
</span><span id="line-174"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Con] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679413436"><span class="hs-identifier hs-var">filtered_cons</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Con] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679413438"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679413433"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-175"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679413433"><span class="hs-identifier hs-var">matches</span></a></span><span> </span><span class="annot"><span class="annottext">[DMatch] -&gt; [DMatch] -&gt; [DMatch]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DMatch
</span><a href="#local-6989586621679413430"><span class="hs-identifier hs-var">error_match</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-176"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413434"><span class="hs-identifier hs-var">exp'</span></a></span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679413431"><span class="hs-identifier hs-var">all_matches</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621679413972"><span class="annot"><a href="#local-6989586621679413441"><span class="hs-identifier hs-type">extract_first_arg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413972"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413972"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span></span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679413441"><span class="annot"><span class="annottext">extract_first_arg :: Type -&gt; q Type
</span><a href="#local-6989586621679413441"><span class="hs-identifier hs-var hs-var">extract_first_arg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ArrowT</span></span><span> </span><span id="local-6989586621679413427"><span class="annot"><span class="annottext">arg :: Type
</span><a href="#local-6989586621679413427"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q Type
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679413427"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><a href="#local-6989586621679413441"><span class="hs-identifier hs-var">extract_first_arg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679413425"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679413425"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q Type
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q Type
</span><a href="#local-6989586621679413441"><span class="hs-identifier hs-var">extract_first_arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679413425"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><a href="#local-6989586621679413441"><span class="hs-identifier hs-var">extract_first_arg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679413423"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679413423"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q Type
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q Type
</span><a href="#local-6989586621679413441"><span class="hs-identifier hs-var">extract_first_arg</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679413423"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><a href="#local-6989586621679413441"><span class="hs-identifier hs-var">extract_first_arg</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Type
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Record selector not a function.&quot;</span></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621679413971"><span class="annot"><a href="#local-6989586621679413439"><span class="hs-identifier hs-type">extract_type_name</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413971"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413971"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span></span><span>
</span><span id="line-185"></span><span>    </span><span id="local-6989586621679413439"><span class="annot"><span class="annottext">extract_type_name :: Type -&gt; q Name
</span><a href="#local-6989586621679413439"><span class="hs-identifier hs-var hs-var">extract_type_name</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span id="local-6989586621679413422"><span class="annot"><span class="annottext">t1 :: Type
</span><a href="#local-6989586621679413422"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q Name
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q Name
</span><a href="#local-6989586621679413439"><span class="hs-identifier hs-var">extract_type_name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679413422"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><a href="#local-6989586621679413439"><span class="hs-identifier hs-var">extract_type_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679413421"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679413421"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q Name
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q Name
</span><a href="#local-6989586621679413439"><span class="hs-identifier hs-var">extract_type_name</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679413421"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><a href="#local-6989586621679413439"><span class="hs-identifier hs-var">extract_type_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679413419"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679413419"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Name
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413419"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><a href="#local-6989586621679413439"><span class="hs-identifier hs-var">extract_type_name</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Record selector domain not a datatype.&quot;</span></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621679413435"><span class="annot"><span class="annottext">filter_cons_with_names :: [Con] -&gt; t Name -&gt; [Con]
</span><a href="#local-6989586621679413435"><span class="hs-identifier hs-var hs-var">filter_cons_with_names</span></a></span></span><span> </span><span id="local-6989586621679413418"><span class="annot"><span class="annottext">cons :: [Con]
</span><a href="#local-6989586621679413418"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679413417"><span class="annot"><span class="annottext">field_names :: t Name
</span><a href="#local-6989586621679413417"><span class="hs-identifier hs-var">field_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-191"></span><span>      </span><span class="annot"><span class="annottext">(Con -&gt; Bool) -&gt; [Con] -&gt; [Con]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Con -&gt; Bool
</span><a href="#local-6989586621679413416"><span class="hs-identifier hs-var">has_names</span></a></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679413418"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-192"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>        </span><span id="local-6989586621679413415"><span class="annot"><span class="annottext">args_contain_names :: [(Name, b, c)] -&gt; Bool
</span><a href="#local-6989586621679413415"><span class="hs-identifier hs-var hs-var">args_contain_names</span></a></span></span><span> </span><span id="local-6989586621679413414"><span class="annot"><span class="annottext">args :: [(Name, b, c)]
</span><a href="#local-6989586621679413414"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-194"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679413413"><span class="annot"><span class="annottext">con_field_names :: [Name]
</span><a href="#local-6989586621679413413"><span class="hs-identifier hs-var hs-var">con_field_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Name, b, c) -&gt; Name) -&gt; [(Name, b, c)] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Name, b, c) -&gt; Name
forall a b c. (a, b, c) -&gt; a
</span><a href="#local-6989586621679413412"><span class="hs-identifier hs-var">fst_of_3</span></a></span><span> </span><span class="annot"><span class="annottext">[(Name, b, c)]
</span><a href="#local-6989586621679413414"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-195"></span><span>          </span><span class="annot"><span class="annottext">(Name -&gt; Bool) -&gt; t Name -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679413413"><span class="hs-identifier hs-var">con_field_names</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t Name
</span><a href="#local-6989586621679413417"><span class="hs-identifier hs-var">field_names</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>        </span><span id="local-6989586621679413416"><span class="annot"><span class="annottext">has_names :: Con -&gt; Bool
</span><a href="#local-6989586621679413416"><span class="hs-identifier hs-var hs-var">has_names</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecC</span></span><span> </span><span id="local-6989586621679413411"><span class="annot"><span class="annottext">_con_name :: Name
</span><a href="#local-6989586621679413411"><span class="hs-identifier hs-var">_con_name</span></a></span></span><span> </span><span id="local-6989586621679413410"><span class="annot"><span class="annottext">args :: [VarBangType]
</span><a href="#local-6989586621679413410"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-198"></span><span>          </span><span class="annot"><span class="annottext">[VarBangType] -&gt; Bool
forall b c. [(Name, b, c)] -&gt; Bool
</span><a href="#local-6989586621679413415"><span class="hs-identifier hs-var">args_contain_names</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679413410"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>        </span><span class="annot"><a href="#local-6989586621679413416"><span class="hs-identifier hs-var">has_names</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecGadtC</span></span><span> </span><span id="local-6989586621679413409"><span class="annot"><span class="annottext">_con_name :: [Name]
</span><a href="#local-6989586621679413409"><span class="hs-identifier hs-var">_con_name</span></a></span></span><span> </span><span id="local-6989586621679413408"><span class="annot"><span class="annottext">args :: [VarBangType]
</span><a href="#local-6989586621679413408"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679413407"><span class="annot"><span class="annottext">_ret_ty :: Type
</span><a href="#local-6989586621679413407"><span class="hs-identifier hs-var">_ret_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-201"></span><span>          </span><span class="annot"><span class="annottext">[VarBangType] -&gt; Bool
forall b c. [(Name, b, c)] -&gt; Bool
</span><a href="#local-6989586621679413415"><span class="hs-identifier hs-var">args_contain_names</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679413408"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-cpp">
#endif
</span><span>        </span><span class="annot"><a href="#local-6989586621679413416"><span class="hs-identifier hs-var">has_names</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallC</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679413406"><span class="annot"><span class="annottext">c :: Con
</span><a href="#local-6989586621679413406"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Con -&gt; Bool
</span><a href="#local-6989586621679413416"><span class="hs-identifier hs-var">has_names</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679413406"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-204"></span><span>        </span><span class="annot"><a href="#local-6989586621679413416"><span class="hs-identifier hs-var">has_names</span></a></span><span> </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span>    </span><span id="local-6989586621679413405"><span class="annot"><span class="annottext">rec_con_to_dmatch :: Name -&gt; [VarBangType] -&gt; m DMatch
</span><a href="#local-6989586621679413405"><span class="hs-identifier hs-var hs-var">rec_con_to_dmatch</span></a></span></span><span> </span><span id="local-6989586621679413404"><span class="annot"><span class="annottext">con_name :: Name
</span><a href="#local-6989586621679413404"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679413403"><span class="annot"><span class="annottext">args :: [VarBangType]
</span><a href="#local-6989586621679413403"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-207"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679413402"><span class="annot"><span class="annottext">con_field_names :: [Name]
</span><a href="#local-6989586621679413402"><span class="hs-identifier hs-var hs-var">con_field_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarBangType -&gt; Name) -&gt; [VarBangType] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">VarBangType -&gt; Name
forall a b c. (a, b, c) -&gt; a
</span><a href="#local-6989586621679413412"><span class="hs-identifier hs-var">fst_of_3</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679413403"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-208"></span><span>      </span><span id="local-6989586621679413401"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679413401"><span class="hs-identifier hs-var">field_var_names</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; m Name) -&gt; [Name] -&gt; m [Name]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; m Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m Name) -&gt; (Name -&gt; String) -&gt; Name -&gt; m Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679413402"><span class="hs-identifier hs-var">con_field_names</span></a></span><span>
</span><span id="line-209"></span><span>      </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413404"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; DPat) -&gt; [Name] -&gt; [DPat]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679413401"><span class="hs-identifier hs-var">field_var_names</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DMatch) -&gt; m DExp -&gt; m DMatch
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-210"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; DExp -&gt; [DExp] -&gt; DExp
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413404"><span class="hs-identifier hs-var">con_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([DExp] -&gt; DExp) -&gt; m [DExp] -&gt; m DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-211"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [VarBangType] -&gt; [FieldExp] -&gt; [DExp] -&gt; m [DExp]
forall (q :: * -&gt; *).
DsMonad q =&gt;
Name -&gt; [VarBangType] -&gt; [FieldExp] -&gt; [DExp] -&gt; q [DExp]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields"><span class="hs-identifier hs-var">reorderFields</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413404"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679413403"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldExp]
</span><a href="#local-6989586621679413451"><span class="hs-identifier hs-var">field_exps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; DExp) -&gt; [Name] -&gt; [DExp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679413401"><span class="hs-identifier hs-var">field_var_names</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679413959"><span class="annot"><a href="#local-6989586621679413432"><span class="hs-identifier hs-type">con_to_dmatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413959"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413959"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span></span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621679413432"><span class="annot"><span class="annottext">con_to_dmatch :: Con -&gt; q DMatch
</span><a href="#local-6989586621679413432"><span class="hs-identifier hs-var hs-var">con_to_dmatch</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecC</span></span><span> </span><span id="local-6989586621679413396"><span class="annot"><span class="annottext">con_name :: Name
</span><a href="#local-6989586621679413396"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679413395"><span class="annot"><span class="annottext">args :: [VarBangType]
</span><a href="#local-6989586621679413395"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [VarBangType] -&gt; q DMatch
forall (m :: * -&gt; *).
DsMonad m =&gt;
Name -&gt; [VarBangType] -&gt; m DMatch
</span><a href="#local-6989586621679413405"><span class="hs-identifier hs-var">rec_con_to_dmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413396"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679413395"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>    </span><span class="hs-comment">-- We're assuming the GADT constructor has only one Name here, but since</span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-comment">-- this constructor was reified, this assumption should always hold true.</span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><a href="#local-6989586621679413432"><span class="hs-identifier hs-var">con_to_dmatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecGadtC</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679413394"><span class="annot"><span class="annottext">con_name :: Name
</span><a href="#local-6989586621679413394"><span class="hs-identifier hs-var">con_name</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679413393"><span class="annot"><span class="annottext">args :: [VarBangType]
</span><a href="#local-6989586621679413393"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679413392"><span class="annot"><span class="annottext">_ret_ty :: Type
</span><a href="#local-6989586621679413392"><span class="hs-identifier hs-var">_ret_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [VarBangType] -&gt; q DMatch
forall (m :: * -&gt; *).
DsMonad m =&gt;
Name -&gt; [VarBangType] -&gt; m DMatch
</span><a href="#local-6989586621679413405"><span class="hs-identifier hs-var">rec_con_to_dmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413394"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679413393"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-cpp">
#endif
</span><span>    </span><span class="annot"><a href="#local-6989586621679413432"><span class="hs-identifier hs-var">con_to_dmatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallC</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679413391"><span class="annot"><span class="annottext">c :: Con
</span><a href="#local-6989586621679413391"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Con -&gt; q DMatch
forall (q :: * -&gt; *). DsMonad q =&gt; Con -&gt; q DMatch
</span><a href="#local-6989586621679413432"><span class="hs-identifier hs-var">con_to_dmatch</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679413391"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><a href="#local-6989586621679413432"><span class="hs-identifier hs-var">con_to_dmatch</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DMatch
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Internal error within th-desugar.&quot;</span></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span>    </span><span id="local-6989586621679413430"><span class="annot"><span class="annottext">error_match :: DMatch
</span><a href="#local-6989586621679413430"><span class="hs-identifier hs-var hs-var">error_match</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">error</span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Lit
</span><span class="hs-identifier hs-var">StringL</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Non-exhaustive patterns in record update&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span>    </span><span id="local-6989586621679413412"><span class="annot"><span class="annottext">fst_of_3 :: (a, b, c) -&gt; a
</span><a href="#local-6989586621679413412"><span class="hs-identifier hs-var hs-var">fst_of_3</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679413389"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679413389"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679413389"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 709
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StaticE</span></span><span> </span><span id="local-6989586621679413387"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413387"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DStaticE"><span class="hs-identifier hs-var">DStaticE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413387"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboundVarE</span></span><span> </span><span id="local-6989586621679413384"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679413384"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413384"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppTypeE</span></span><span> </span><span id="local-6989586621679413382"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413382"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679413381"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679413381"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DType -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppTypeE"><span class="hs-identifier hs-var">DAppTypeE</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DType -&gt; DExp) -&gt; q DExp -&gt; q (DType -&gt; DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413382"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DExp) -&gt; q DType -&gt; q DExp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679413381"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-235"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedSumE</span></span><span> </span><span id="local-6989586621679413378"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413378"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621679413377"><span class="annot"><span class="annottext">alt :: Int
</span><a href="#local-6989586621679413377"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621679413376"><span class="annot"><span class="annottext">arity :: Int
</span><a href="#local-6989586621679413376"><span class="hs-identifier hs-var">arity</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; DExp) -&gt; Name -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Name
</span><span class="hs-identifier hs-var">unboxedSumDataName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679413377"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679413376"><span class="hs-identifier hs-var">arity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413378"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 803
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LabelE</span></span><span> </span><span id="local-6989586621679413373"><span class="annot"><span class="annottext">str :: String
</span><a href="#local-6989586621679413373"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">fromLabel</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DType -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppTypeE"><span class="hs-operator hs-var">`DAppTypeE`</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-var">DLitT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TyLit
</span><span class="hs-identifier hs-var">StrTyLit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679413373"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImplicitParamVarE</span></span><span> </span><span id="local-6989586621679413369"><span class="annot"><span class="annottext">n :: String
</span><a href="#local-6989586621679413369"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">ip</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DType -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppTypeE"><span class="hs-operator hs-var">`DAppTypeE`</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-var">DLitT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TyLit
</span><span class="hs-identifier hs-var">StrTyLit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679413369"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MDoE</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DExp
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;th-desugar currently does not support RecursiveDo&quot;</span></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 809
</span><span class="hs-identifier">dsTup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Name</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">Exp</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DExp</span><span>
</span><span id="line-248"></span><span class="hs-identifier">dsTup</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ds_tup</span><span class="hs-cpp">
#else
</span><span id="local-6989586621679414005"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTup"><span class="hs-identifier hs-type">dsTup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679414005"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679414005"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-251"></span><span id="dsTup"><span class="annot"><span class="annottext">dsTup :: (Int -&gt; Name) -&gt; [Exp] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTup"><span class="hs-identifier hs-var hs-var">dsTup</span></a></span></span><span> </span><span id="local-6989586621679413367"><span class="annot"><span class="annottext">tuple_data_name :: Int -&gt; Name
</span><a href="#local-6989586621679413367"><span class="hs-identifier hs-var">tuple_data_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Name) -&gt; [Maybe Exp] -&gt; q DExp
forall (q :: * -&gt; *).
DsMonad q =&gt;
(Int -&gt; Name) -&gt; [Maybe Exp] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#ds_tup"><span class="hs-identifier hs-var">ds_tup</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
</span><a href="#local-6989586621679413367"><span class="hs-identifier hs-var">tuple_data_name</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe Exp] -&gt; q DExp)
-&gt; ([Exp] -&gt; [Maybe Exp]) -&gt; [Exp] -&gt; q DExp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Maybe Exp) -&gt; [Exp] -&gt; [Maybe Exp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Maybe Exp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- | Desugar a tuple (or tuple section) expression.</span><span>
</span><span id="line-255"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#ds_tup"><span class="hs-identifier hs-type">ds_tup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679413939"><span class="annot"><a href="#local-6989586621679413939"><span class="hs-identifier hs-type">q</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413939"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-256"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Compute the 'Name' of a tuple (boxed or unboxed)</span><span>
</span><span id="line-257"></span><span>                        </span><span class="hs-comment">--   data constructor from its arity.</span><span>
</span><span id="line-258"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- ^ The tuple's subexpressions. 'Nothing' entries</span><span>
</span><span id="line-259"></span><span>                        </span><span class="hs-comment">--   denote empty fields in a tuple section.</span><span>
</span><span id="line-260"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413939"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-261"></span><span id="ds_tup"><span class="annot"><span class="annottext">ds_tup :: (Int -&gt; Name) -&gt; [Maybe Exp] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#ds_tup"><span class="hs-identifier hs-var hs-var">ds_tup</span></a></span></span><span> </span><span id="local-6989586621679413365"><span class="annot"><span class="annottext">tuple_data_name :: Int -&gt; Name
</span><a href="#local-6989586621679413365"><span class="hs-identifier hs-var">tuple_data_name</span></a></span></span><span> </span><span id="local-6989586621679413364"><span class="annot"><span class="annottext">mb_exps :: [Maybe Exp]
</span><a href="#local-6989586621679413364"><span class="hs-identifier hs-var">mb_exps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-262"></span><span>  </span><span id="local-6989586621679413363"><span class="annot"><span class="annottext">[Either Name DExp]
</span><a href="#local-6989586621679413363"><span class="hs-identifier hs-var">section_exps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Maybe Exp -&gt; q (Either Name DExp))
-&gt; [Maybe Exp] -&gt; q [Either Name DExp]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Maybe Exp -&gt; q (Either Name DExp)
</span><a href="#local-6989586621679413362"><span class="hs-identifier hs-var">ds_section_exp</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe Exp]
</span><a href="#local-6989586621679413364"><span class="hs-identifier hs-var">mb_exps</span></a></span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679413361"><span class="annot"><span class="annottext">section_vars :: [Name]
</span><a href="#local-6989586621679413361"><span class="hs-identifier hs-var hs-var">section_vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either Name DExp] -&gt; [Name]
forall a b. [Either a b] -&gt; [a]
</span><span class="hs-identifier hs-var">lefts</span></span><span> </span><span class="annot"><span class="annottext">[Either Name DExp]
</span><a href="#local-6989586621679413363"><span class="hs-identifier hs-var">section_exps</span></a></span><span>
</span><span id="line-264"></span><span>      </span><span id="local-6989586621679413360"><span class="annot"><span class="annottext">tup_body :: DExp
</span><a href="#local-6989586621679413360"><span class="hs-identifier hs-var hs-var">tup_body</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either Name DExp] -&gt; DExp
</span><a href="#local-6989586621679413359"><span class="hs-identifier hs-var">mk_tup_body</span></a></span><span> </span><span class="annot"><span class="annottext">[Either Name DExp]
</span><a href="#local-6989586621679413363"><span class="hs-identifier hs-var">section_exps</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679413361"><span class="hs-identifier hs-var">section_vars</span></a></span><span>
</span><span id="line-266"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413360"><span class="hs-identifier hs-var">tup_body</span></a></span><span> </span><span class="hs-comment">-- If this isn't a tuple section,</span><span>
</span><span id="line-267"></span><span>                          </span><span class="hs-comment">-- don't create a lambda.</span><span>
</span><span id="line-268"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Pat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLam"><span class="hs-identifier hs-var">dsLam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Pat) -&gt; [Name] -&gt; [Pat]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><span class="hs-identifier hs-var">VarP</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679413361"><span class="hs-identifier hs-var">section_vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413360"><span class="hs-identifier hs-var">tup_body</span></a></span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-comment">-- If dealing with an empty field in a tuple section (Nothing), create a</span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-comment">-- unique name and return Left. These names will be used to construct the</span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-comment">-- lambda expression that it desugars to.</span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-comment">-- (For example, `(,5)` desugars to `\ts -&gt; (,) ts 5`.)</span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-comment">-- If dealing with a tuple subexpression (Just), desugar it and return</span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-comment">-- Right.</span><span>
</span><span id="line-277"></span><span>    </span><span class="annot"><a href="#local-6989586621679413362"><span class="hs-identifier hs-type">ds_section_exp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413939"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>    </span><span id="local-6989586621679413362"><span class="annot"><span class="annottext">ds_section_exp :: Maybe Exp -&gt; q (Either Name DExp)
</span><a href="#local-6989586621679413362"><span class="hs-identifier hs-var hs-var">ds_section_exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">q (Either Name DExp)
-&gt; (Exp -&gt; q (Either Name DExp))
-&gt; Maybe Exp
-&gt; q (Either Name DExp)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Either Name DExp
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Either Name DExp) -&gt; q Name -&gt; q (Either Name DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><span class="hs-identifier hs-var">qNewName</span></span><span> </span><span class="annot"><span class="hs-string">&quot;ts&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DExp -&gt; Either Name DExp) -&gt; q DExp -&gt; q (Either Name DExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; Either Name DExp
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(q DExp -&gt; q (Either Name DExp))
-&gt; (Exp -&gt; q DExp) -&gt; Exp -&gt; q (Either Name DExp)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><a href="#local-6989586621679413359"><span class="hs-identifier hs-type">mk_tup_body</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-281"></span><span>    </span><span id="local-6989586621679413359"><span class="annot"><span class="annottext">mk_tup_body :: [Either Name DExp] -&gt; DExp
</span><a href="#local-6989586621679413359"><span class="hs-identifier hs-var hs-var">mk_tup_body</span></a></span></span><span> </span><span id="local-6989586621679413355"><span class="annot"><span class="annottext">section_exps :: [Either Name DExp]
</span><a href="#local-6989586621679413355"><span class="hs-identifier hs-var">section_exps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-282"></span><span>      </span><span class="annot"><span class="annottext">(DExp -&gt; Either Name DExp -&gt; DExp)
-&gt; DExp -&gt; [Either Name DExp] -&gt; DExp
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; Either Name DExp -&gt; DExp
</span><a href="#local-6989586621679413353"><span class="hs-identifier hs-var">apply_tup_body</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; DExp) -&gt; Name -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
</span><a href="#local-6989586621679413365"><span class="hs-identifier hs-var">tuple_data_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Either Name DExp] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Either Name DExp]
</span><a href="#local-6989586621679413355"><span class="hs-identifier hs-var">section_exps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>             </span><span class="annot"><span class="annottext">[Either Name DExp]
</span><a href="#local-6989586621679413355"><span class="hs-identifier hs-var">section_exps</span></a></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><a href="#local-6989586621679413353"><span class="hs-identifier hs-type">apply_tup_body</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-286"></span><span>    </span><span id="local-6989586621679413353"><span class="annot"><span class="annottext">apply_tup_body :: DExp -&gt; Either Name DExp -&gt; DExp
</span><a href="#local-6989586621679413353"><span class="hs-identifier hs-var hs-var">apply_tup_body</span></a></span></span><span> </span><span id="local-6989586621679413352"><span class="annot"><span class="annottext">f :: DExp
</span><a href="#local-6989586621679413352"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679413351"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679413351"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413352"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-operator hs-var">`DAppE`</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413351"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-287"></span><span>    </span><span class="annot"><a href="#local-6989586621679413353"><span class="hs-identifier hs-var">apply_tup_body</span></a></span><span> </span><span id="local-6989586621679413350"><span class="annot"><span class="annottext">f :: DExp
</span><a href="#local-6989586621679413350"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679413349"><span class="annot"><span class="annottext">e :: DExp
</span><a href="#local-6989586621679413349"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413350"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-operator hs-var">`DAppE`</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413349"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="hs-comment">-- | Desugar a lambda expression, where the body has already been desugared</span><span>
</span><span id="line-290"></span><span id="local-6989586621679414011"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLam"><span class="hs-identifier hs-type">dsLam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679414011"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679414011"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-291"></span><span id="dsLam"><span class="annot"><span class="annottext">dsLam :: [Pat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLam"><span class="hs-identifier hs-var hs-var">dsLam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Pat -&gt; Maybe Name)
-&gt; ([Pat] -&gt; DExp -&gt; q ([DPat], DExp)) -&gt; [Pat] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *) pat.
DsMonad q =&gt;
(pat -&gt; Maybe Name)
-&gt; ([pat] -&gt; DExp -&gt; q ([DPat], DExp)) -&gt; [pat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkLam"><span class="hs-identifier hs-var">mkLam</span></a></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Maybe Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#stripVarP_maybe"><span class="hs-identifier hs-var">stripVarP_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; DExp -&gt; q ([DPat], DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Pat] -&gt; DExp -&gt; q ([DPat], DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatsOverExp"><span class="hs-identifier hs-var">dsPatsOverExp</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-comment">-- | Convert a list of 'DPat' arguments and a 'DExp' body into a 'DLamE'. This</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- is needed since 'DLamE' takes a list of 'Name's for its bound variables</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- instead of 'DPat's, so some reorganization is needed.</span><span>
</span><span id="line-296"></span><span id="local-6989586621679413903"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkDLamEFromDPats"><span class="hs-identifier hs-type">mkDLamEFromDPats</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413903"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413903"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-297"></span><span id="mkDLamEFromDPats"><span class="annot"><span class="annottext">mkDLamEFromDPats :: [DPat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkDLamEFromDPats"><span class="hs-identifier hs-var hs-var">mkDLamEFromDPats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; Maybe Name)
-&gt; ([DPat] -&gt; DExp -&gt; q ([DPat], DExp)) -&gt; [DPat] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *) pat.
DsMonad q =&gt;
(pat -&gt; Maybe Name)
-&gt; ([pat] -&gt; DExp -&gt; q ([DPat], DExp)) -&gt; [pat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkLam"><span class="hs-identifier hs-var">mkLam</span></a></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; Maybe Name
</span><a href="#local-6989586621679413344"><span class="hs-identifier hs-var">stripDVarP_maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679413343"><span class="annot"><span class="annottext">pats :: [DPat]
</span><a href="#local-6989586621679413343"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span id="local-6989586621679413342"><span class="annot"><span class="annottext">exp :: DExp
</span><a href="#local-6989586621679413342"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([DPat], DExp) -&gt; q ([DPat], DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679413343"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413342"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-299"></span><span>    </span><span class="annot"><a href="#local-6989586621679413344"><span class="hs-identifier hs-type">stripDVarP_maybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-300"></span><span>    </span><span id="local-6989586621679413344"><span class="annot"><span class="annottext">stripDVarP_maybe :: DPat -&gt; Maybe Name
</span><a href="#local-6989586621679413344"><span class="hs-identifier hs-var hs-var">stripDVarP_maybe</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-type">DVarP</span></a></span><span> </span><span id="local-6989586621679413341"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679413341"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413341"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><a href="#local-6989586621679413344"><span class="hs-identifier hs-var">stripDVarP_maybe</span></a></span><span> </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-comment">-- | Generalizes 'dsLam' and 'mkDLamEFromDPats' to work over an arbitrary</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- pattern type.</span><span>
</span><span id="line-305"></span><span id="local-6989586621679413925"><span id="local-6989586621679413926"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkLam"><span class="hs-identifier hs-type">mkLam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413926"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-306"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679413925"><span class="hs-identifier hs-type">pat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Should return @'Just' n@ if the argument is a</span><span>
</span><span id="line-307"></span><span>                             </span><span class="hs-comment">--   variable pattern, and 'Nothing' otherwise.</span><span>
</span><span id="line-308"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679413925"><span class="hs-identifier hs-type">pat</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413926"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>                             </span><span class="hs-comment">-- ^ Should process a list of @pat@ arguments and</span><span>
</span><span id="line-310"></span><span>                             </span><span class="hs-comment">--   a 'DExp' body. (This might do some internal</span><span>
</span><span id="line-311"></span><span>                             </span><span class="hs-comment">--   reorganization if there are as-patterns, as</span><span>
</span><span id="line-312"></span><span>                             </span><span class="hs-comment">--   in the case of 'dsPatsOverExp'.)</span><span>
</span><span id="line-313"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679413925"><span class="hs-identifier hs-type">pat</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413926"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span></span><span>
</span><span id="line-314"></span><span id="mkLam"><span class="annot"><span class="annottext">mkLam :: (pat -&gt; Maybe Name)
-&gt; ([pat] -&gt; DExp -&gt; q ([DPat], DExp)) -&gt; [pat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkLam"><span class="hs-identifier hs-var hs-var">mkLam</span></a></span></span><span> </span><span id="local-6989586621679413340"><span class="annot"><span class="annottext">mb_strip_var_pat :: pat -&gt; Maybe Name
</span><a href="#local-6989586621679413340"><span class="hs-identifier hs-var">mb_strip_var_pat</span></a></span></span><span> </span><span id="local-6989586621679413339"><span class="annot"><span class="annottext">process_pats_over_exp :: [pat] -&gt; DExp -&gt; q ([DPat], DExp)
</span><a href="#local-6989586621679413339"><span class="hs-identifier hs-var">process_pats_over_exp</span></a></span></span><span> </span><span id="local-6989586621679413338"><span class="annot"><span class="annottext">pats :: [pat]
</span><a href="#local-6989586621679413338"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span id="local-6989586621679413337"><span class="annot"><span class="annottext">exp :: DExp
</span><a href="#local-6989586621679413337"><span class="hs-identifier hs-var">exp</span></a></span></span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679413336"><span class="annot"><span class="annottext">names :: [Name]
</span><a href="#local-6989586621679413336"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(pat -&gt; Maybe Name) -&gt; [pat] -&gt; Maybe [Name]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">pat -&gt; Maybe Name
</span><a href="#local-6989586621679413340"><span class="hs-identifier hs-var">mb_strip_var_pat</span></a></span><span> </span><span class="annot"><span class="annottext">[pat]
</span><a href="#local-6989586621679413338"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLamE"><span class="hs-identifier hs-var">DLamE</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679413336"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413337"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679413335"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679413335"><span class="hs-identifier hs-var">arg_names</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; q Name -&gt; q [Name]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[pat] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[pat]
</span><a href="#local-6989586621679413338"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;arg&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679413333"><span class="annot"><span class="annottext">scrutinee :: DExp
</span><a href="#local-6989586621679413333"><span class="hs-identifier hs-var hs-var">scrutinee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DExp] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDExp"><span class="hs-identifier hs-var">mkTupleDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; DExp) -&gt; [Name] -&gt; [DExp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679413335"><span class="hs-identifier hs-var">arg_names</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621679413331"><span class="annot"><span class="annottext">pats' :: [DPat]
</span><a href="#local-6989586621679413331"><span class="hs-identifier hs-var">pats'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679413330"><span class="annot"><span class="annottext">exp' :: DExp
</span><a href="#local-6989586621679413330"><span class="hs-identifier hs-var">exp'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[pat] -&gt; DExp -&gt; q ([DPat], DExp)
</span><a href="#local-6989586621679413339"><span class="hs-identifier hs-var">process_pats_over_exp</span></a></span><span> </span><span class="annot"><span class="annottext">[pat]
</span><a href="#local-6989586621679413338"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413337"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-321"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679413329"><span class="annot"><span class="annottext">match :: DMatch
</span><a href="#local-6989586621679413329"><span class="hs-identifier hs-var hs-var">match</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDPat"><span class="hs-identifier hs-var">mkTupleDPat</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679413331"><span class="hs-identifier hs-var">pats'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413330"><span class="hs-identifier hs-var">exp'</span></a></span><span>
</span><span id="line-322"></span><span>       </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLamE"><span class="hs-identifier hs-var">DLamE</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679413335"><span class="hs-identifier hs-var">arg_names</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413333"><span class="hs-identifier hs-var">scrutinee</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DMatch
</span><a href="#local-6989586621679413329"><span class="hs-identifier hs-var">match</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="hs-comment">-- | Desugar a list of matches for a @case@ statement</span><span>
</span><span id="line-325"></span><span id="local-6989586621679414006"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsMatches"><span class="hs-identifier hs-type">dsMatches</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679414006"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-326"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>     </span><span class="hs-comment">-- ^ Name of the scrutinee, which must be a bare var</span><span>
</span><span id="line-327"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ Matches of the @case@ statement</span><span>
</span><span id="line-328"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679414006"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-329"></span><span id="dsMatches"><span class="annot"><span class="annottext">dsMatches :: Name -&gt; [Match] -&gt; q [DMatch]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsMatches"><span class="hs-identifier hs-var hs-var">dsMatches</span></a></span></span><span> </span><span id="local-6989586621679413327"><span class="annot"><span class="annottext">scr :: Name
</span><a href="#local-6989586621679413327"><span class="hs-identifier hs-var">scr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; q [DMatch]
forall (q :: * -&gt; *). DsMonad q =&gt; [Match] -&gt; q [DMatch]
</span><a href="#local-6989586621679413326"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-331"></span><span>    </span><span id="local-6989586621679413917"><span class="annot"><a href="#local-6989586621679413326"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413917"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413917"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-332"></span><span>    </span><span id="local-6989586621679413326"><span class="annot"><span class="annottext">go :: [Match] -&gt; q [DMatch]
</span><a href="#local-6989586621679413326"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DMatch] -&gt; q [DMatch]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-333"></span><span>    </span><span class="annot"><a href="#local-6989586621679413326"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span> </span><span id="local-6989586621679413325"><span class="annot"><span class="annottext">pat :: Pat
</span><a href="#local-6989586621679413325"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679413324"><span class="annot"><span class="annottext">body :: Body
</span><a href="#local-6989586621679413324"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621679413323"><span class="annot"><span class="annottext">where_decs :: [Dec]
</span><a href="#local-6989586621679413323"><span class="hs-identifier hs-var">where_decs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679413322"><span class="annot"><span class="annottext">rest :: [Match]
</span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-334"></span><span>      </span><span id="local-6989586621679413321"><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679413321"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; q [DMatch]
forall (q :: * -&gt; *). DsMonad q =&gt; [Match] -&gt; q [DMatch]
</span><a href="#local-6989586621679413326"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Match]
</span><a href="#local-6989586621679413322"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-335"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679413320"><span class="annot"><span class="annottext">failure :: DExp
</span><a href="#local-6989586621679413320"><span class="hs-identifier hs-var hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413327"><span class="hs-identifier hs-var">scr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679413321"><span class="hs-identifier hs-var">rest'</span></a></span><span>  </span><span class="hs-comment">-- this might be an empty case.</span><span>
</span><span id="line-336"></span><span>      </span><span id="local-6989586621679413319"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413319"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Body -&gt; [Dec] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Body -&gt; [Dec] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBody"><span class="hs-identifier hs-var">dsBody</span></a></span><span> </span><span class="annot"><span class="annottext">Body
</span><a href="#local-6989586621679413324"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679413323"><span class="hs-identifier hs-var">where_decs</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413320"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-337"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679413317"><span class="annot"><span class="annottext">pat' :: DPat
</span><a href="#local-6989586621679413317"><span class="hs-identifier hs-var">pat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679413316"><span class="annot"><span class="annottext">exp'' :: DExp
</span><a href="#local-6989586621679413316"><span class="hs-identifier hs-var">exp''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; DExp -&gt; q (DPat, DExp)
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; DExp -&gt; q (DPat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatOverExp"><span class="hs-identifier hs-var">dsPatOverExp</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679413325"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413319"><span class="hs-identifier hs-var">exp'</span></a></span><span>
</span><span id="line-338"></span><span>      </span><span id="local-6989586621679413314"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679413314"><span class="hs-identifier hs-var">uni_pattern</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q Bool
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413317"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="hs-comment">-- incomplete attempt at #6</span><span>
</span><span id="line-339"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679413314"><span class="hs-identifier hs-var">uni_pattern</span></a></span><span>
</span><span id="line-340"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[DMatch] -&gt; q [DMatch]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413317"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413316"><span class="hs-identifier hs-var">exp''</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-341"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[DMatch] -&gt; q [DMatch]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413317"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413316"><span class="hs-identifier hs-var">exp''</span></a></span><span> </span><span class="annot"><span class="annottext">DMatch -&gt; [DMatch] -&gt; [DMatch]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679413321"><span class="hs-identifier hs-var">rest'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="hs-comment">-- | Desugar a @Body@</span><span>
</span><span id="line-344"></span><span id="local-6989586621679413915"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsBody"><span class="hs-identifier hs-type">dsBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413915"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-345"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Body</span></span><span>      </span><span class="hs-comment">-- ^ body to desugar</span><span>
</span><span id="line-346"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- ^ &quot;where&quot; declarations</span><span>
</span><span id="line-347"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>      </span><span class="hs-comment">-- ^ what to do if the guards don't match</span><span>
</span><span id="line-348"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413915"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-349"></span><span id="dsBody"><span class="annot"><span class="annottext">dsBody :: Body -&gt; [Dec] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBody"><span class="hs-identifier hs-var hs-var">dsBody</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NormalB</span></span><span> </span><span id="local-6989586621679413312"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413312"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679413311"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679413311"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679413310"><span class="annot"><span class="annottext">decs' :: [DLetDec]
</span><a href="#local-6989586621679413310"><span class="hs-identifier hs-var">decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679413309"><span class="annot"><span class="annottext">ip_binder :: DExp -&gt; DExp
</span><a href="#local-6989586621679413309"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679413311"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-351"></span><span>  </span><span id="local-6989586621679413308"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413308"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413312"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-352"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var">maybeDLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679413310"><span class="hs-identifier hs-var">decs'</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; DExp -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679413309"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413308"><span class="hs-identifier hs-var">exp'</span></a></span><span>
</span><span id="line-353"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsBody"><span class="hs-identifier hs-var">dsBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GuardedB</span></span><span> </span><span id="local-6989586621679413305"><span class="annot"><span class="annottext">guarded_exps :: [(Guard, Exp)]
</span><a href="#local-6989586621679413305"><span class="hs-identifier hs-var">guarded_exps</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679413304"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679413304"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span id="local-6989586621679413303"><span class="annot"><span class="annottext">failure :: DExp
</span><a href="#local-6989586621679413303"><span class="hs-identifier hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679413302"><span class="annot"><span class="annottext">decs' :: [DLetDec]
</span><a href="#local-6989586621679413302"><span class="hs-identifier hs-var">decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679413301"><span class="annot"><span class="annottext">ip_binder :: DExp -&gt; DExp
</span><a href="#local-6989586621679413301"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679413304"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-355"></span><span>  </span><span id="local-6989586621679413300"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413300"><span class="hs-identifier hs-var">guarded_exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Guard, Exp)] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [(Guard, Exp)] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var">dsGuards</span></a></span><span> </span><span class="annot"><span class="annottext">[(Guard, Exp)]
</span><a href="#local-6989586621679413305"><span class="hs-identifier hs-var">guarded_exps</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413303"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var">maybeDLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679413302"><span class="hs-identifier hs-var">decs'</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; DExp -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679413301"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413300"><span class="hs-identifier hs-var">guarded_exp'</span></a></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-comment">-- | If decs is non-empty, delcare them in a let:</span><span>
</span><span id="line-359"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-type">maybeDLetE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-type">DLetDec</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-360"></span><span id="maybeDLetE"><span class="annot"><span class="annottext">maybeDLetE :: [DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var hs-var">maybeDLetE</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679413299"><span class="annot"><span class="annottext">exp :: DExp
</span><a href="#local-6989586621679413299"><span class="hs-identifier hs-var">exp</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413299"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-361"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var">maybeDLetE</span></a></span><span> </span><span id="local-6989586621679413298"><span class="annot"><span class="annottext">decs :: [DLetDec]
</span><a href="#local-6989586621679413298"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span id="local-6989586621679413297"><span class="annot"><span class="annottext">exp :: DExp
</span><a href="#local-6989586621679413297"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetE"><span class="hs-identifier hs-var">DLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679413298"><span class="hs-identifier hs-var">decs</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413297"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-comment">-- | If matches is non-empty, make a case statement; otherwise make an error statement</span><span>
</span><span id="line-364"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#maybeDCaseE"><span class="hs-identifier hs-type">maybeDCaseE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-365"></span><span id="maybeDCaseE"><span class="annot"><span class="annottext">maybeDCaseE :: String -&gt; DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDCaseE"><span class="hs-identifier hs-var hs-var">maybeDCaseE</span></a></span></span><span> </span><span id="local-6989586621679413295"><span class="annot"><span class="annottext">err :: String
</span><a href="#local-6989586621679413295"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">error</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Lit
</span><span class="hs-identifier hs-var">StringL</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679413295"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#maybeDCaseE"><span class="hs-identifier hs-var">maybeDCaseE</span></a></span><span> </span><span class="hs-identifier">_</span><span>   </span><span id="local-6989586621679413294"><span class="annot"><span class="annottext">scrut :: DExp
</span><a href="#local-6989586621679413294"><span class="hs-identifier hs-var">scrut</span></a></span></span><span> </span><span id="local-6989586621679413293"><span class="annot"><span class="annottext">matches :: [DMatch]
</span><a href="#local-6989586621679413293"><span class="hs-identifier hs-var">matches</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413294"><span class="hs-identifier hs-var">scrut</span></a></span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679413293"><span class="hs-identifier hs-var">matches</span></a></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="hs-comment">-- | Desugar guarded expressions</span><span>
</span><span id="line-369"></span><span id="local-6989586621679414002"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-type">dsGuards</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679414002"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-370"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Guard</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ Guarded expressions</span><span>
</span><span id="line-371"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>            </span><span class="hs-comment">-- ^ What to do if none of the guards match</span><span>
</span><span id="line-372"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679414002"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-373"></span><span id="dsGuards"><span class="annot"><span class="annottext">dsGuards :: [(Guard, Exp)] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var hs-var">dsGuards</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679413292"><span class="annot"><span class="annottext">thing_inside :: DExp
</span><a href="#local-6989586621679413292"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413292"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-374"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var">dsGuards</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NormalG</span></span><span> </span><span id="local-6989586621679413290"><span class="annot"><span class="annottext">gd :: Exp
</span><a href="#local-6989586621679413290"><span class="hs-identifier hs-var">gd</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679413289"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413289"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679413288"><span class="annot"><span class="annottext">rest :: [(Guard, Exp)]
</span><a href="#local-6989586621679413288"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679413287"><span class="annot"><span class="annottext">thing_inside :: DExp
</span><a href="#local-6989586621679413287"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-375"></span><span>  </span><span class="annot"><span class="annottext">[(Guard, Exp)] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [(Guard, Exp)] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var">dsGuards</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Stmt] -&gt; Guard
</span><span class="hs-identifier hs-var">PatG</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp -&gt; Stmt
</span><span class="hs-identifier hs-var">NoBindS</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413290"><span class="hs-identifier hs-var">gd</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413289"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Guard, Exp) -&gt; [(Guard, Exp)] -&gt; [(Guard, Exp)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Guard, Exp)]
</span><a href="#local-6989586621679413288"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413287"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-376"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var">dsGuards</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PatG</span></span><span> </span><span id="local-6989586621679413284"><span class="annot"><span class="annottext">stmts :: [Stmt]
</span><a href="#local-6989586621679413284"><span class="hs-identifier hs-var">stmts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679413283"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413283"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679413282"><span class="annot"><span class="annottext">rest :: [(Guard, Exp)]
</span><a href="#local-6989586621679413282"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679413281"><span class="annot"><span class="annottext">thing_inside :: DExp
</span><a href="#local-6989586621679413281"><span class="hs-identifier hs-var">thing_inside</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-377"></span><span>  </span><span id="local-6989586621679413280"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413280"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413283"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-378"></span><span>  </span><span id="local-6989586621679413279"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413279"><span class="hs-identifier hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Guard, Exp)] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [(Guard, Exp)] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuards"><span class="hs-identifier hs-var">dsGuards</span></a></span><span> </span><span class="annot"><span class="annottext">[(Guard, Exp)]
</span><a href="#local-6989586621679413282"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413281"><span class="hs-identifier hs-var">thing_inside</span></a></span><span>
</span><span id="line-379"></span><span>  </span><span class="annot"><span class="annottext">[Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679413284"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413280"><span class="hs-identifier hs-var">success</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413279"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-comment">-- | Desugar the @Stmt@s in a guard</span><span>
</span><span id="line-382"></span><span id="local-6989586621679413910"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-type">dsGuardStmts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413910"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-383"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Stmt</span></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ The @Stmt@s to desugar</span><span>
</span><span id="line-384"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>    </span><span class="hs-comment">-- ^ What to do if the @Stmt@s yield success</span><span>
</span><span id="line-385"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>    </span><span class="hs-comment">-- ^ What to do if the @Stmt@s yield failure</span><span>
</span><span id="line-386"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413910"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-387"></span><span id="dsGuardStmts"><span class="annot"><span class="annottext">dsGuardStmts :: [Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var hs-var">dsGuardStmts</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679413277"><span class="annot"><span class="annottext">success :: DExp
</span><a href="#local-6989586621679413277"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span id="local-6989586621679413276"><span class="annot"><span class="annottext">_failure :: DExp
</span><a href="#local-6989586621679413276"><span class="hs-identifier hs-var">_failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413277"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-388"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BindS</span></span><span> </span><span id="local-6989586621679413274"><span class="annot"><span class="annottext">pat :: Pat
</span><a href="#local-6989586621679413274"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679413273"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413273"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679413272"><span class="annot"><span class="annottext">rest :: [Stmt]
</span><a href="#local-6989586621679413272"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679413271"><span class="annot"><span class="annottext">success :: DExp
</span><a href="#local-6989586621679413271"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span id="local-6989586621679413270"><span class="annot"><span class="annottext">failure :: DExp
</span><a href="#local-6989586621679413270"><span class="hs-identifier hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-389"></span><span>  </span><span id="local-6989586621679413269"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413269"><span class="hs-identifier hs-var">success'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679413272"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413271"><span class="hs-identifier hs-var">success</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413270"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679413268"><span class="annot"><span class="annottext">pat' :: DPat
</span><a href="#local-6989586621679413268"><span class="hs-identifier hs-var">pat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679413267"><span class="annot"><span class="annottext">success'' :: DExp
</span><a href="#local-6989586621679413267"><span class="hs-identifier hs-var">success''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; DExp -&gt; q (DPat, DExp)
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; DExp -&gt; q (DPat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatOverExp"><span class="hs-identifier hs-var">dsPatOverExp</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679413274"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413269"><span class="hs-identifier hs-var">success'</span></a></span><span>
</span><span id="line-391"></span><span>  </span><span id="local-6989586621679413266"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413266"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413273"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-392"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413266"><span class="hs-identifier hs-var">exp'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413268"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413267"><span class="hs-identifier hs-var">success''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413270"><span class="hs-identifier hs-var">failure</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-393"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LetS</span></span><span> </span><span id="local-6989586621679413264"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679413264"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679413263"><span class="annot"><span class="annottext">rest :: [Stmt]
</span><a href="#local-6989586621679413263"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679413262"><span class="annot"><span class="annottext">success :: DExp
</span><a href="#local-6989586621679413262"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span id="local-6989586621679413261"><span class="annot"><span class="annottext">failure :: DExp
</span><a href="#local-6989586621679413261"><span class="hs-identifier hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679413260"><span class="annot"><span class="annottext">decs' :: [DLetDec]
</span><a href="#local-6989586621679413260"><span class="hs-identifier hs-var">decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679413259"><span class="annot"><span class="annottext">ip_binder :: DExp -&gt; DExp
</span><a href="#local-6989586621679413259"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679413264"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-395"></span><span>  </span><span id="local-6989586621679413258"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413258"><span class="hs-identifier hs-var">success'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679413263"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413262"><span class="hs-identifier hs-var">success</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413261"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-396"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetE"><span class="hs-identifier hs-var">DLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679413260"><span class="hs-identifier hs-var">decs'</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; DExp -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679413259"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413258"><span class="hs-identifier hs-var">success'</span></a></span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-comment">-- special-case a final pattern containing &quot;otherwise&quot; or &quot;True&quot;</span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-comment">-- note that GHC does this special-casing, too, in DsGRHSs.isTrueLHsExpr</span><span>
</span><span id="line-399"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">NoBindS</span></span><span> </span><span id="local-6989586621679413257"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413257"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679413256"><span class="annot"><span class="annottext">success :: DExp
</span><a href="#local-6989586621679413256"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span id="local-6989586621679413255"><span class="annot"><span class="annottext">_failure :: DExp
</span><a href="#local-6989586621679413255"><span class="hs-identifier hs-var">_failure</span></a></span></span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VarE</span></span><span> </span><span id="local-6989586621679413254"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679413254"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413257"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-401"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413254"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">otherwise</span><span>
</span><span id="line-402"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413256"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConE</span></span><span> </span><span id="local-6989586621679413253"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679413253"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413257"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413253"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">True</span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413256"><span class="hs-identifier hs-var">success</span></a></span><span>
</span><span id="line-407"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NoBindS</span></span><span> </span><span id="local-6989586621679413252"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413252"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679413251"><span class="annot"><span class="annottext">rest :: [Stmt]
</span><a href="#local-6989586621679413251"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679413250"><span class="annot"><span class="annottext">success :: DExp
</span><a href="#local-6989586621679413250"><span class="hs-identifier hs-var">success</span></a></span></span><span> </span><span id="local-6989586621679413249"><span class="annot"><span class="annottext">failure :: DExp
</span><a href="#local-6989586621679413249"><span class="hs-identifier hs-var">failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-408"></span><span>  </span><span id="local-6989586621679413248"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413248"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413252"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-409"></span><span>  </span><span id="local-6989586621679413247"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413247"><span class="hs-identifier hs-var">success'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; DExp -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679413251"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413250"><span class="hs-identifier hs-var">success</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413249"><span class="hs-identifier hs-var">failure</span></a></span><span>
</span><span id="line-410"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413248"><span class="hs-identifier hs-var">exp'</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">True</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413247"><span class="hs-identifier hs-var">success'</span></a></span><span>
</span><span id="line-411"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">False</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413249"><span class="hs-identifier hs-var">failure</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-412"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParS</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DExp
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Parallel comprehension in a pattern guard.&quot;</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsGuardStmts"><span class="hs-identifier hs-var">dsGuardStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecS</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DExp
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;th-desugar currently does not support RecursiveDo&quot;</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- | Desugar the @Stmt@s in a @do@ expression</span><span>
</span><span id="line-418"></span><span id="local-6989586621679413997"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-type">dsDoStmts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413997"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Stmt</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413997"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-419"></span><span id="dsDoStmts"><span class="annot"><span class="annottext">dsDoStmts :: [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var hs-var">dsDoStmts</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DExp
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;do-expression ended with something other than bare statement.&quot;</span></span><span>
</span><span id="line-420"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">NoBindS</span></span><span> </span><span id="local-6989586621679413244"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413244"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413244"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-421"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BindS</span></span><span> </span><span id="local-6989586621679413243"><span class="annot"><span class="annottext">pat :: Pat
</span><a href="#local-6989586621679413243"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679413242"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413242"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679413241"><span class="annot"><span class="annottext">rest :: [Stmt]
</span><a href="#local-6989586621679413241"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-422"></span><span>  </span><span id="local-6989586621679413240"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413240"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679413241"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-423"></span><span>  </span><span class="annot"><span class="annottext">Exp -&gt; Pat -&gt; DExp -&gt; String -&gt; q DExp
forall (q :: * -&gt; *).
DsMonad q =&gt;
Exp -&gt; Pat -&gt; DExp -&gt; String -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBindS"><span class="hs-identifier hs-var">dsBindS</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413242"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679413243"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413240"><span class="hs-identifier hs-var">rest'</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;do expression&quot;</span></span><span>
</span><span id="line-424"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LetS</span></span><span> </span><span id="local-6989586621679413238"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679413238"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679413237"><span class="annot"><span class="annottext">rest :: [Stmt]
</span><a href="#local-6989586621679413237"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-425"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679413236"><span class="annot"><span class="annottext">decs' :: [DLetDec]
</span><a href="#local-6989586621679413236"><span class="hs-identifier hs-var">decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679413235"><span class="annot"><span class="annottext">ip_binder :: DExp -&gt; DExp
</span><a href="#local-6989586621679413235"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679413238"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-426"></span><span>  </span><span id="local-6989586621679413234"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413234"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679413237"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-427"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetE"><span class="hs-identifier hs-var">DLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679413236"><span class="hs-identifier hs-var">decs'</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; DExp -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679413235"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413234"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-428"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NoBindS</span></span><span> </span><span id="local-6989586621679413233"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413233"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679413232"><span class="annot"><span class="annottext">rest :: [Stmt]
</span><a href="#local-6989586621679413232"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-429"></span><span>  </span><span id="local-6989586621679413231"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413231"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413233"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-430"></span><span>  </span><span id="local-6989586621679413230"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413230"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679413232"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-431"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-operator">&gt;&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413231"><span class="hs-identifier hs-var">exp'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413230"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-432"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParS</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DExp
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Parallel comprehension in a do-statement.&quot;</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDoStmts"><span class="hs-identifier hs-var">dsDoStmts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecS</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DExp
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;th-desugar currently does not support RecursiveDo&quot;</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-437"></span><span class="hs-comment">-- | Desugar the @Stmt@s in a list or monad comprehension</span><span>
</span><span id="line-438"></span><span id="local-6989586621679413229"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-type">dsComp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413229"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Stmt</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413229"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span></span><span>
</span><span id="line-439"></span><span id="dsComp"><span class="annot"><span class="annottext">dsComp :: [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var hs-var">dsComp</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DExp
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;List/monad comprehension ended with something other than a bare statement.&quot;</span></span><span>
</span><span id="line-440"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">NoBindS</span></span><span> </span><span id="local-6989586621679413228"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413228"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">return</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413228"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-441"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BindS</span></span><span> </span><span id="local-6989586621679413227"><span class="annot"><span class="annottext">pat :: Pat
</span><a href="#local-6989586621679413227"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679413226"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413226"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679413225"><span class="annot"><span class="annottext">rest :: [Stmt]
</span><a href="#local-6989586621679413225"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-442"></span><span>  </span><span id="local-6989586621679413224"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413224"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679413225"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-443"></span><span>  </span><span class="annot"><span class="annottext">Exp -&gt; Pat -&gt; DExp -&gt; String -&gt; q DExp
forall (q :: * -&gt; *).
DsMonad q =&gt;
Exp -&gt; Pat -&gt; DExp -&gt; String -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBindS"><span class="hs-identifier hs-var">dsBindS</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413226"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679413227"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413224"><span class="hs-identifier hs-var">rest'</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;monad comprehension&quot;</span></span><span>
</span><span id="line-444"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LetS</span></span><span> </span><span id="local-6989586621679413223"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679413223"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679413222"><span class="annot"><span class="annottext">rest :: [Stmt]
</span><a href="#local-6989586621679413222"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679413221"><span class="annot"><span class="annottext">decs' :: [DLetDec]
</span><a href="#local-6989586621679413221"><span class="hs-identifier hs-var">decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679413220"><span class="annot"><span class="annottext">ip_binder :: DExp -&gt; DExp
</span><a href="#local-6989586621679413220"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679413223"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-446"></span><span>  </span><span id="local-6989586621679413219"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413219"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679413222"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-447"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetE"><span class="hs-identifier hs-var">DLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679413221"><span class="hs-identifier hs-var">decs'</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; DExp -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679413220"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413219"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-448"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NoBindS</span></span><span> </span><span id="local-6989586621679413218"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679413218"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679413217"><span class="annot"><span class="annottext">rest :: [Stmt]
</span><a href="#local-6989586621679413217"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-449"></span><span>  </span><span id="local-6989586621679413216"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413216"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413218"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-450"></span><span>  </span><span id="local-6989586621679413215"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413215"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679413217"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-451"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-operator">&gt;&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">guard</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413216"><span class="hs-identifier hs-var">exp'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413215"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-452"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParS</span></span><span> </span><span id="local-6989586621679413214"><span class="annot"><span class="annottext">stmtss :: [[Stmt]]
</span><a href="#local-6989586621679413214"><span class="hs-identifier hs-var">stmtss</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679413213"><span class="annot"><span class="annottext">rest :: [Stmt]
</span><a href="#local-6989586621679413213"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679413212"><span class="annot"><span class="annottext">pat :: Pat
</span><a href="#local-6989586621679413212"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679413211"><span class="annot"><span class="annottext">exp :: DExp
</span><a href="#local-6989586621679413211"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[Stmt]] -&gt; q (Pat, DExp)
forall (q :: * -&gt; *). DsMonad q =&gt; [[Stmt]] -&gt; q (Pat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsParComp"><span class="hs-identifier hs-var">dsParComp</span></a></span><span> </span><span class="annot"><span class="annottext">[[Stmt]]
</span><a href="#local-6989586621679413214"><span class="hs-identifier hs-var">stmtss</span></a></span><span>
</span><span id="line-454"></span><span>  </span><span id="local-6989586621679413209"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413209"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679413213"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-455"></span><span>  </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-operator">&gt;&gt;=</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413211"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Pat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLam"><span class="hs-identifier hs-var">dsLam</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679413212"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413209"><span class="hs-identifier hs-var">rest'</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecS</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DExp
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;th-desugar currently does not support RecursiveDo&quot;</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-460"></span><span class="hs-comment">-- Desugar a binding statement in a do- or list comprehension.</span><span>
</span><span id="line-461"></span><span class="hs-comment">--</span><span>
</span><span id="line-462"></span><span class="hs-comment">-- In the event that the pattern in the statement is partial, the desugared</span><span>
</span><span id="line-463"></span><span class="hs-comment">-- case expression will contain a catch-all case that calls 'fail' from either</span><span>
</span><span id="line-464"></span><span class="hs-comment">-- 'MonadFail' or 'Monad', depending on whether the @MonadFailDesugaring@</span><span>
</span><span id="line-465"></span><span class="hs-comment">-- language extension is enabled or not. (On GHCs older than 8.0, 'fail' from</span><span>
</span><span id="line-466"></span><span class="hs-comment">-- 'Monad' is always used.)</span><span>
</span><span id="line-467"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsBindS"><span class="hs-identifier hs-type">dsBindS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679413907"><span class="annot"><a href="#local-6989586621679413907"><span class="hs-identifier hs-type">q</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413907"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413907"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-468"></span><span id="dsBindS"><span class="annot"><span class="annottext">dsBindS :: Exp -&gt; Pat -&gt; DExp -&gt; String -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBindS"><span class="hs-identifier hs-var hs-var">dsBindS</span></a></span></span><span> </span><span id="local-6989586621679413208"><span class="annot"><span class="annottext">bind_arg_exp :: Exp
</span><a href="#local-6989586621679413208"><span class="hs-identifier hs-var">bind_arg_exp</span></a></span></span><span> </span><span id="local-6989586621679413207"><span class="annot"><span class="annottext">success_pat :: Pat
</span><a href="#local-6989586621679413207"><span class="hs-identifier hs-var">success_pat</span></a></span></span><span> </span><span id="local-6989586621679413206"><span class="annot"><span class="annottext">success_exp :: DExp
</span><a href="#local-6989586621679413206"><span class="hs-identifier hs-var">success_exp</span></a></span></span><span> </span><span id="local-6989586621679413205"><span class="annot"><span class="annottext">ctxt :: String
</span><a href="#local-6989586621679413205"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-469"></span><span>  </span><span id="local-6989586621679413204"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413204"><span class="hs-identifier hs-var">bind_arg_exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679413208"><span class="hs-identifier hs-var">bind_arg_exp</span></a></span><span>
</span><span id="line-470"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679413203"><span class="annot"><span class="annottext">success_pat' :: DPat
</span><a href="#local-6989586621679413203"><span class="hs-identifier hs-var">success_pat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679413202"><span class="annot"><span class="annottext">success_exp' :: DExp
</span><a href="#local-6989586621679413202"><span class="hs-identifier hs-var">success_exp'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; DExp -&gt; q (DPat, DExp)
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; DExp -&gt; q (DPat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatOverExp"><span class="hs-identifier hs-var">dsPatOverExp</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679413207"><span class="hs-identifier hs-var">success_pat</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413206"><span class="hs-identifier hs-var">success_exp</span></a></span><span>
</span><span id="line-471"></span><span>  </span><span id="local-6989586621679413201"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679413201"><span class="hs-identifier hs-var">is_univ_pat</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q Bool
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413203"><span class="hs-identifier hs-var">success_pat'</span></a></span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679413200"><span class="annot"><span class="annottext">bind_into :: DExp -&gt; DExp
</span><a href="#local-6989586621679413200"><span class="hs-identifier hs-var hs-var">bind_into</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-operator">&gt;&gt;=</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413204"><span class="hs-identifier hs-var">bind_arg_exp'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679413201"><span class="hs-identifier hs-var">is_univ_pat</span></a></span><span>
</span><span id="line-474"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679413200"><span class="hs-identifier hs-var">bind_into</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; q DExp -&gt; q DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[DPat] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [DPat] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkDLamEFromDPats"><span class="hs-identifier hs-var">mkDLamEFromDPats</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413203"><span class="hs-identifier hs-var">success_pat'</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413202"><span class="hs-identifier hs-var">success_exp'</span></a></span><span>
</span><span id="line-475"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679413199"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413199"><span class="hs-identifier hs-var">arg_name</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;arg&quot;</span></span><span>
</span><span id="line-476"></span><span>             </span><span id="local-6989586621679413198"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413198"><span class="hs-identifier hs-var">fail_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">q Name
</span><a href="#local-6989586621679413197"><span class="hs-identifier hs-var">mk_fail_name</span></a></span><span>
</span><span id="line-477"></span><span>             </span><span class="annot"><span class="annottext">DExp -&gt; q DExp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; q DExp) -&gt; DExp -&gt; q DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679413200"><span class="hs-identifier hs-var">bind_into</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; DExp -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLamE"><span class="hs-identifier hs-var">DLamE</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413199"><span class="hs-identifier hs-var">arg_name</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; DExp -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413199"><span class="hs-identifier hs-var">arg_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>               </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413203"><span class="hs-identifier hs-var">success_pat'</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413202"><span class="hs-identifier hs-var">success_exp'</span></a></span><span>
</span><span id="line-479"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DMatch) -&gt; DExp -&gt; DMatch
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-480"></span><span>                 </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413198"><span class="hs-identifier hs-var">fail_name</span></a></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-operator hs-var">`DAppE`</span></a></span><span>
</span><span id="line-481"></span><span>                   </span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Lit
</span><span class="hs-identifier hs-var">StringL</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Lit) -&gt; String -&gt; Lit
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Pattern match failure in &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679413205"><span class="hs-identifier hs-var">ctxt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>               </span><span class="hs-special">]</span><span>
</span><span id="line-483"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-484"></span><span>    </span><span class="annot"><a href="#local-6989586621679413197"><span class="hs-identifier hs-type">mk_fail_name</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679413907"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span>    </span><span class="hs-comment">-- GHC 8.8 deprecates the MonadFailDesugaring extension since its effects</span><span>
</span><span id="line-487"></span><span>    </span><span class="hs-comment">-- are always enabled. Furthermore, MonadFailDesugaring is no longer</span><span>
</span><span id="line-488"></span><span>    </span><span class="hs-comment">-- enabled by default, so simply use MonadFail.fail. (That happens to</span><span>
</span><span id="line-489"></span><span>    </span><span class="hs-comment">-- be the same as Prelude.fail in 8.8+.)</span><span>
</span><span id="line-490"></span><span>    </span><span id="local-6989586621679413197"><span class="annot"><span class="annottext">mk_fail_name :: q Name
</span><a href="#local-6989586621679413197"><span class="hs-identifier hs-var hs-var">mk_fail_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Name
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">MonadFail.fail</span><span class="hs-cpp">
#elif __GLASGOW_HASKELL__ &gt;= 800
</span><span>    </span><span class="hs-identifier">mk_fail_name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-493"></span><span>      </span><span class="hs-identifier">mfd</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">qIsExtEnabled</span><span> </span><span class="hs-identifier">MonadFailDesugaring</span><span>
</span><span id="line-494"></span><span>      </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">mfd</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">MonadFail.fail</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Prelude.fail</span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-identifier">mk_fail_name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">Prelude.fail</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-499"></span><span class="hs-comment">-- | Desugar the contents of a parallel comprehension.</span><span>
</span><span id="line-500"></span><span class="hs-comment">--   Returns a @Pat@ containing a tuple of all bound variables and an expression</span><span>
</span><span id="line-501"></span><span class="hs-comment">--   to produce the values for those variables</span><span>
</span><span id="line-502"></span><span id="local-6989586621679413905"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsParComp"><span class="hs-identifier hs-type">dsParComp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413905"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Stmt</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413905"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-503"></span><span id="dsParComp"><span class="annot"><span class="annottext">dsParComp :: [[Stmt]] -&gt; q (Pat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsParComp"><span class="hs-identifier hs-var hs-var">dsParComp</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q (Pat, DExp)
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Empty list of parallel comprehension statements.&quot;</span></span><span>
</span><span id="line-504"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsParComp"><span class="hs-identifier hs-var">dsParComp</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679413196"><span class="annot"><span class="annottext">r :: [Stmt]
</span><a href="#local-6989586621679413196"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679413195"><span class="annot"><span class="annottext">rv :: OSet Name
</span><a href="#local-6989586621679413195"><span class="hs-identifier hs-var hs-var">rv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Stmt -&gt; OSet Name) -&gt; [Stmt] -&gt; OSet Name
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-var">extractBoundNamesStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679413196"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-506"></span><span>  </span><span id="local-6989586621679413192"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413192"><span class="hs-identifier hs-var">dsR</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679413196"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; [Stmt] -&gt; [Stmt]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">OSet Name -&gt; Stmt
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_stmt"><span class="hs-identifier hs-var">mk_tuple_stmt</span></a></span><span> </span><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679413195"><span class="hs-identifier hs-var">rv</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>  </span><span class="annot"><span class="annottext">(Pat, DExp) -&gt; q (Pat, DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OSet Name -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_pat"><span class="hs-identifier hs-var">mk_tuple_pat</span></a></span><span> </span><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679413195"><span class="hs-identifier hs-var">rv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413192"><span class="hs-identifier hs-var">dsR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsParComp"><span class="hs-identifier hs-var">dsParComp</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679413189"><span class="annot"><span class="annottext">q :: [Stmt]
</span><a href="#local-6989586621679413189"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679413188"><span class="annot"><span class="annottext">rest :: [[Stmt]]
</span><a href="#local-6989586621679413188"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-509"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679413187"><span class="annot"><span class="annottext">qv :: OSet Name
</span><a href="#local-6989586621679413187"><span class="hs-identifier hs-var hs-var">qv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Stmt -&gt; OSet Name) -&gt; [Stmt] -&gt; OSet Name
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Stmt -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#extractBoundNamesStmt"><span class="hs-identifier hs-var">extractBoundNamesStmt</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679413189"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-510"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679413186"><span class="annot"><span class="annottext">rest_pat :: Pat
</span><a href="#local-6989586621679413186"><span class="hs-identifier hs-var">rest_pat</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679413185"><span class="annot"><span class="annottext">rest_exp :: DExp
</span><a href="#local-6989586621679413185"><span class="hs-identifier hs-var">rest_exp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[Stmt]] -&gt; q (Pat, DExp)
forall (q :: * -&gt; *). DsMonad q =&gt; [[Stmt]] -&gt; q (Pat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsParComp"><span class="hs-identifier hs-var">dsParComp</span></a></span><span> </span><span class="annot"><span class="annottext">[[Stmt]]
</span><a href="#local-6989586621679413188"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-511"></span><span>  </span><span id="local-6989586621679413184"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413184"><span class="hs-identifier hs-var">dsQ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; [Stmt] -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsComp"><span class="hs-identifier hs-var">dsComp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Stmt]
</span><a href="#local-6989586621679413189"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">[Stmt] -&gt; [Stmt] -&gt; [Stmt]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">OSet Name -&gt; Stmt
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_stmt"><span class="hs-identifier hs-var">mk_tuple_stmt</span></a></span><span> </span><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679413187"><span class="hs-identifier hs-var">qv</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679413183"><span class="annot"><span class="annottext">zipped :: DExp
</span><a href="#local-6989586621679413183"><span class="hs-identifier hs-var hs-var">zipped</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">mzip</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413184"><span class="hs-identifier hs-var">dsQ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413185"><span class="hs-identifier hs-var">rest_exp</span></a></span><span>
</span><span id="line-513"></span><span>  </span><span class="annot"><span class="annottext">(Pat, DExp) -&gt; q (Pat, DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Pat
</span><span class="hs-identifier hs-var">ConP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">OSet Name -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_pat"><span class="hs-identifier hs-var">mk_tuple_pat</span></a></span><span> </span><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679413187"><span class="hs-identifier hs-var">qv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679413186"><span class="hs-identifier hs-var">rest_pat</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413183"><span class="hs-identifier hs-var">zipped</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span class="hs-comment">-- helper function for dsParComp</span><span>
</span><span id="line-516"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_stmt"><span class="hs-identifier hs-type">mk_tuple_stmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html#OSet"><span class="hs-identifier hs-type">OSet</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Stmt</span></span><span>
</span><span id="line-517"></span><span id="mk_tuple_stmt"><span class="annot"><span class="annottext">mk_tuple_stmt :: OSet Name -&gt; Stmt
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_stmt"><span class="hs-identifier hs-var hs-var">mk_tuple_stmt</span></a></span></span><span> </span><span id="local-6989586621679413182"><span class="annot"><span class="annottext">name_set :: OSet Name
</span><a href="#local-6989586621679413182"><span class="hs-identifier hs-var">name_set</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-518"></span><span>  </span><span class="annot"><span class="annottext">Exp -&gt; Stmt
</span><span class="hs-identifier hs-var">NoBindS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp] -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleExp"><span class="hs-identifier hs-var">mkTupleExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; [Exp] -&gt; [Exp]) -&gt; [Exp] -&gt; OSet Name -&gt; [Exp]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">F.foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; [Exp] -&gt; [Exp]) -&gt; (Name -&gt; Exp) -&gt; Name -&gt; [Exp] -&gt; [Exp]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679413182"><span class="hs-identifier hs-var">name_set</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span>
</span><span id="line-520"></span><span class="hs-comment">-- helper function for dsParComp</span><span>
</span><span id="line-521"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_pat"><span class="hs-identifier hs-type">mk_tuple_pat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.OSet.html#OSet"><span class="hs-identifier hs-type">OSet</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span>
</span><span id="line-522"></span><span id="mk_tuple_pat"><span class="annot"><span class="annottext">mk_tuple_pat :: OSet Name -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mk_tuple_pat"><span class="hs-identifier hs-var hs-var">mk_tuple_pat</span></a></span></span><span> </span><span id="local-6989586621679413180"><span class="annot"><span class="annottext">name_set :: OSet Name
</span><a href="#local-6989586621679413180"><span class="hs-identifier hs-var">name_set</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-523"></span><span>  </span><span class="annot"><span class="annottext">[Pat] -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTuplePat"><span class="hs-identifier hs-var">mkTuplePat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; [Pat] -&gt; [Pat]) -&gt; [Pat] -&gt; OSet Name -&gt; [Pat]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">F.foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Pat -&gt; [Pat] -&gt; [Pat]) -&gt; (Name -&gt; Pat) -&gt; Name -&gt; [Pat] -&gt; [Pat]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><span class="hs-identifier hs-var">VarP</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">OSet Name
</span><a href="#local-6989586621679413180"><span class="hs-identifier hs-var">name_set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span>
</span><span id="line-525"></span><span class="hs-comment">-- | Desugar a pattern, along with processing a (desugared) expression that</span><span>
</span><span id="line-526"></span><span class="hs-comment">-- is the entire scope of the variables bound in the pattern.</span><span>
</span><span id="line-527"></span><span id="local-6989586621679413914"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPatOverExp"><span class="hs-identifier hs-type">dsPatOverExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413914"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413914"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-528"></span><span id="dsPatOverExp"><span class="annot"><span class="annottext">dsPatOverExp :: Pat -&gt; DExp -&gt; q (DPat, DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatOverExp"><span class="hs-identifier hs-var hs-var">dsPatOverExp</span></a></span></span><span> </span><span id="local-6989586621679413178"><span class="annot"><span class="annottext">pat :: Pat
</span><a href="#local-6989586621679413178"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679413177"><span class="annot"><span class="annottext">exp :: DExp
</span><a href="#local-6989586621679413177"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-529"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679413176"><span class="annot"><span class="annottext">pat' :: DPat
</span><a href="#local-6989586621679413176"><span class="hs-identifier hs-var">pat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679413175"><span class="annot"><span class="annottext">vars :: [(Name, DExp)]
</span><a href="#local-6989586621679413175"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WriterT [(Name, DExp)] q DPat -&gt; q (DPat, [(Name, DExp)])
forall w (m :: * -&gt; *) a. WriterT w m a -&gt; m (a, w)
</span><span class="hs-identifier hs-var hs-var">runWriterT</span></span><span> </span><span class="annot"><span class="annottext">(WriterT [(Name, DExp)] q DPat -&gt; q (DPat, [(Name, DExp)]))
-&gt; WriterT [(Name, DExp)] q DPat -&gt; q (DPat, [(Name, DExp)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; WriterT [(Name, DExp)] q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679413178"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-530"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679413172"><span class="annot"><span class="annottext">name_decs :: [DLetDec]
</span><a href="#local-6989586621679413172"><span class="hs-identifier hs-var hs-var">name_decs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; [DExp] -&gt; [DLetDec]) -&gt; ([Name], [DExp]) -&gt; [DLetDec]
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; DExp -&gt; DLetDec) -&gt; [Name] -&gt; [DExp] -&gt; [DLetDec]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DValD"><span class="hs-identifier hs-var">DValD</span></a></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; DExp -&gt; DLetDec)
-&gt; (Name -&gt; DPat) -&gt; Name -&gt; DExp -&gt; DLetDec
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([Name], [DExp]) -&gt; [DLetDec]) -&gt; ([Name], [DExp]) -&gt; [DLetDec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Name, DExp)] -&gt; ([Name], [DExp])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">[(Name, DExp)]
</span><a href="#local-6989586621679413175"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-531"></span><span>  </span><span class="annot"><span class="annottext">(DPat, DExp) -&gt; q (DPat, DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413176"><span class="hs-identifier hs-var">pat'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var">maybeDLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679413172"><span class="hs-identifier hs-var">name_decs</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413177"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span class="hs-comment">-- | Desugar multiple patterns. Like 'dsPatOverExp'.</span><span>
</span><span id="line-534"></span><span id="local-6989586621679413924"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPatsOverExp"><span class="hs-identifier hs-type">dsPatsOverExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413924"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413924"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-535"></span><span id="dsPatsOverExp"><span class="annot"><span class="annottext">dsPatsOverExp :: [Pat] -&gt; DExp -&gt; q ([DPat], DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatsOverExp"><span class="hs-identifier hs-var hs-var">dsPatsOverExp</span></a></span></span><span> </span><span id="local-6989586621679413168"><span class="annot"><span class="annottext">pats :: [Pat]
</span><a href="#local-6989586621679413168"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span id="local-6989586621679413167"><span class="annot"><span class="annottext">exp :: DExp
</span><a href="#local-6989586621679413167"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-536"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679413166"><span class="annot"><span class="annottext">pats' :: [DPat]
</span><a href="#local-6989586621679413166"><span class="hs-identifier hs-var">pats'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679413165"><span class="annot"><span class="annottext">vars :: [(Name, DExp)]
</span><a href="#local-6989586621679413165"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WriterT [(Name, DExp)] q [DPat] -&gt; q ([DPat], [(Name, DExp)])
forall w (m :: * -&gt; *) a. WriterT w m a -&gt; m (a, w)
</span><span class="hs-identifier hs-var hs-var">runWriterT</span></span><span> </span><span class="annot"><span class="annottext">(WriterT [(Name, DExp)] q [DPat] -&gt; q ([DPat], [(Name, DExp)]))
-&gt; WriterT [(Name, DExp)] q [DPat] -&gt; q ([DPat], [(Name, DExp)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Pat -&gt; WriterT [(Name, DExp)] q DPat)
-&gt; [Pat] -&gt; WriterT [(Name, DExp)] q [DPat]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; WriterT [(Name, DExp)] q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679413168"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-537"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679413164"><span class="annot"><span class="annottext">name_decs :: [DLetDec]
</span><a href="#local-6989586621679413164"><span class="hs-identifier hs-var hs-var">name_decs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; [DExp] -&gt; [DLetDec]) -&gt; ([Name], [DExp]) -&gt; [DLetDec]
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; DExp -&gt; DLetDec) -&gt; [Name] -&gt; [DExp] -&gt; [DLetDec]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DValD"><span class="hs-identifier hs-var">DValD</span></a></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; DExp -&gt; DLetDec)
-&gt; (Name -&gt; DPat) -&gt; Name -&gt; DExp -&gt; DLetDec
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([Name], [DExp]) -&gt; [DLetDec]) -&gt; ([Name], [DExp]) -&gt; [DLetDec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Name, DExp)] -&gt; ([Name], [DExp])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">[(Name, DExp)]
</span><a href="#local-6989586621679413165"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-538"></span><span>  </span><span class="annot"><span class="annottext">([DPat], DExp) -&gt; q ([DPat], DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679413166"><span class="hs-identifier hs-var">pats'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var">maybeDLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679413164"><span class="hs-identifier hs-var">name_decs</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679413167"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span class="hs-comment">-- | Desugar a pattern, returning a list of (Name, DExp) pairs of extra</span><span>
</span><span id="line-541"></span><span class="hs-comment">-- variables that must be bound within the scope of the pattern</span><span>
</span><span id="line-542"></span><span id="local-6989586621679413819"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPatX"><span class="hs-identifier hs-type">dsPatX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413819"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413819"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-543"></span><span id="dsPatX"><span class="annot"><span class="annottext">dsPatX :: Pat -&gt; q (DPat, [(Name, DExp)])
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatX"><span class="hs-identifier hs-var hs-var">dsPatX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriterT [(Name, DExp)] q DPat -&gt; q (DPat, [(Name, DExp)])
forall w (m :: * -&gt; *) a. WriterT w m a -&gt; m (a, w)
</span><span class="hs-identifier hs-var hs-var">runWriterT</span></span><span> </span><span class="annot"><span class="annottext">(WriterT [(Name, DExp)] q DPat -&gt; q (DPat, [(Name, DExp)]))
-&gt; (Pat -&gt; WriterT [(Name, DExp)] q DPat)
-&gt; Pat
-&gt; q (DPat, [(Name, DExp)])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; WriterT [(Name, DExp)] q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span class="hs-comment">-- | Desugaring a pattern also returns the list of variables bound in as-patterns</span><span>
</span><span id="line-546"></span><span class="hs-comment">-- and the values they should be bound to. This variables must be brought into</span><span>
</span><span id="line-547"></span><span class="hs-comment">-- scope in the &quot;body&quot; of the pattern.</span><span>
</span><span id="line-548"></span><span class="hs-keyword">type</span><span> </span><span id="PatM"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#PatM"><span class="hs-identifier hs-var">PatM</span></a></span></span><span> </span><span id="local-6989586621679413162"><span class="annot"><a href="#local-6989586621679413162"><span class="hs-identifier hs-type">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679413162"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-549"></span><span>
</span><span id="line-550"></span><span class="hs-comment">-- | Desugar a pattern.</span><span>
</span><span id="line-551"></span><span id="local-6989586621679413891"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-type">dsPat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413891"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#PatM"><span class="hs-identifier hs-type">PatM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413891"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span></span><span>
</span><span id="line-552"></span><span id="dsPat"><span class="annot"><span class="annottext">dsPat :: Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var hs-var">dsPat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LitP</span></span><span> </span><span id="local-6989586621679413160"><span class="annot"><span class="annottext">lit :: Lit
</span><a href="#local-6989586621679413160"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; PatM q DPat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; PatM q DPat) -&gt; DPat -&gt; PatM q DPat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lit -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitP"><span class="hs-identifier hs-var">DLitP</span></a></span><span> </span><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679413160"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-553"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarP</span></span><span> </span><span id="local-6989586621679413158"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679413158"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; PatM q DPat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; PatM q DPat) -&gt; DPat -&gt; PatM q DPat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413158"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-554"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TupP</span></span><span> </span><span id="local-6989586621679413156"><span class="annot"><span class="annottext">pats :: [Pat]
</span><a href="#local-6989586621679413156"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pat] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679413156"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([DPat] -&gt; DPat) -&gt; WriterT [(Name, DExp)] q [DPat] -&gt; PatM q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pat -&gt; PatM q DPat) -&gt; [Pat] -&gt; WriterT [(Name, DExp)] q [DPat]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; PatM q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679413156"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-555"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedTupP</span></span><span> </span><span id="local-6989586621679413154"><span class="annot"><span class="annottext">pats :: [Pat]
</span><a href="#local-6989586621679413154"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">unboxedTupleDataName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pat] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679413154"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([DPat] -&gt; DPat) -&gt; WriterT [(Name, DExp)] q [DPat] -&gt; PatM q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-556"></span><span>                           </span><span class="annot"><span class="annottext">(Pat -&gt; PatM q DPat) -&gt; [Pat] -&gt; WriterT [(Name, DExp)] q [DPat]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; PatM q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679413154"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-557"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConP</span></span><span> </span><span id="local-6989586621679413153"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679413153"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679413152"><span class="annot"><span class="annottext">pats :: [Pat]
</span><a href="#local-6989586621679413152"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413153"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">([DPat] -&gt; DPat) -&gt; WriterT [(Name, DExp)] q [DPat] -&gt; PatM q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pat -&gt; PatM q DPat) -&gt; [Pat] -&gt; WriterT [(Name, DExp)] q [DPat]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; PatM q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679413152"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-558"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixP</span></span><span> </span><span id="local-6989586621679413150"><span class="annot"><span class="annottext">p1 :: Pat
</span><a href="#local-6989586621679413150"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679413149"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679413149"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679413148"><span class="annot"><span class="annottext">p2 :: Pat
</span><a href="#local-6989586621679413148"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413149"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">([DPat] -&gt; DPat) -&gt; WriterT [(Name, DExp)] q [DPat] -&gt; PatM q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Pat -&gt; PatM q DPat) -&gt; [Pat] -&gt; WriterT [(Name, DExp)] q [DPat]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; PatM q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679413150"><span class="hs-identifier hs-var">p1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679413148"><span class="hs-identifier hs-var">p2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-559"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UInfixP</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-560"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; PatM q DPat
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Cannot desugar unresolved infix operators.&quot;</span></span><span>
</span><span id="line-561"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensP</span></span><span> </span><span id="local-6989586621679413145"><span class="annot"><span class="annottext">pat :: Pat
</span><a href="#local-6989586621679413145"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; PatM q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679413145"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-562"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TildeP</span></span><span> </span><span id="local-6989586621679413143"><span class="annot"><span class="annottext">pat :: Pat
</span><a href="#local-6989586621679413143"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTildeP"><span class="hs-identifier hs-var">DTildeP</span></a></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; DPat) -&gt; PatM q DPat -&gt; PatM q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; PatM q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679413143"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-563"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BangP</span></span><span> </span><span id="local-6989586621679413140"><span class="annot"><span class="annottext">pat :: Pat
</span><a href="#local-6989586621679413140"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DBangP"><span class="hs-identifier hs-var">DBangP</span></a></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; DPat) -&gt; PatM q DPat -&gt; PatM q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; PatM q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679413140"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-564"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AsP</span></span><span> </span><span id="local-6989586621679413137"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679413137"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679413136"><span class="annot"><span class="annottext">pat :: Pat
</span><a href="#local-6989586621679413136"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-565"></span><span>  </span><span id="local-6989586621679413135"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413135"><span class="hs-identifier hs-var">pat'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; PatM q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679413136"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-566"></span><span>  </span><span id="local-6989586621679413134"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413134"><span class="hs-identifier hs-var">pat''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">q DPat -&gt; PatM q DPat
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(q DPat -&gt; PatM q DPat) -&gt; q DPat -&gt; PatM q DPat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413135"><span class="hs-identifier hs-var">pat'</span></a></span><span>
</span><span id="line-567"></span><span>  </span><span class="annot"><span class="annottext">[(Name, DExp)] -&gt; WriterT [(Name, DExp)] q ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413137"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413134"><span class="hs-identifier hs-var">pat''</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-568"></span><span>  </span><span class="annot"><span class="annottext">DPat -&gt; PatM q DPat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413134"><span class="hs-identifier hs-var">pat''</span></a></span><span>
</span><span id="line-569"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WildP</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; PatM q DPat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span>
</span><span id="line-570"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecP</span></span><span> </span><span id="local-6989586621679413127"><span class="annot"><span class="annottext">con_name :: Name
</span><a href="#local-6989586621679413127"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679413126"><span class="annot"><span class="annottext">field_pats :: [FieldPat]
</span><a href="#local-6989586621679413126"><span class="hs-identifier hs-var">field_pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-571"></span><span>  </span><span id="local-6989586621679413125"><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679413125"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">q Con -&gt; WriterT [(Name, DExp)] q Con
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(q Con -&gt; WriterT [(Name, DExp)] q Con)
-&gt; q Con -&gt; WriterT [(Name, DExp)] q Con
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Con
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q Con
</span><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToCon"><span class="hs-identifier hs-var">dataConNameToCon</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413127"><span class="hs-identifier hs-var">con_name</span></a></span><span>
</span><span id="line-572"></span><span>  </span><span id="local-6989586621679413124"><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679413124"><span class="hs-identifier hs-var">reordered</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Con -&gt; WriterT [(Name, DExp)] q [DPat]
forall (m :: * -&gt; *).
DsMonad m =&gt;
Con -&gt; WriterT [(Name, DExp)] m [DPat]
</span><a href="#local-6989586621679413123"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679413125"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-573"></span><span>  </span><span class="annot"><span class="annottext">DPat -&gt; PatM q DPat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; PatM q DPat) -&gt; DPat -&gt; PatM q DPat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413127"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679413124"><span class="hs-identifier hs-var">reordered</span></a></span><span>
</span><span id="line-574"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-575"></span><span>    </span><span id="local-6989586621679413123"><span class="annot"><span class="annottext">reorder :: Con -&gt; WriterT [(Name, DExp)] m [DPat]
</span><a href="#local-6989586621679413123"><span class="hs-identifier hs-var hs-var">reorder</span></a></span></span><span> </span><span id="local-6989586621679413122"><span class="annot"><span class="annottext">con :: Con
</span><a href="#local-6989586621679413122"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679413122"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-576"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">NormalC</span></span><span> </span><span id="local-6989586621679413121"><span class="annot"><span class="annottext">_name :: Name
</span><a href="#local-6989586621679413121"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679413120"><span class="annot"><span class="annottext">fields :: [BangType]
</span><a href="#local-6989586621679413120"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BangType] -&gt; WriterT [(Name, DExp)] m [DPat]
forall (t :: * -&gt; *) (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadTrans t, Monad (t m), MonadFail m) =&gt;
t a -&gt; t m [DPat]
</span><a href="#local-6989586621679413119"><span class="hs-identifier hs-var">non_record</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679413120"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-577"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">InfixC</span></span><span> </span><span id="local-6989586621679413118"><span class="annot"><span class="annottext">field1 :: BangType
</span><a href="#local-6989586621679413118"><span class="hs-identifier hs-var">field1</span></a></span></span><span> </span><span id="local-6989586621679413117"><span class="annot"><span class="annottext">_name :: Name
</span><a href="#local-6989586621679413117"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679413116"><span class="annot"><span class="annottext">field2 :: BangType
</span><a href="#local-6989586621679413116"><span class="hs-identifier hs-var">field2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BangType] -&gt; WriterT [(Name, DExp)] m [DPat]
forall (t :: * -&gt; *) (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadTrans t, Monad (t m), MonadFail m) =&gt;
t a -&gt; t m [DPat]
</span><a href="#local-6989586621679413119"><span class="hs-identifier hs-var">non_record</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679413118"><span class="hs-identifier hs-var">field1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679413116"><span class="hs-identifier hs-var">field2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-578"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">RecC</span></span><span> </span><span id="local-6989586621679413115"><span class="annot"><span class="annottext">_name :: Name
</span><a href="#local-6989586621679413115"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679413114"><span class="annot"><span class="annottext">fields :: [VarBangType]
</span><a href="#local-6989586621679413114"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[VarBangType] -&gt; WriterT [(Name, DExp)] m [DPat]
forall (q :: * -&gt; *). DsMonad q =&gt; [VarBangType] -&gt; PatM q [DPat]
</span><a href="#local-6989586621679413113"><span class="hs-identifier hs-var">reorder_fields_pat</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679413114"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-579"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">ForallC</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679413112"><span class="annot"><span class="annottext">c :: Con
</span><a href="#local-6989586621679413112"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Con -&gt; WriterT [(Name, DExp)] m [DPat]
</span><a href="#local-6989586621679413123"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679413112"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">GadtC</span></span><span> </span><span id="local-6989586621679413111"><span class="annot"><span class="annottext">_names :: [Name]
</span><a href="#local-6989586621679413111"><span class="hs-identifier hs-var">_names</span></a></span></span><span> </span><span id="local-6989586621679413110"><span class="annot"><span class="annottext">fields :: [BangType]
</span><a href="#local-6989586621679413110"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679413109"><span class="annot"><span class="annottext">_ret_ty :: Type
</span><a href="#local-6989586621679413109"><span class="hs-identifier hs-var">_ret_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BangType] -&gt; WriterT [(Name, DExp)] m [DPat]
forall (t :: * -&gt; *) (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadTrans t, Monad (t m), MonadFail m) =&gt;
t a -&gt; t m [DPat]
</span><a href="#local-6989586621679413119"><span class="hs-identifier hs-var">non_record</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679413110"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-582"></span><span>                     </span><span class="annot"><span class="hs-identifier hs-type">RecGadtC</span></span><span> </span><span id="local-6989586621679413108"><span class="annot"><span class="annottext">_names :: [Name]
</span><a href="#local-6989586621679413108"><span class="hs-identifier hs-var">_names</span></a></span></span><span> </span><span id="local-6989586621679413107"><span class="annot"><span class="annottext">fields :: [VarBangType]
</span><a href="#local-6989586621679413107"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679413106"><span class="annot"><span class="annottext">_ret_ty :: Type
</span><a href="#local-6989586621679413106"><span class="hs-identifier hs-var">_ret_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[VarBangType] -&gt; WriterT [(Name, DExp)] m [DPat]
forall (q :: * -&gt; *). DsMonad q =&gt; [VarBangType] -&gt; PatM q [DPat]
</span><a href="#local-6989586621679413113"><span class="hs-identifier hs-var">reorder_fields_pat</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679413107"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-585"></span><span>    </span><span id="local-6989586621679413113"><span class="annot"><span class="annottext">reorder_fields_pat :: [VarBangType] -&gt; PatM q [DPat]
</span><a href="#local-6989586621679413113"><span class="hs-identifier hs-var hs-var">reorder_fields_pat</span></a></span></span><span> </span><span id="local-6989586621679413105"><span class="annot"><span class="annottext">fields :: [VarBangType]
</span><a href="#local-6989586621679413105"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [VarBangType] -&gt; [FieldPat] -&gt; PatM q [DPat]
forall (q :: * -&gt; *).
DsMonad q =&gt;
Name -&gt; [VarBangType] -&gt; [FieldPat] -&gt; PatM q [DPat]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFieldsPat"><span class="hs-identifier hs-var">reorderFieldsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413127"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679413105"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldPat]
</span><a href="#local-6989586621679413126"><span class="hs-identifier hs-var">field_pats</span></a></span><span>
</span><span id="line-586"></span><span>
</span><span id="line-587"></span><span>    </span><span id="local-6989586621679413119"><span class="annot"><span class="annottext">non_record :: t a -&gt; t m [DPat]
</span><a href="#local-6989586621679413119"><span class="hs-identifier hs-var hs-var">non_record</span></a></span></span><span> </span><span id="local-6989586621679413103"><span class="annot"><span class="annottext">fields :: t a
</span><a href="#local-6989586621679413103"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[FieldPat] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[FieldPat]
</span><a href="#local-6989586621679413126"><span class="hs-identifier hs-var">field_pats</span></a></span><span>
</span><span id="line-588"></span><span>                        </span><span class="hs-comment">-- Special case: record patterns are allowed for any</span><span>
</span><span id="line-589"></span><span>                        </span><span class="hs-comment">-- constructor, regardless of whether the constructor</span><span>
</span><span id="line-590"></span><span>                        </span><span class="hs-comment">-- actually was declared with records, provided that</span><span>
</span><span id="line-591"></span><span>                        </span><span class="hs-comment">-- no records are given in the pattern itself. (See #59).</span><span>
</span><span id="line-592"></span><span>                        </span><span class="hs-comment">--</span><span>
</span><span id="line-593"></span><span>                        </span><span class="hs-comment">-- Con{} desugars down to Con _ ... _.</span><span>
</span><span id="line-594"></span><span>                      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DPat] -&gt; t m [DPat]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([DPat] -&gt; t m [DPat]) -&gt; [DPat] -&gt; t m [DPat]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; DPat -&gt; [DPat]
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679413103"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span>
</span><span id="line-595"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m [DPat] -&gt; t m [DPat]
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m [DPat] -&gt; t m [DPat]) -&gt; m [DPat] -&gt; t m [DPat]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; m [DPat]
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span>
</span><span id="line-596"></span><span>                                         </span><span class="annot"><span class="annottext">(String -&gt; m [DPat]) -&gt; String -&gt; m [DPat]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Record syntax used with non-record constructor &quot;</span></span><span>
</span><span id="line-597"></span><span>                                           </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413127"><span class="hs-identifier hs-var">con_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ListP</span></span><span> </span><span id="local-6989586621679413101"><span class="annot"><span class="annottext">pats :: [Pat]
</span><a href="#local-6989586621679413101"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; PatM q DPat
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Pat] -&gt; WriterT [(Name, DExp)] q DPat
</span><a href="#local-6989586621679413100"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679413101"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-600"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679413100"><span class="annot"><span class="annottext">go :: [Pat] -&gt; WriterT [(Name, DExp)] q DPat
</span><a href="#local-6989586621679413100"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; WriterT [(Name, DExp)] q DPat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; WriterT [(Name, DExp)] q DPat)
-&gt; DPat -&gt; WriterT [(Name, DExp)] q DPat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-601"></span><span>        </span><span class="annot"><a href="#local-6989586621679413100"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679413099"><span class="annot"><span class="annottext">h :: Pat
</span><a href="#local-6989586621679413099"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679413098"><span class="annot"><span class="annottext">t :: [Pat]
</span><a href="#local-6989586621679413098"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-602"></span><span>          </span><span id="local-6989586621679413097"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413097"><span class="hs-identifier hs-var">h'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; WriterT [(Name, DExp)] q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679413099"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-603"></span><span>          </span><span id="local-6989586621679413096"><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413096"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; WriterT [(Name, DExp)] q DPat
</span><a href="#local-6989586621679413100"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679413098"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-604"></span><span>          </span><span class="annot"><span class="annottext">DPat -&gt; WriterT [(Name, DExp)] q DPat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; WriterT [(Name, DExp)] q DPat)
-&gt; DPat -&gt; WriterT [(Name, DExp)] q DPat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413097"><span class="hs-identifier hs-var">h'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413096"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-605"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigP</span></span><span> </span><span id="local-6989586621679413094"><span class="annot"><span class="annottext">pat :: Pat
</span><a href="#local-6989586621679413094"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679413093"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679413093"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DType -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigP"><span class="hs-identifier hs-var">DSigP</span></a></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; DType -&gt; DPat)
-&gt; PatM q DPat -&gt; WriterT [(Name, DExp)] q (DType -&gt; DPat)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; PatM q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679413094"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">WriterT [(Name, DExp)] q (DType -&gt; DPat)
-&gt; WriterT [(Name, DExp)] q DType -&gt; PatM q DPat
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; WriterT [(Name, DExp)] q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679413093"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedSumP</span></span><span> </span><span id="local-6989586621679413090"><span class="annot"><span class="annottext">pat :: Pat
</span><a href="#local-6989586621679413090"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679413089"><span class="annot"><span class="annottext">alt :: Int
</span><a href="#local-6989586621679413089"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621679413088"><span class="annot"><span class="annottext">arity :: Int
</span><a href="#local-6989586621679413088"><span class="hs-identifier hs-var">arity</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-608"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Name
</span><span class="hs-identifier hs-var">unboxedSumDataName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679413089"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679413088"><span class="hs-identifier hs-var">arity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([DPat] -&gt; DPat) -&gt; WriterT [(Name, DExp)] q [DPat] -&gt; PatM q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; [DPat] -&gt; [DPat]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; [DPat]) -&gt; PatM q DPat -&gt; WriterT [(Name, DExp)] q [DPat]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; PatM q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679413090"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ViewP</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-611"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; PatM q DPat
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;View patterns are not supported in th-desugar. Use pattern guards instead.&quot;</span></span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span class="hs-comment">-- | Convert a 'DPat' to a 'DExp'. Fails on 'DWildP'.</span><span>
</span><span id="line-614"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-type">dPatToDExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-615"></span><span id="dPatToDExp"><span class="annot"><span class="annottext">dPatToDExp :: DPat -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var hs-var">dPatToDExp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLitP"><span class="hs-identifier hs-type">DLitP</span></a></span><span> </span><span id="local-6989586621679413086"><span class="annot"><span class="annottext">lit :: Lit
</span><a href="#local-6989586621679413086"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span> </span><span class="annot"><span class="annottext">Lit
</span><a href="#local-6989586621679413086"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-616"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-type">DVarP</span></a></span><span> </span><span id="local-6989586621679413085"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679413085"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413085"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-617"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-type">DConP</span></a></span><span> </span><span id="local-6989586621679413084"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679413084"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679413083"><span class="annot"><span class="annottext">pats :: [DPat]
</span><a href="#local-6989586621679413083"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; DExp -&gt; [DExp] -&gt; DExp
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413084"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DPat -&gt; DExp) -&gt; [DPat] -&gt; [DExp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679413083"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-618"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTildeP"><span class="hs-identifier hs-type">DTildeP</span></a></span><span> </span><span id="local-6989586621679413082"><span class="annot"><span class="annottext">pat :: DPat
</span><a href="#local-6989586621679413082"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413082"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-619"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DBangP"><span class="hs-identifier hs-type">DBangP</span></a></span><span> </span><span id="local-6989586621679413081"><span class="annot"><span class="annottext">pat :: DPat
</span><a href="#local-6989586621679413081"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413081"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-620"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigP"><span class="hs-identifier hs-type">DSigP</span></a></span><span> </span><span id="local-6989586621679413080"><span class="annot"><span class="annottext">pat :: DPat
</span><a href="#local-6989586621679413080"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679413079"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679413079"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DType -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigE"><span class="hs-identifier hs-var">DSigE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413080"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679413079"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-621"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dPatToDExp"><span class="hs-identifier hs-var">dPatToDExp</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-type">DWildP</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; DExp
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Internal error in th-desugar: wildcard in rhs of as-pattern&quot;</span></span><span>
</span><span id="line-622"></span><span>
</span><span id="line-623"></span><span class="hs-comment">-- | Remove all wildcards from a pattern, replacing any wildcard with a fresh</span><span>
</span><span id="line-624"></span><span class="hs-comment">--   variable</span><span>
</span><span id="line-625"></span><span id="local-6989586621679413874"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-type">removeWilds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413874"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413874"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span></span><span>
</span><span id="line-626"></span><span id="removeWilds"><span class="annot"><span class="annottext">removeWilds :: DPat -&gt; q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var hs-var">removeWilds</span></a></span></span><span> </span><span id="local-6989586621679413077"><span class="annot"><span class="annottext">p :: DPat
</span><a href="#local-6989586621679413077"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLitP"><span class="hs-identifier hs-type">DLitP</span></a></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q DPat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413077"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-627"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span id="local-6989586621679413076"><span class="annot"><span class="annottext">p :: DPat
</span><a href="#local-6989586621679413076"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-type">DVarP</span></a></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q DPat
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413076"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-628"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-type">DConP</span></a></span><span> </span><span id="local-6989586621679413075"><span class="annot"><span class="annottext">con_name :: Name
</span><a href="#local-6989586621679413075"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679413074"><span class="annot"><span class="annottext">pats :: [DPat]
</span><a href="#local-6989586621679413074"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413075"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">([DPat] -&gt; DPat) -&gt; q [DPat] -&gt; q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; q DPat) -&gt; [DPat] -&gt; q [DPat]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679413074"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-629"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTildeP"><span class="hs-identifier hs-type">DTildeP</span></a></span><span> </span><span id="local-6989586621679413073"><span class="annot"><span class="annottext">pat :: DPat
</span><a href="#local-6989586621679413073"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTildeP"><span class="hs-identifier hs-var">DTildeP</span></a></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; DPat) -&gt; q DPat -&gt; q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413073"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-630"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DBangP"><span class="hs-identifier hs-type">DBangP</span></a></span><span> </span><span id="local-6989586621679413072"><span class="annot"><span class="annottext">pat :: DPat
</span><a href="#local-6989586621679413072"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DBangP"><span class="hs-identifier hs-var">DBangP</span></a></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; DPat) -&gt; q DPat -&gt; q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413072"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-631"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigP"><span class="hs-identifier hs-type">DSigP</span></a></span><span> </span><span id="local-6989586621679413071"><span class="annot"><span class="annottext">pat :: DPat
</span><a href="#local-6989586621679413071"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679413070"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679413070"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DType -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigP"><span class="hs-identifier hs-var">DSigP</span></a></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; DType -&gt; DPat) -&gt; q DPat -&gt; q (DType -&gt; DPat)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679413071"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DPat) -&gt; q DType -&gt; q DPat
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679413070"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-632"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#removeWilds"><span class="hs-identifier hs-var">removeWilds</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-type">DWildP</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; DPat) -&gt; q Name -&gt; q DPat
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;wild&quot;</span></span><span>
</span><span id="line-633"></span><span>
</span><span id="line-634"></span><span class="hs-comment">-- | Desugar @Info@</span><span>
</span><span id="line-635"></span><span id="local-6989586621679413718"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-type">dsInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413718"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Info</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413718"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DInfo"><span class="hs-identifier hs-type">DInfo</span></a></span></span><span>
</span><span id="line-636"></span><span id="dsInfo"><span class="annot"><span class="annottext">dsInfo :: Info -&gt; q DInfo
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var hs-var">dsInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClassI</span></span><span> </span><span id="local-6989586621679413067"><span class="annot"><span class="annottext">dec :: Dec
</span><a href="#local-6989586621679413067"><span class="hs-identifier hs-var">dec</span></a></span></span><span> </span><span id="local-6989586621679413066"><span class="annot"><span class="annottext">instances :: [Dec]
</span><a href="#local-6989586621679413066"><span class="hs-identifier hs-var">instances</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-637"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679413065"><span class="annot"><span class="annottext">ddec :: DDec
</span><a href="#local-6989586621679413065"><span class="hs-identifier hs-var">ddec</span></a></span></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679413067"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-638"></span><span>  </span><span id="local-6989586621679413063"><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679413063"><span class="hs-identifier hs-var">dinstances</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; [Dec] -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDecs"><span class="hs-identifier hs-var">dsDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679413066"><span class="hs-identifier hs-var">instances</span></a></span><span>
</span><span id="line-639"></span><span>  </span><span class="annot"><span class="annottext">DInfo -&gt; q DInfo
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DInfo -&gt; q DInfo) -&gt; DInfo -&gt; q DInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DDec -&gt; Maybe [DDec] -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTyConI"><span class="hs-identifier hs-var">DTyConI</span></a></span><span> </span><span class="annot"><span class="annottext">DDec
</span><a href="#local-6989586621679413065"><span class="hs-identifier hs-var">ddec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DDec] -&gt; Maybe [DDec]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679413063"><span class="hs-identifier hs-var">dinstances</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClassOpI</span></span><span> </span><span id="local-6989586621679413059"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679413059"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679413058"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679413058"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679413057"><span class="annot"><span class="annottext">parent :: Name
</span><a href="#local-6989586621679413057"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsInfo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ClassOpI</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">parent</span><span> </span><span class="hs-identifier">_fixity</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#endif
</span><span>  </span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; Maybe Name -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarI"><span class="hs-identifier hs-var">DVarI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413059"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; Maybe Name -&gt; DInfo)
-&gt; q DType -&gt; q (Maybe Name -&gt; DInfo)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679413058"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">q (Maybe Name -&gt; DInfo) -&gt; q (Maybe Name) -&gt; q DInfo
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Name -&gt; q (Maybe Name)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413057"><span class="hs-identifier hs-var">parent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-646"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TyConI</span></span><span> </span><span id="local-6989586621679413054"><span class="annot"><span class="annottext">dec :: Dec
</span><a href="#local-6989586621679413054"><span class="hs-identifier hs-var">dec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-647"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679413053"><span class="annot"><span class="annottext">ddec :: DDec
</span><a href="#local-6989586621679413053"><span class="hs-identifier hs-var">ddec</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679413054"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-648"></span><span>  </span><span class="annot"><span class="annottext">DInfo -&gt; q DInfo
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DInfo -&gt; q DInfo) -&gt; DInfo -&gt; q DInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DDec -&gt; Maybe [DDec] -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTyConI"><span class="hs-identifier hs-var">DTyConI</span></a></span><span> </span><span class="annot"><span class="annottext">DDec
</span><a href="#local-6989586621679413053"><span class="hs-identifier hs-var">ddec</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [DDec]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-649"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FamilyI</span></span><span> </span><span id="local-6989586621679413051"><span class="annot"><span class="annottext">dec :: Dec
</span><a href="#local-6989586621679413051"><span class="hs-identifier hs-var">dec</span></a></span></span><span> </span><span id="local-6989586621679413050"><span class="annot"><span class="annottext">instances :: [Dec]
</span><a href="#local-6989586621679413050"><span class="hs-identifier hs-var">instances</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-650"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679413049"><span class="annot"><span class="annottext">ddec :: DDec
</span><a href="#local-6989586621679413049"><span class="hs-identifier hs-var">ddec</span></a></span></span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679413051"><span class="hs-identifier hs-var">dec</span></a></span><span>
</span><span id="line-651"></span><span>  </span><span id="local-6989586621679413048"><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679413048"><span class="hs-identifier hs-var">dinstances</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; [Dec] -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDecs"><span class="hs-identifier hs-var">dsDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679413050"><span class="hs-identifier hs-var">instances</span></a></span><span>
</span><span id="line-652"></span><span>  </span><span class="annot"><span class="annottext">DInfo -&gt; q DInfo
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DInfo -&gt; q DInfo) -&gt; DInfo -&gt; q DInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DDec -&gt; Maybe [DDec] -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTyConI"><span class="hs-identifier hs-var">DTyConI</span></a></span><span> </span><span class="annot"><span class="annottext">DDec
</span><a href="#local-6989586621679413049"><span class="hs-identifier hs-var">ddec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DDec] -&gt; Maybe [DDec]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[DDec]
</span><a href="#local-6989586621679413048"><span class="hs-identifier hs-var">dinstances</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-653"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrimTyConI</span></span><span> </span><span id="local-6989586621679413046"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679413046"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679413045"><span class="annot"><span class="annottext">arity :: Int
</span><a href="#local-6989586621679413045"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span id="local-6989586621679413044"><span class="annot"><span class="annottext">unlifted :: Bool
</span><a href="#local-6989586621679413044"><span class="hs-identifier hs-var">unlifted</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-654"></span><span>  </span><span class="annot"><span class="annottext">DInfo -&gt; q DInfo
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DInfo -&gt; q DInfo) -&gt; DInfo -&gt; q DInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Int -&gt; Bool -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPrimTyConI"><span class="hs-identifier hs-var">DPrimTyConI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413046"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679413045"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679413044"><span class="hs-identifier hs-var">unlifted</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DataConI</span></span><span> </span><span id="local-6989586621679413041"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679413041"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679413040"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679413040"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679413039"><span class="annot"><span class="annottext">parent :: Name
</span><a href="#local-6989586621679413039"><span class="hs-identifier hs-var">parent</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-657"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; Maybe Name -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarI"><span class="hs-identifier hs-var">DVarI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413041"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; Maybe Name -&gt; DInfo)
-&gt; q DType -&gt; q (Maybe Name -&gt; DInfo)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679413040"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">q (Maybe Name -&gt; DInfo) -&gt; q (Maybe Name) -&gt; q DInfo
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Name -&gt; q (Maybe Name)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413039"><span class="hs-identifier hs-var">parent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-658"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarI</span></span><span> </span><span id="local-6989586621679413038"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679413038"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679413037"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679413037"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-659"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; Maybe Name -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarI"><span class="hs-identifier hs-var">DVarI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413038"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; Maybe Name -&gt; DInfo)
-&gt; q DType -&gt; q (Maybe Name -&gt; DInfo)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679413037"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">q (Maybe Name -&gt; DInfo) -&gt; q (Maybe Name) -&gt; q DInfo
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Name -&gt; q (Maybe Name)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-660"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarI</span></span><span> </span><span id="local-6989586621679413036"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679413036"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-661"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; q DInfo
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q DInfo) -&gt; String -&gt; q DInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Declaration supplied with variable: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413036"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsInfo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DataConI</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">parent</span><span> </span><span class="hs-identifier">_fixity</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-664"></span><span>  </span><span class="hs-identifier">DVarI</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">parent</span><span class="hs-special">)</span><span>
</span><span id="line-665"></span><span class="hs-identifier">dsInfo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">VarI</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">_fixity</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-666"></span><span>  </span><span class="hs-identifier">DVarI</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-667"></span><span class="hs-identifier">dsInfo</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">VarI</span><span> </span><span class="hs-identifier">name</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-668"></span><span>  </span><span class="hs-identifier">impossible</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-string">&quot;Declaration supplied with variable: &quot;</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">name</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TyVarI</span></span><span> </span><span id="local-6989586621679413034"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679413034"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679413033"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679413033"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarI"><span class="hs-identifier hs-var">DTyVarI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413034"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DInfo) -&gt; q DType -&gt; q DInfo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679413033"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PatSynI</span></span><span> </span><span id="local-6989586621679413030"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679413030"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679413029"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679413029"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; DInfo
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPatSynI"><span class="hs-identifier hs-var">DPatSynI</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413030"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DInfo) -&gt; q DType -&gt; q DInfo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679413029"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-675"></span><span class="hs-comment">-- | Desugar arbitrary @Dec@s</span><span>
</span><span id="line-676"></span><span id="local-6989586621679413853"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDecs"><span class="hs-identifier hs-type">dsDecs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413853"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413853"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-677"></span><span id="dsDecs"><span class="annot"><span class="annottext">dsDecs :: [Dec] -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDecs"><span class="hs-identifier hs-var hs-var">dsDecs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; q [DDec]) -&gt; [Dec] -&gt; q [DDec]
forall (monad :: * -&gt; *) monoid (t :: * -&gt; *) a.
(Monad monad, Monoid monoid, Traversable t) =&gt;
(a -&gt; monad monoid) -&gt; t a -&gt; monad monoid
</span><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span>
</span><span id="line-678"></span><span>
</span><span id="line-679"></span><span class="hs-comment">-- | Desugar a single @Dec@, perhaps producing multiple 'DDec's</span><span>
</span><span id="line-680"></span><span id="local-6989586621679413854"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-type">dsDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413854"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413854"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-681"></span><span id="dsDec"><span class="annot"><span class="annottext">dsDec :: Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var hs-var">dsDec</span></a></span></span><span> </span><span id="local-6989586621679413026"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679413026"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FunD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-var">dsTopLevelLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679413026"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-682"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span id="local-6989586621679413023"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679413023"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ValD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-var">dsTopLevelLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679413023"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DataD</span></span><span> </span><span id="local-6989586621679413020"><span class="annot"><span class="annottext">cxt :: Cxt
</span><a href="#local-6989586621679413020"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679413019"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679413019"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679413018"><span class="annot"><span class="annottext">tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679413018"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679413017"><span class="annot"><span class="annottext">mk :: Maybe Type
</span><a href="#local-6989586621679413017"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679413016"><span class="annot"><span class="annottext">cons :: [Con]
</span><a href="#local-6989586621679413016"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679413015"><span class="annot"><span class="annottext">derivings :: [DerivClause]
</span><a href="#local-6989586621679413015"><span class="hs-identifier hs-var">derivings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-685"></span><span>  </span><span class="annot"><span class="annottext">NewOrData
-&gt; Cxt
-&gt; Name
-&gt; [TyVarBndr]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
forall (q :: * -&gt; *).
DsMonad q =&gt;
NewOrData
-&gt; Cxt
-&gt; Name
-&gt; [TyVarBndr]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDataDec"><span class="hs-identifier hs-var">dsDataDec</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="Language.Haskell.TH.Desugar.AST.html#Data"><span class="hs-identifier hs-var">Data</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679413020"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413019"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679413018"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679413017"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679413016"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679413015"><span class="hs-identifier hs-var">derivings</span></a></span><span>
</span><span id="line-686"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NewtypeD</span></span><span> </span><span id="local-6989586621679413011"><span class="annot"><span class="annottext">cxt :: Cxt
</span><a href="#local-6989586621679413011"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679413010"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679413010"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679413009"><span class="annot"><span class="annottext">tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679413009"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679413008"><span class="annot"><span class="annottext">mk :: Maybe Type
</span><a href="#local-6989586621679413008"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679413007"><span class="annot"><span class="annottext">con :: Con
</span><a href="#local-6989586621679413007"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621679413006"><span class="annot"><span class="annottext">derivings :: [DerivClause]
</span><a href="#local-6989586621679413006"><span class="hs-identifier hs-var">derivings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-687"></span><span>  </span><span class="annot"><span class="annottext">NewOrData
-&gt; Cxt
-&gt; Name
-&gt; [TyVarBndr]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
forall (q :: * -&gt; *).
DsMonad q =&gt;
NewOrData
-&gt; Cxt
-&gt; Name
-&gt; [TyVarBndr]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDataDec"><span class="hs-identifier hs-var">dsDataDec</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="Language.Haskell.TH.Desugar.AST.html#Newtype"><span class="hs-identifier hs-var">Newtype</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679413011"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413010"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679413009"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679413008"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679413007"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679413006"><span class="hs-identifier hs-var">derivings</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DataD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-690"></span><span>  </span><span class="hs-identifier">dsDataDec</span><span> </span><span class="hs-identifier">Data</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">derivings</span><span>
</span><span id="line-691"></span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NewtypeD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-692"></span><span>  </span><span class="hs-identifier">dsDataDec</span><span> </span><span class="hs-identifier">Newtype</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">con</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TySynD</span></span><span> </span><span id="local-6989586621679413003"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679413003"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679413002"><span class="annot"><span class="annottext">tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679413002"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679413001"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679413001"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-695"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [DTyVarBndr] -&gt; DType -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTySynD"><span class="hs-identifier hs-var">DTySynD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679413003"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">([DTyVarBndr] -&gt; DType -&gt; DDec)
-&gt; q [DTyVarBndr] -&gt; q (DType -&gt; DDec)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679413002"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DDec) -&gt; q DType -&gt; q DDec
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679413001"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-696"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClassD</span></span><span> </span><span id="local-6989586621679412997"><span class="annot"><span class="annottext">cxt :: Cxt
</span><a href="#local-6989586621679412997"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679412996"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412996"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412995"><span class="annot"><span class="annottext">tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679412995"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679412994"><span class="annot"><span class="annottext">fds :: [FunDep]
</span><a href="#local-6989586621679412994"><span class="hs-identifier hs-var">fds</span></a></span></span><span> </span><span id="local-6989586621679412993"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679412993"><span class="hs-identifier hs-var">decs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-697"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DCxt -&gt; Name -&gt; [DTyVarBndr] -&gt; [FunDep] -&gt; [DDec] -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DClassD"><span class="hs-identifier hs-var">DClassD</span></a></span><span> </span><span class="annot"><span class="annottext">(DCxt -&gt; Name -&gt; [DTyVarBndr] -&gt; [FunDep] -&gt; [DDec] -&gt; DDec)
-&gt; q DCxt -&gt; q (Name -&gt; [DTyVarBndr] -&gt; [FunDep] -&gt; [DDec] -&gt; DDec)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Cxt -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679412997"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">q (Name -&gt; [DTyVarBndr] -&gt; [FunDep] -&gt; [DDec] -&gt; DDec)
-&gt; q Name -&gt; q ([DTyVarBndr] -&gt; [FunDep] -&gt; [DDec] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Name
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412996"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">q ([DTyVarBndr] -&gt; [FunDep] -&gt; [DDec] -&gt; DDec)
-&gt; q [DTyVarBndr] -&gt; q ([FunDep] -&gt; [DDec] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679412995"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-698"></span><span>                     </span><span class="annot"><span class="annottext">q ([FunDep] -&gt; [DDec] -&gt; DDec) -&gt; q [FunDep] -&gt; q ([DDec] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[FunDep] -&gt; q [FunDep]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[FunDep]
</span><a href="#local-6989586621679412994"><span class="hs-identifier hs-var">fds</span></a></span><span> </span><span class="annot"><span class="annottext">q ([DDec] -&gt; DDec) -&gt; q [DDec] -&gt; q DDec
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; [Dec] -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDecs"><span class="hs-identifier hs-var">dsDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679412993"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 711
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InstanceD</span></span><span> </span><span id="local-6989586621679412989"><span class="annot"><span class="annottext">over :: Maybe Overlap
</span><a href="#local-6989586621679412989"><span class="hs-identifier hs-var">over</span></a></span></span><span> </span><span id="local-6989586621679412988"><span class="annot"><span class="annottext">cxt :: Cxt
</span><a href="#local-6989586621679412988"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679412987"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679412987"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679412986"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679412986"><span class="hs-identifier hs-var">decs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-701"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Overlap
-&gt; Maybe [DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; [DDec] -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DInstanceD"><span class="hs-identifier hs-var">DInstanceD</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Overlap
</span><a href="#local-6989586621679412989"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">(DCxt -&gt; DType -&gt; [DDec] -&gt; DDec)
-&gt; q DCxt -&gt; q (DType -&gt; [DDec] -&gt; DDec)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Cxt -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679412988"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; [DDec] -&gt; DDec) -&gt; q DType -&gt; q ([DDec] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412987"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">q ([DDec] -&gt; DDec) -&gt; q [DDec] -&gt; q DDec
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; [Dec] -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDecs"><span class="hs-identifier hs-var">dsDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679412986"><span class="hs-identifier hs-var">decs</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">InstanceD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-identifier">decs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-704"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DInstanceD</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsCxt</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">ty</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">dsDecs</span><span> </span><span class="hs-identifier">decs</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span id="local-6989586621679412984"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679412984"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-var">dsTopLevelLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679412984"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-707"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignD</span></span><span> </span><span id="local-6989586621679412981"><span class="annot"><span class="annottext">f :: Foreign
</span><a href="#local-6989586621679412981"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DForeign -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DForeignD"><span class="hs-identifier hs-var">DForeignD</span></a></span><span> </span><span class="annot"><span class="annottext">(DForeign -&gt; DDec) -&gt; q DForeign -&gt; q DDec
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Foreign -&gt; q DForeign
forall (q :: * -&gt; *). DsMonad q =&gt; Foreign -&gt; q DForeign
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsForeign"><span class="hs-identifier hs-var">dsForeign</span></a></span><span> </span><span class="annot"><span class="annottext">Foreign
</span><a href="#local-6989586621679412981"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-708"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span id="local-6989586621679412978"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679412978"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-var">dsTopLevelLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679412978"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-709"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span id="local-6989586621679412976"><span class="annot"><span class="annottext">d :: Dec
</span><a href="#local-6989586621679412976"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PragmaD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q [DDec]
forall (q :: * -&gt; *). DsMonad q =&gt; Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-var">dsTopLevelLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">Dec
</span><a href="#local-6989586621679412976"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OpenTypeFamilyD</span></span><span> </span><span id="local-6989586621679412973"><span class="annot"><span class="annottext">tfHead :: TypeFamilyHead
</span><a href="#local-6989586621679412973"><span class="hs-identifier hs-var">tfHead</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-712"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DTypeFamilyHead -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DOpenTypeFamilyD"><span class="hs-identifier hs-var">DOpenTypeFamilyD</span></a></span><span> </span><span class="annot"><span class="annottext">(DTypeFamilyHead -&gt; DDec) -&gt; q DTypeFamilyHead -&gt; q DDec
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TypeFamilyHead -&gt; q DTypeFamilyHead
forall (q :: * -&gt; *).
DsMonad q =&gt;
TypeFamilyHead -&gt; q DTypeFamilyHead
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeFamilyHead"><span class="hs-identifier hs-var">dsTypeFamilyHead</span></a></span><span> </span><span class="annot"><span class="annottext">TypeFamilyHead
</span><a href="#local-6989586621679412973"><span class="hs-identifier hs-var">tfHead</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-713"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DataFamilyD</span></span><span> </span><span id="local-6989586621679412969"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412969"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412968"><span class="annot"><span class="annottext">tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679412968"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679412967"><span class="annot"><span class="annottext">m_k :: Maybe Type
</span><a href="#local-6989586621679412967"><span class="hs-identifier hs-var">m_k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-714"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [DTyVarBndr] -&gt; Maybe DType -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DDataFamilyD"><span class="hs-identifier hs-var">DDataFamilyD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412969"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">([DTyVarBndr] -&gt; Maybe DType -&gt; DDec)
-&gt; q [DTyVarBndr] -&gt; q (Maybe DType -&gt; DDec)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679412968"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">q (Maybe DType -&gt; DDec) -&gt; q (Maybe DType) -&gt; q DDec
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; q DType) -&gt; Maybe Type -&gt; q (Maybe DType)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679412967"><span class="hs-identifier hs-var">m_k</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FamilyD</span><span> </span><span class="hs-identifier">TypeFam</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">m_k</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-717"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DOpenTypeFamilyD</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsTypeFamilyHead</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">m_k</span><span class="hs-special">)</span><span>
</span><span id="line-718"></span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">FamilyD</span><span> </span><span class="hs-identifier">DataFam</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">m_k</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-719"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DDataFamilyD</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsTvb</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">m_k</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DataInstD</span></span><span> </span><span id="local-6989586621679412964"><span class="annot"><span class="annottext">cxt :: Cxt
</span><a href="#local-6989586621679412964"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679412963"><span class="annot"><span class="annottext">mtvbs :: Maybe [TyVarBndr]
</span><a href="#local-6989586621679412963"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679412962"><span class="annot"><span class="annottext">lhs :: Type
</span><a href="#local-6989586621679412962"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679412961"><span class="annot"><span class="annottext">mk :: Maybe Type
</span><a href="#local-6989586621679412961"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679412960"><span class="annot"><span class="annottext">cons :: [Con]
</span><a href="#local-6989586621679412960"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679412959"><span class="annot"><span class="annottext">derivings :: [DerivClause]
</span><a href="#local-6989586621679412959"><span class="hs-identifier hs-var">derivings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-723"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (Type, [TypeArg])
</span><a href="Language.Haskell.TH.Desugar.Util.html#unfoldType"><span class="hs-identifier hs-var">unfoldType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412962"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-724"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679412957"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412957"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412956"><span class="annot"><span class="annottext">tys :: [TypeArg]
</span><a href="#local-6989586621679412956"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NewOrData
-&gt; Cxt
-&gt; Name
-&gt; Maybe [TyVarBndr]
-&gt; [TypeArg]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
forall (q :: * -&gt; *).
DsMonad q =&gt;
NewOrData
-&gt; Cxt
-&gt; Name
-&gt; Maybe [TyVarBndr]
-&gt; [TypeArg]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDataInstDec"><span class="hs-identifier hs-var">dsDataInstDec</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="Language.Haskell.TH.Desugar.AST.html#Data"><span class="hs-identifier hs-var">Data</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679412964"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412957"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndr]
</span><a href="#local-6989586621679412963"><span class="hs-identifier hs-var">mtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679412956"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679412961"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679412960"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679412959"><span class="hs-identifier hs-var">derivings</span></a></span><span>
</span><span id="line-725"></span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; q [DDec]
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q [DDec]) -&gt; String -&gt; q [DDec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Unexpected data instance LHS: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Ppr a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">pprint</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412962"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-726"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NewtypeInstD</span></span><span> </span><span id="local-6989586621679412952"><span class="annot"><span class="annottext">cxt :: Cxt
</span><a href="#local-6989586621679412952"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679412951"><span class="annot"><span class="annottext">mtvbs :: Maybe [TyVarBndr]
</span><a href="#local-6989586621679412951"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679412950"><span class="annot"><span class="annottext">lhs :: Type
</span><a href="#local-6989586621679412950"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679412949"><span class="annot"><span class="annottext">mk :: Maybe Type
</span><a href="#local-6989586621679412949"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679412948"><span class="annot"><span class="annottext">con :: Con
</span><a href="#local-6989586621679412948"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span id="local-6989586621679412947"><span class="annot"><span class="annottext">derivings :: [DerivClause]
</span><a href="#local-6989586621679412947"><span class="hs-identifier hs-var">derivings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-727"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; (Type, [TypeArg])
</span><a href="Language.Haskell.TH.Desugar.Util.html#unfoldType"><span class="hs-identifier hs-var">unfoldType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412950"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-728"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679412946"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412946"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412945"><span class="annot"><span class="annottext">tys :: [TypeArg]
</span><a href="#local-6989586621679412945"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NewOrData
-&gt; Cxt
-&gt; Name
-&gt; Maybe [TyVarBndr]
-&gt; [TypeArg]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
forall (q :: * -&gt; *).
DsMonad q =&gt;
NewOrData
-&gt; Cxt
-&gt; Name
-&gt; Maybe [TyVarBndr]
-&gt; [TypeArg]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDataInstDec"><span class="hs-identifier hs-var">dsDataInstDec</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="Language.Haskell.TH.Desugar.AST.html#Newtype"><span class="hs-identifier hs-var">Newtype</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679412952"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412946"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndr]
</span><a href="#local-6989586621679412951"><span class="hs-identifier hs-var">mtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679412945"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679412949"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679412948"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679412947"><span class="hs-identifier hs-var">derivings</span></a></span><span>
</span><span id="line-729"></span><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; q [DDec]
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q [DDec]) -&gt; String -&gt; q [DDec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Unexpected newtype instance LHS: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Ppr a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">pprint</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412950"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-cpp">
#elif __GLASGOW_HASKELL__ &gt; 710
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DataInstD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-identifier">mk</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-732"></span><span>  </span><span class="hs-identifier">dsDataInstDec</span><span> </span><span class="hs-identifier">Data</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">TANormal</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mk</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">derivings</span><span>
</span><span id="line-733"></span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NewtypeInstD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-identifier">mk</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-734"></span><span>  </span><span class="hs-identifier">dsDataInstDec</span><span> </span><span class="hs-identifier">Newtype</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">TANormal</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">mk</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">con</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DataInstD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-737"></span><span>  </span><span class="hs-identifier">dsDataInstDec</span><span> </span><span class="hs-identifier">Data</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">TANormal</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">cons</span><span> </span><span class="hs-identifier">derivings</span><span>
</span><span id="line-738"></span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NewtypeInstD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tys</span><span> </span><span class="hs-identifier">con</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-739"></span><span>  </span><span class="hs-identifier">dsDataInstDec</span><span> </span><span class="hs-identifier">Newtype</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">TANormal</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">con</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">derivings</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TySynInstD</span></span><span> </span><span id="local-6989586621679412943"><span class="annot"><span class="annottext">eqn :: TySynEqn
</span><a href="#local-6989586621679412943"><span class="hs-identifier hs-var">eqn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DTySynEqn -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTySynInstD"><span class="hs-identifier hs-var">DTySynInstD</span></a></span><span> </span><span class="annot"><span class="annottext">(DTySynEqn -&gt; DDec) -&gt; q DTySynEqn -&gt; q DDec
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; TySynEqn -&gt; q DTySynEqn
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; TySynEqn -&gt; q DTySynEqn
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTySynEqn"><span class="hs-identifier hs-var">dsTySynEqn</span></a></span><span> </span><span class="annot"><span class="annottext">Name
forall a. a
</span><a href="Language.Haskell.TH.Desugar.Core.html#unusedArgument"><span class="hs-identifier hs-var">unusedArgument</span></a></span><span> </span><span class="annot"><span class="annottext">TySynEqn
</span><a href="#local-6989586621679412943"><span class="hs-identifier hs-var">eqn</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">TySynInstD</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">eqn</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DTySynInstD</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsTySynEqn</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">eqn</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ClosedTypeFamilyD</span></span><span> </span><span id="local-6989586621679412938"><span class="annot"><span class="annottext">tfHead :: TypeFamilyHead
</span><a href="#local-6989586621679412938"><span class="hs-identifier hs-var">tfHead</span></a></span></span><span> </span><span id="local-6989586621679412937"><span class="annot"><span class="annottext">eqns :: [TySynEqn]
</span><a href="#local-6989586621679412937"><span class="hs-identifier hs-var">eqns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-748"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DTypeFamilyHead -&gt; [DTySynEqn] -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DClosedTypeFamilyD"><span class="hs-identifier hs-var">DClosedTypeFamilyD</span></a></span><span> </span><span class="annot"><span class="annottext">(DTypeFamilyHead -&gt; [DTySynEqn] -&gt; DDec)
-&gt; q DTypeFamilyHead -&gt; q ([DTySynEqn] -&gt; DDec)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TypeFamilyHead -&gt; q DTypeFamilyHead
forall (q :: * -&gt; *).
DsMonad q =&gt;
TypeFamilyHead -&gt; q DTypeFamilyHead
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeFamilyHead"><span class="hs-identifier hs-var">dsTypeFamilyHead</span></a></span><span> </span><span class="annot"><span class="annottext">TypeFamilyHead
</span><a href="#local-6989586621679412938"><span class="hs-identifier hs-var">tfHead</span></a></span><span>
</span><span id="line-749"></span><span>                                </span><span class="annot"><span class="annottext">q ([DTySynEqn] -&gt; DDec) -&gt; q [DTySynEqn] -&gt; q DDec
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TySynEqn -&gt; q DTySynEqn) -&gt; [TySynEqn] -&gt; q [DTySynEqn]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; TySynEqn -&gt; q DTySynEqn
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; TySynEqn -&gt; q DTySynEqn
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTySynEqn"><span class="hs-identifier hs-var">dsTySynEqn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeFamilyHead -&gt; Name
</span><a href="Language.Haskell.TH.Desugar.Core.html#typeFamilyHeadName"><span class="hs-identifier hs-var">typeFamilyHeadName</span></a></span><span> </span><span class="annot"><span class="annottext">TypeFamilyHead
</span><a href="#local-6989586621679412938"><span class="hs-identifier hs-var">tfHead</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TySynEqn]
</span><a href="#local-6989586621679412937"><span class="hs-identifier hs-var">eqns</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ClosedTypeFamilyD</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">m_k</span><span> </span><span class="hs-identifier">eqns</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-752"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DClosedTypeFamilyD</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsTypeFamilyHead</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">m_k</span><span>
</span><span id="line-753"></span><span>                                </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">dsTySynEqn</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">eqns</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RoleAnnotD</span></span><span> </span><span id="local-6989586621679412933"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412933"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412932"><span class="annot"><span class="annottext">roles :: [Role]
</span><a href="#local-6989586621679412932"><span class="hs-identifier hs-var">roles</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DDec] -&gt; q [DDec]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Role] -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DRoleAnnotD"><span class="hs-identifier hs-var">DRoleAnnotD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412933"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Role]
</span><a href="#local-6989586621679412932"><span class="hs-identifier hs-var">roles</span></a></span><span class="hs-special">]</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 709
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PatSynD</span></span><span> </span><span id="local-6989586621679412929"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412929"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412928"><span class="annot"><span class="annottext">args :: PatSynArgs
</span><a href="#local-6989586621679412928"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679412927"><span class="annot"><span class="annottext">dir :: PatSynDir
</span><a href="#local-6989586621679412927"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621679412926"><span class="annot"><span class="annottext">pat :: Pat
</span><a href="#local-6989586621679412926"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-759"></span><span>  </span><span id="local-6989586621679412925"><span class="annot"><span class="annottext">DPatSynDir
</span><a href="#local-6989586621679412925"><span class="hs-identifier hs-var">dir'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; PatSynDir -&gt; q DPatSynDir
forall (q :: * -&gt; *).
DsMonad q =&gt;
Name -&gt; PatSynDir -&gt; q DPatSynDir
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatSynDir"><span class="hs-identifier hs-var">dsPatSynDir</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412929"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">PatSynDir
</span><a href="#local-6989586621679412927"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-760"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679412923"><span class="annot"><span class="annottext">pat' :: DPat
</span><a href="#local-6989586621679412923"><span class="hs-identifier hs-var">pat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412922"><span class="annot"><span class="annottext">vars :: [(Name, DExp)]
</span><a href="#local-6989586621679412922"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; q (DPat, [(Name, DExp)])
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; q (DPat, [(Name, DExp)])
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatX"><span class="hs-identifier hs-var">dsPatX</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679412926"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-761"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; q () -&gt; q ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Name, DExp)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(Name, DExp)]
</span><a href="#local-6989586621679412922"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(q () -&gt; q ()) -&gt; q () -&gt; q ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-762"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; q ()
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q ()) -&gt; String -&gt; q ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Pattern synonym definition cannot contain as-patterns (@).&quot;</span></span><span>
</span><span id="line-763"></span><span>  </span><span class="annot"><span class="annottext">[DDec] -&gt; q [DDec]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; PatSynArgs -&gt; DPatSynDir -&gt; DPat -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPatSynD"><span class="hs-identifier hs-var">DPatSynD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412929"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">PatSynArgs
</span><a href="#local-6989586621679412928"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">DPatSynDir
</span><a href="#local-6989586621679412925"><span class="hs-identifier hs-var">dir'</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679412923"><span class="hs-identifier hs-var">pat'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-764"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PatSynSigD</span></span><span> </span><span id="local-6989586621679412918"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412918"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412917"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679412917"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPatSynSigD"><span class="hs-identifier hs-var">DPatSynSigD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412918"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DDec) -&gt; q DType -&gt; q DDec
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412917"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-765"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StandaloneDerivD</span></span><span> </span><span id="local-6989586621679412914"><span class="annot"><span class="annottext">mds :: Maybe DerivStrategy
</span><a href="#local-6989586621679412914"><span class="hs-identifier hs-var">mds</span></a></span></span><span> </span><span id="local-6989586621679412913"><span class="annot"><span class="annottext">cxt :: Cxt
</span><a href="#local-6989586621679412913"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679412912"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679412912"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-766"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe DDerivStrategy -&gt; Maybe [DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DStandaloneDerivD"><span class="hs-identifier hs-var">DStandaloneDerivD</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe DDerivStrategy
 -&gt; Maybe [DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; DDec)
-&gt; q (Maybe DDerivStrategy)
-&gt; q (Maybe [DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; DDec)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(DerivStrategy -&gt; q DDerivStrategy)
-&gt; Maybe DerivStrategy -&gt; q (Maybe DDerivStrategy)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">DerivStrategy -&gt; q DDerivStrategy
forall (q :: * -&gt; *).
DsMonad q =&gt;
DerivStrategy -&gt; q DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-var">dsDerivStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DerivStrategy
</span><a href="#local-6989586621679412914"><span class="hs-identifier hs-var">mds</span></a></span><span>
</span><span id="line-767"></span><span>                               </span><span class="annot"><span class="annottext">q (Maybe [DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; DDec)
-&gt; q (Maybe [DTyVarBndr]) -&gt; q (DCxt -&gt; DType -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr] -&gt; q (Maybe [DTyVarBndr])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">q (DCxt -&gt; DType -&gt; DDec) -&gt; q DCxt -&gt; q (DType -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Cxt -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679412913"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DDec) -&gt; q DType -&gt; q DDec
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412912"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsDec</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">StandaloneDerivD</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-identifier">ty</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-770"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DStandaloneDerivD</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsCxt</span><span> </span><span class="hs-identifier">cxt</span><span> </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">ty</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DefaultSigD</span></span><span> </span><span id="local-6989586621679412908"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412908"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412907"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679412907"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DDefaultSigD"><span class="hs-identifier hs-var">DDefaultSigD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412908"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DDec) -&gt; q DType -&gt; q DDec
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412907"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDec"><span class="hs-identifier hs-var">dsDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImplicitParamBindD</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q [DDec]
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Non-`let`-bound implicit param binding&quot;</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-778"></span><span class="hs-comment">-- | Desugar a 'DataD' or 'NewtypeD'.</span><span>
</span><span id="line-779"></span><span id="local-6989586621679413843"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDataDec"><span class="hs-identifier hs-type">dsDataDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413843"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-780"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#NewOrData"><span class="hs-identifier hs-type">NewOrData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span class="hs-special">]</span><span>
</span><span id="line-781"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Kind</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DerivingClause"><span class="hs-identifier hs-type">DerivingClause</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413843"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-782"></span><span id="dsDataDec"><span class="annot"><span class="annottext">dsDataDec :: NewOrData
-&gt; Cxt
-&gt; Name
-&gt; [TyVarBndr]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDataDec"><span class="hs-identifier hs-var hs-var">dsDataDec</span></a></span></span><span> </span><span id="local-6989586621679412902"><span class="annot"><span class="annottext">nd :: NewOrData
</span><a href="#local-6989586621679412902"><span class="hs-identifier hs-var">nd</span></a></span></span><span> </span><span id="local-6989586621679412901"><span class="annot"><span class="annottext">cxt :: Cxt
</span><a href="#local-6989586621679412901"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679412900"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412900"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412899"><span class="annot"><span class="annottext">tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679412899"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679412898"><span class="annot"><span class="annottext">mk :: Maybe Type
</span><a href="#local-6989586621679412898"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679412897"><span class="annot"><span class="annottext">cons :: [Con]
</span><a href="#local-6989586621679412897"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679412896"><span class="annot"><span class="annottext">derivings :: [DerivClause]
</span><a href="#local-6989586621679412896"><span class="hs-identifier hs-var">derivings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-783"></span><span>  </span><span id="local-6989586621679412895"><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412895"><span class="hs-identifier hs-var">tvbs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679412899"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-784"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679412894"><span class="annot"><span class="annottext">h98_tvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679412894"><span class="hs-identifier hs-var hs-var">h98_tvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679412898"><span class="hs-identifier hs-var">mk</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-785"></span><span>                   </span><span class="hs-comment">-- If there's an explicit return kind, we're dealing with a</span><span>
</span><span id="line-786"></span><span>                   </span><span class="hs-comment">-- GADT, so this argument goes unused in dsCon.</span><span>
</span><span id="line-787"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
forall a. a
</span><a href="Language.Haskell.TH.Desugar.Core.html#unusedArgument"><span class="hs-identifier hs-var">unusedArgument</span></a></span><span>
</span><span id="line-788"></span><span>                   </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412895"><span class="hs-identifier hs-var">tvbs'</span></a></span><span>
</span><span id="line-789"></span><span>      </span><span id="local-6989586621679412893"><span class="annot"><span class="annottext">h98_return_type :: DType
</span><a href="#local-6989586621679412893"><span class="hs-identifier hs-var hs-var">h98_return_type</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DTyVarBndr] -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#nonFamilyDataReturnType"><span class="hs-identifier hs-var">nonFamilyDataReturnType</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412900"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412895"><span class="hs-identifier hs-var">tvbs'</span></a></span><span>
</span><span id="line-790"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NewOrData
-&gt; DCxt
-&gt; Name
-&gt; [DTyVarBndr]
-&gt; Maybe DType
-&gt; [DCon]
-&gt; [DDerivClause]
-&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DDataD"><span class="hs-identifier hs-var">DDataD</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="#local-6989586621679412902"><span class="hs-identifier hs-var">nd</span></a></span><span> </span><span class="annot"><span class="annottext">(DCxt
 -&gt; Name
 -&gt; [DTyVarBndr]
 -&gt; Maybe DType
 -&gt; [DCon]
 -&gt; [DDerivClause]
 -&gt; DDec)
-&gt; q DCxt
-&gt; q (Name
      -&gt; [DTyVarBndr] -&gt; Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Cxt -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679412901"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">q (Name
   -&gt; [DTyVarBndr] -&gt; Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
-&gt; q Name
-&gt; q ([DTyVarBndr]
      -&gt; Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Name
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412900"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-791"></span><span>                       </span><span class="annot"><span class="annottext">q ([DTyVarBndr] -&gt; Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
-&gt; q [DTyVarBndr]
-&gt; q (Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; q [DTyVarBndr]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412895"><span class="hs-identifier hs-var">tvbs'</span></a></span><span> </span><span class="annot"><span class="annottext">q (Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
-&gt; q (Maybe DType) -&gt; q ([DCon] -&gt; [DDerivClause] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; q DType) -&gt; Maybe Type -&gt; q (Maybe DType)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679412898"><span class="hs-identifier hs-var">mk</span></a></span><span>
</span><span id="line-792"></span><span>                       </span><span class="annot"><span class="annottext">q ([DCon] -&gt; [DDerivClause] -&gt; DDec)
-&gt; q [DCon] -&gt; q ([DDerivClause] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Con -&gt; q [DCon]) -&gt; [Con] -&gt; q [DCon]
forall (monad :: * -&gt; *) monoid (t :: * -&gt; *) a.
(Monad monad, Monoid monoid, Traversable t) =&gt;
(a -&gt; monad monoid) -&gt; t a -&gt; monad monoid
</span><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; DType -&gt; Con -&gt; q [DCon]
forall (q :: * -&gt; *).
DsMonad q =&gt;
[DTyVarBndr] -&gt; DType -&gt; Con -&gt; q [DCon]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCon"><span class="hs-identifier hs-var">dsCon</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412894"><span class="hs-identifier hs-var">h98_tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412893"><span class="hs-identifier hs-var">h98_return_type</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679412897"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-793"></span><span>                       </span><span class="annot"><span class="annottext">q ([DDerivClause] -&gt; DDec) -&gt; q [DDerivClause] -&gt; q DDec
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(DerivClause -&gt; q DDerivClause)
-&gt; [DerivClause] -&gt; q [DDerivClause]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">DerivClause -&gt; q DDerivClause
forall (q :: * -&gt; *). DsMonad q =&gt; DerivClause -&gt; q DDerivClause
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivClause"><span class="hs-identifier hs-var">dsDerivClause</span></a></span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679412896"><span class="hs-identifier hs-var">derivings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-794"></span><span>
</span><span id="line-795"></span><span class="hs-comment">-- | Desugar a 'DataInstD' or a 'NewtypeInstD'.</span><span>
</span><span id="line-796"></span><span id="local-6989586621679413831"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDataInstDec"><span class="hs-identifier hs-type">dsDataInstDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413831"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-797"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#NewOrData"><span class="hs-identifier hs-type">NewOrData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-798"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Kind</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DerivingClause"><span class="hs-identifier hs-type">DerivingClause</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413831"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-799"></span><span id="dsDataInstDec"><span class="annot"><span class="annottext">dsDataInstDec :: NewOrData
-&gt; Cxt
-&gt; Name
-&gt; Maybe [TyVarBndr]
-&gt; [TypeArg]
-&gt; Maybe Type
-&gt; [Con]
-&gt; [DerivClause]
-&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDataInstDec"><span class="hs-identifier hs-var hs-var">dsDataInstDec</span></a></span></span><span> </span><span id="local-6989586621679412888"><span class="annot"><span class="annottext">nd :: NewOrData
</span><a href="#local-6989586621679412888"><span class="hs-identifier hs-var">nd</span></a></span></span><span> </span><span id="local-6989586621679412887"><span class="annot"><span class="annottext">cxt :: Cxt
</span><a href="#local-6989586621679412887"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679412886"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412886"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412885"><span class="annot"><span class="annottext">mtvbs :: Maybe [TyVarBndr]
</span><a href="#local-6989586621679412885"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679412884"><span class="annot"><span class="annottext">tys :: [TypeArg]
</span><a href="#local-6989586621679412884"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span id="local-6989586621679412883"><span class="annot"><span class="annottext">mk :: Maybe Type
</span><a href="#local-6989586621679412883"><span class="hs-identifier hs-var">mk</span></a></span></span><span> </span><span id="local-6989586621679412882"><span class="annot"><span class="annottext">cons :: [Con]
</span><a href="#local-6989586621679412882"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679412881"><span class="annot"><span class="annottext">derivings :: [DerivClause]
</span><a href="#local-6989586621679412881"><span class="hs-identifier hs-var">derivings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-800"></span><span>  </span><span id="local-6989586621679412880"><span class="annot"><span class="annottext">Maybe [DTyVarBndr]
</span><a href="#local-6989586621679412880"><span class="hs-identifier hs-var">mtvbs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([TyVarBndr] -&gt; q [DTyVarBndr])
-&gt; Maybe [TyVarBndr] -&gt; q (Maybe [DTyVarBndr])
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndr]
</span><a href="#local-6989586621679412885"><span class="hs-identifier hs-var">mtvbs</span></a></span><span>
</span><span id="line-801"></span><span>  </span><span id="local-6989586621679412879"><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679412879"><span class="hs-identifier hs-var">tys'</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TypeArg -&gt; q DTypeArg) -&gt; [TypeArg] -&gt; q [DTypeArg]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TypeArg -&gt; q DTypeArg
forall (q :: * -&gt; *). DsMonad q =&gt; TypeArg -&gt; q DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeArg"><span class="hs-identifier hs-var">dsTypeArg</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeArg]
</span><a href="#local-6989586621679412884"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-802"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679412877"><span class="annot"><span class="annottext">lhs' :: DType
</span><a href="#local-6989586621679412877"><span class="hs-identifier hs-var hs-var">lhs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; [DTypeArg] -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#applyDType"><span class="hs-identifier hs-var">applyDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412886"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679412879"><span class="hs-identifier hs-var">tys'</span></a></span><span>
</span><span id="line-803"></span><span>      </span><span id="local-6989586621679412874"><span class="annot"><span class="annottext">h98_tvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679412874"><span class="hs-identifier hs-var hs-var">h98_tvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-804"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679412883"><span class="hs-identifier hs-var">mk</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr]
</span><a href="#local-6989586621679412880"><span class="hs-identifier hs-var">mtvbs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-805"></span><span>          </span><span class="hs-comment">-- If there's an explicit return kind, we're dealing with a</span><span>
</span><span id="line-806"></span><span>          </span><span class="hs-comment">-- GADT, so this argument goes unused in dsCon.</span><span>
</span><span id="line-807"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
forall a. a
</span><a href="Language.Haskell.TH.Desugar.Core.html#unusedArgument"><span class="hs-identifier hs-var">unusedArgument</span></a></span><span>
</span><span id="line-808"></span><span>          </span><span class="hs-comment">-- H98, and there is an explicit `forall` in front. Just reuse the</span><span>
</span><span id="line-809"></span><span>          </span><span class="hs-comment">-- type variable binders from the `forall`.</span><span>
</span><span id="line-810"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679412873"><span class="annot"><span class="annottext">tvbs' :: [DTyVarBndr]
</span><a href="#local-6989586621679412873"><span class="hs-identifier hs-var">tvbs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412873"><span class="hs-identifier hs-var">tvbs'</span></a></span><span>
</span><span id="line-811"></span><span>          </span><span class="hs-comment">-- H98, and no explicit `forall`. Compute the bound variables</span><span>
</span><span id="line-812"></span><span>          </span><span class="hs-comment">-- manually.</span><span>
</span><span id="line-813"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[DTypeArg] -&gt; [DTyVarBndr]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dataFamInstTvbs"><span class="hs-identifier hs-var">dataFamInstTvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679412879"><span class="hs-identifier hs-var">tys'</span></a></span><span>
</span><span id="line-814"></span><span>      </span><span id="local-6989586621679412871"><span class="annot"><span class="annottext">h98_fam_inst_type :: DType
</span><a href="#local-6989586621679412871"><span class="hs-identifier hs-var hs-var">h98_fam_inst_type</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DTypeArg] -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dataFamInstReturnType"><span class="hs-identifier hs-var">dataFamInstReturnType</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412886"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679412879"><span class="hs-identifier hs-var">tys'</span></a></span><span>
</span><span id="line-815"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDec -&gt; [DDec] -&gt; [DDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DDec -&gt; [DDec]) -&gt; q DDec -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NewOrData
-&gt; DCxt
-&gt; Maybe [DTyVarBndr]
-&gt; DType
-&gt; Maybe DType
-&gt; [DCon]
-&gt; [DDerivClause]
-&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DDataInstD"><span class="hs-identifier hs-var">DDataInstD</span></a></span><span> </span><span class="annot"><span class="annottext">NewOrData
</span><a href="#local-6989586621679412888"><span class="hs-identifier hs-var">nd</span></a></span><span> </span><span class="annot"><span class="annottext">(DCxt
 -&gt; Maybe [DTyVarBndr]
 -&gt; DType
 -&gt; Maybe DType
 -&gt; [DCon]
 -&gt; [DDerivClause]
 -&gt; DDec)
-&gt; q DCxt
-&gt; q (Maybe [DTyVarBndr]
      -&gt; DType -&gt; Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Cxt -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679412887"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">q (Maybe [DTyVarBndr]
   -&gt; DType -&gt; Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
-&gt; q (Maybe [DTyVarBndr])
-&gt; q (DType -&gt; Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr] -&gt; q (Maybe [DTyVarBndr])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr]
</span><a href="#local-6989586621679412880"><span class="hs-identifier hs-var">mtvbs'</span></a></span><span>
</span><span id="line-816"></span><span>                           </span><span class="annot"><span class="annottext">q (DType -&gt; Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
-&gt; q DType -&gt; q (Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412877"><span class="hs-identifier hs-var">lhs'</span></a></span><span> </span><span class="annot"><span class="annottext">q (Maybe DType -&gt; [DCon] -&gt; [DDerivClause] -&gt; DDec)
-&gt; q (Maybe DType) -&gt; q ([DCon] -&gt; [DDerivClause] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; q DType) -&gt; Maybe Type -&gt; q (Maybe DType)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679412883"><span class="hs-identifier hs-var">mk</span></a></span><span>
</span><span id="line-817"></span><span>                           </span><span class="annot"><span class="annottext">q ([DCon] -&gt; [DDerivClause] -&gt; DDec)
-&gt; q [DCon] -&gt; q ([DDerivClause] -&gt; DDec)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Con -&gt; q [DCon]) -&gt; [Con] -&gt; q [DCon]
forall (monad :: * -&gt; *) monoid (t :: * -&gt; *) a.
(Monad monad, Monoid monoid, Traversable t) =&gt;
(a -&gt; monad monoid) -&gt; t a -&gt; monad monoid
</span><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; DType -&gt; Con -&gt; q [DCon]
forall (q :: * -&gt; *).
DsMonad q =&gt;
[DTyVarBndr] -&gt; DType -&gt; Con -&gt; q [DCon]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCon"><span class="hs-identifier hs-var">dsCon</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412874"><span class="hs-identifier hs-var">h98_tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412871"><span class="hs-identifier hs-var">h98_fam_inst_type</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679412882"><span class="hs-identifier hs-var">cons</span></a></span><span>
</span><span id="line-818"></span><span>                           </span><span class="annot"><span class="annottext">q ([DDerivClause] -&gt; DDec) -&gt; q [DDerivClause] -&gt; q DDec
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(DerivClause -&gt; q DDerivClause)
-&gt; [DerivClause] -&gt; q [DDerivClause]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">DerivClause -&gt; q DDerivClause
forall (q :: * -&gt; *). DsMonad q =&gt; DerivClause -&gt; q DDerivClause
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivClause"><span class="hs-identifier hs-var">dsDerivClause</span></a></span><span> </span><span class="annot"><span class="annottext">[DerivClause]
</span><a href="#local-6989586621679412881"><span class="hs-identifier hs-var">derivings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-819"></span><span>
</span><span id="line-820"></span><span class="hs-comment">-- Like mkExtraDKindBinders, but accepts a Maybe Kind</span><span>
</span><span id="line-821"></span><span class="hs-comment">-- argument instead of DKind.</span><span>
</span><span id="line-822"></span><span id="local-6989586621679412868"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkExtraKindBinders"><span class="hs-identifier hs-type">mkExtraKindBinders</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679412868"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Kind</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679412868"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-823"></span><span id="mkExtraKindBinders"><span class="annot"><span class="annottext">mkExtraKindBinders :: Maybe Type -&gt; q [DTyVarBndr]
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkExtraKindBinders"><span class="hs-identifier hs-var hs-var">mkExtraKindBinders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-824"></span><span>  </span><span class="annot"><span class="annottext">q DType -&gt; (Type -&gt; q DType) -&gt; Maybe Type -&gt; q DType
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#typeKindName"><span class="hs-identifier hs-var">typeKindName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q Type -&gt; q Type
forall (m :: * -&gt; *) a. Quasi m =&gt; Q a -&gt; m a
</span><span class="hs-identifier hs-var">runQ</span></span><span> </span><span class="annot"><span class="annottext">(Q Type -&gt; q Type) -&gt; (Type -&gt; Q Type) -&gt; Type -&gt; q Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Q Type
</span><span class="hs-identifier hs-var">resolveTypeSynonyms</span></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; q Type) -&gt; (Type -&gt; q DType) -&gt; Type -&gt; q DType
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-825"></span><span>    </span><span class="annot"><span class="annottext">(Maybe Type -&gt; q DType)
-&gt; (DType -&gt; q [DTyVarBndr]) -&gt; Maybe Type -&gt; q [DTyVarBndr]
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; q [DTyVarBndr]
forall (q :: * -&gt; *). Quasi q =&gt; DType -&gt; q [DTyVarBndr]
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkExtraDKindBinders%27"><span class="hs-identifier hs-var">mkExtraDKindBinders'</span></a></span><span>
</span><span id="line-826"></span><span>
</span><span id="line-827"></span><span class="hs-comment">-- | Like mkExtraDKindBinders, but assumes kind synonyms have been expanded.</span><span>
</span><span id="line-828"></span><span id="local-6989586621679413799"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkExtraDKindBinders%27"><span class="hs-identifier hs-type">mkExtraDKindBinders'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Quasi</span></span><span> </span><span class="annot"><a href="#local-6989586621679413799"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413799"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-829"></span><span id="mkExtraDKindBinders%27"><span class="annot"><span class="annottext">mkExtraDKindBinders' :: DType -&gt; q [DTyVarBndr]
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkExtraDKindBinders%27"><span class="hs-identifier hs-var hs-var">mkExtraDKindBinders'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; ([DTyVarBndr], DCxt, DCxt, DType))
-&gt; (Name -&gt; DType -&gt; DTyVarBndr) -&gt; DType -&gt; q [DTyVarBndr]
forall (q :: * -&gt; *) kind tyVarBndr pred.
Quasi q =&gt;
(kind -&gt; ([tyVarBndr], [pred], [kind], kind))
-&gt; (Name -&gt; kind -&gt; tyVarBndr) -&gt; kind -&gt; q [tyVarBndr]
</span><a href="Language.Haskell.TH.Desugar.Util.html#mkExtraKindBindersGeneric"><span class="hs-identifier hs-var">mkExtraKindBindersGeneric</span></a></span><span> </span><span class="annot"><span class="annottext">DType -&gt; ([DTyVarBndr], DCxt, DCxt, DType)
</span><a href="Language.Haskell.TH.Desugar.Core.html#unravel"><span class="hs-identifier hs-var">unravel</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-var">DKindedTV</span></a></span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="hs-comment">-- | Desugar a @FamilyResultSig@</span><span>
</span><span id="line-833"></span><span id="local-6989586621679413789"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsFamilyResultSig"><span class="hs-identifier hs-type">dsFamilyResultSig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413789"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FamilyResultSig</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413789"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DFamilyResultSig"><span class="hs-identifier hs-type">DFamilyResultSig</span></a></span></span><span>
</span><span id="line-834"></span><span id="dsFamilyResultSig"><span class="annot"><span class="annottext">dsFamilyResultSig :: FamilyResultSig -&gt; q DFamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsFamilyResultSig"><span class="hs-identifier hs-var hs-var">dsFamilyResultSig</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NoSig</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DFamilyResultSig -&gt; q DFamilyResultSig
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DFamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.AST.html#DNoSig"><span class="hs-identifier hs-var">DNoSig</span></a></span><span>
</span><span id="line-835"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsFamilyResultSig"><span class="hs-identifier hs-var">dsFamilyResultSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KindSig</span></span><span> </span><span id="local-6989586621679412854"><span class="annot"><span class="annottext">k :: Type
</span><a href="#local-6989586621679412854"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DFamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.AST.html#DKindSig"><span class="hs-identifier hs-var">DKindSig</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DFamilyResultSig) -&gt; q DType -&gt; q DFamilyResultSig
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412854"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-836"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsFamilyResultSig"><span class="hs-identifier hs-var">dsFamilyResultSig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TyVarSig</span></span><span> </span><span id="local-6989586621679412851"><span class="annot"><span class="annottext">tvb :: TyVarBndr
</span><a href="#local-6989586621679412851"><span class="hs-identifier hs-var">tvb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; DFamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarSig"><span class="hs-identifier hs-var">DTyVarSig</span></a></span><span> </span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; DFamilyResultSig)
-&gt; q DTyVarBndr -&gt; q DFamilyResultSig
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarBndr
</span><a href="#local-6989586621679412851"><span class="hs-identifier hs-var">tvb</span></a></span><span>
</span><span id="line-837"></span><span>
</span><span id="line-838"></span><span class="hs-comment">-- | Desugar a @TypeFamilyHead@</span><span>
</span><span id="line-839"></span><span id="local-6989586621679413833"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeFamilyHead"><span class="hs-identifier hs-type">dsTypeFamilyHead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413833"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypeFamilyHead</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413833"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTypeFamilyHead"><span class="hs-identifier hs-type">DTypeFamilyHead</span></a></span></span><span>
</span><span id="line-840"></span><span id="dsTypeFamilyHead"><span class="annot"><span class="annottext">dsTypeFamilyHead :: TypeFamilyHead -&gt; q DTypeFamilyHead
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeFamilyHead"><span class="hs-identifier hs-var hs-var">dsTypeFamilyHead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TypeFamilyHead</span></span><span> </span><span id="local-6989586621679412848"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412848"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412847"><span class="annot"><span class="annottext">tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679412847"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679412846"><span class="annot"><span class="annottext">result :: FamilyResultSig
</span><a href="#local-6989586621679412846"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span id="local-6989586621679412845"><span class="annot"><span class="annottext">inj :: Maybe InjectivityAnn
</span><a href="#local-6989586621679412845"><span class="hs-identifier hs-var">inj</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-841"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
-&gt; [DTyVarBndr]
-&gt; DFamilyResultSig
-&gt; Maybe InjectivityAnn
-&gt; DTypeFamilyHead
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTypeFamilyHead"><span class="hs-identifier hs-var">DTypeFamilyHead</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412848"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">([DTyVarBndr]
 -&gt; DFamilyResultSig -&gt; Maybe InjectivityAnn -&gt; DTypeFamilyHead)
-&gt; q [DTyVarBndr]
-&gt; q (DFamilyResultSig -&gt; Maybe InjectivityAnn -&gt; DTypeFamilyHead)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679412847"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-842"></span><span>                      </span><span class="annot"><span class="annottext">q (DFamilyResultSig -&gt; Maybe InjectivityAnn -&gt; DTypeFamilyHead)
-&gt; q DFamilyResultSig
-&gt; q (Maybe InjectivityAnn -&gt; DTypeFamilyHead)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">FamilyResultSig -&gt; q DFamilyResultSig
forall (q :: * -&gt; *).
DsMonad q =&gt;
FamilyResultSig -&gt; q DFamilyResultSig
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsFamilyResultSig"><span class="hs-identifier hs-var">dsFamilyResultSig</span></a></span><span> </span><span class="annot"><span class="annottext">FamilyResultSig
</span><a href="#local-6989586621679412846"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-843"></span><span>                      </span><span class="annot"><span class="annottext">q (Maybe InjectivityAnn -&gt; DTypeFamilyHead)
-&gt; q (Maybe InjectivityAnn) -&gt; q DTypeFamilyHead
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe InjectivityAnn -&gt; q (Maybe InjectivityAnn)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe InjectivityAnn
</span><a href="#local-6989586621679412845"><span class="hs-identifier hs-var">inj</span></a></span><span>
</span><span id="line-844"></span><span>
</span><span id="line-845"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#typeFamilyHeadName"><span class="hs-identifier hs-type">typeFamilyHeadName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TypeFamilyHead</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-846"></span><span id="typeFamilyHeadName"><span class="annot"><span class="annottext">typeFamilyHeadName :: TypeFamilyHead -&gt; Name
</span><a href="Language.Haskell.TH.Desugar.Core.html#typeFamilyHeadName"><span class="hs-identifier hs-var hs-var">typeFamilyHeadName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TypeFamilyHead</span></span><span> </span><span id="local-6989586621679412843"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412843"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412843"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- | Desugar bits and pieces into a 'DTypeFamilyHead'</span><span>
</span><span id="line-849"></span><span class="hs-identifier">dsTypeFamilyHead</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span>
</span><span id="line-850"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">TyVarBndr</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">Kind</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DTypeFamilyHead</span><span>
</span><span id="line-851"></span><span class="hs-identifier">dsTypeFamilyHead</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tvbs</span><span> </span><span class="hs-identifier">m_kind</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-852"></span><span>  </span><span class="hs-identifier">result_sig</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">m_kind</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-853"></span><span>    </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">DNoSig</span><span>
</span><span id="line-854"></span><span>    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">k</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">DKindSig</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">k</span><span>
</span><span id="line-855"></span><span>  </span><span class="hs-identifier">DTypeFamilyHead</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsTvb</span><span> </span><span class="hs-identifier">tvbs</span><span>
</span><span id="line-856"></span><span>                    </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">result_sig</span><span>
</span><span id="line-857"></span><span>                    </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">Nothing</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-860"></span><span class="hs-comment">-- | Desugar @Dec@s that can appear in a @let@ expression. See the</span><span>
</span><span id="line-861"></span><span class="hs-comment">-- documentation for 'dsLetDec' for an explanation of what the return type</span><span>
</span><span id="line-862"></span><span class="hs-comment">-- represents.</span><span>
</span><span id="line-863"></span><span id="local-6989586621679414000"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-type">dsLetDecs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679414000"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679414000"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-type">DLetDec</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-864"></span><span id="dsLetDecs"><span class="annot"><span class="annottext">dsLetDecs :: [Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var hs-var">dsLetDecs</span></a></span></span><span> </span><span id="local-6989586621679412842"><span class="annot"><span class="annottext">decs :: [Dec]
</span><a href="#local-6989586621679412842"><span class="hs-identifier hs-var">decs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-865"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679412841"><span class="annot"><span class="annottext">let_decss :: [[DLetDec]]
</span><a href="#local-6989586621679412841"><span class="hs-identifier hs-var">let_decss</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412840"><span class="annot"><span class="annottext">ip_binders :: [DExp -&gt; DExp]
</span><a href="#local-6989586621679412840"><span class="hs-identifier hs-var">ip_binders</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Dec -&gt; q ([DLetDec], DExp -&gt; DExp))
-&gt; [Dec] -&gt; q ([[DLetDec]], [DExp -&gt; DExp])
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; m (b, c)) -&gt; [a] -&gt; m ([b], [c])
</span><span class="hs-identifier hs-var">mapAndUnzipM</span></span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
Dec -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679412842"><span class="hs-identifier hs-var">decs</span></a></span><span>
</span><span id="line-866"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679412837"><span class="hs-identifier hs-type">let_decs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-type">DLetDec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-867"></span><span>      </span><span id="local-6989586621679412837"><span class="annot"><span class="annottext">let_decs :: [DLetDec]
</span><a href="#local-6989586621679412837"><span class="hs-identifier hs-var hs-var">let_decs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[DLetDec]] -&gt; [DLetDec]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[DLetDec]]
</span><a href="#local-6989586621679412841"><span class="hs-identifier hs-var">let_decss</span></a></span><span>
</span><span id="line-868"></span><span>
</span><span id="line-869"></span><span>      </span><span class="annot"><a href="#local-6989586621679412836"><span class="hs-identifier hs-type">ip_binder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-870"></span><span>      </span><span id="local-6989586621679412836"><span class="annot"><span class="annottext">ip_binder :: DExp -&gt; DExp
</span><a href="#local-6989586621679412836"><span class="hs-identifier hs-var hs-var">ip_binder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((DExp -&gt; DExp) -&gt; (DExp -&gt; DExp) -&gt; DExp -&gt; DExp)
-&gt; (DExp -&gt; DExp) -&gt; [DExp -&gt; DExp] -&gt; DExp -&gt; DExp
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp) -&gt; (DExp -&gt; DExp) -&gt; DExp -&gt; DExp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">(.)</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">[DExp -&gt; DExp]
</span><a href="#local-6989586621679412840"><span class="hs-identifier hs-var">ip_binders</span></a></span><span>
</span><span id="line-871"></span><span>  </span><span class="annot"><span class="annottext">([DLetDec], DExp -&gt; DExp) -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679412837"><span class="hs-identifier hs-var">let_decs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679412836"><span class="hs-identifier hs-var">ip_binder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-872"></span><span>
</span><span id="line-873"></span><span class="hs-comment">-- | Desugar a single 'Dec' that can appear in a @let@ expression.</span><span>
</span><span id="line-874"></span><span class="hs-comment">-- This produces the following output:</span><span>
</span><span id="line-875"></span><span class="hs-comment">--</span><span>
</span><span id="line-876"></span><span class="hs-comment">-- * One or more 'DLetDec's (a single 'Dec' can produce multiple 'DLetDec's</span><span>
</span><span id="line-877"></span><span class="hs-comment">--   in the event of a value declaration that binds multiple things by way</span><span>
</span><span id="line-878"></span><span class="hs-comment">--   of pattern matching.</span><span>
</span><span id="line-879"></span><span class="hs-comment">--</span><span>
</span><span id="line-880"></span><span class="hs-comment">-- * A function of type @'DExp' -&gt; 'DExp'@, which should be applied to the</span><span>
</span><span id="line-881"></span><span class="hs-comment">--   expression immediately following the 'DLetDec's. This function prepends</span><span>
</span><span id="line-882"></span><span class="hs-comment">--   binding forms for any implicit params that were bound in the argument</span><span>
</span><span id="line-883"></span><span class="hs-comment">--   'Dec'. (If no implicit params are bound, this is simply the 'id'</span><span>
</span><span id="line-884"></span><span class="hs-comment">--   function.)</span><span>
</span><span id="line-885"></span><span class="hs-comment">--</span><span>
</span><span id="line-886"></span><span class="hs-comment">-- For instance, if the argument to 'dsLetDec' is the @?x = 42@ part of this</span><span>
</span><span id="line-887"></span><span class="hs-comment">-- expression:</span><span>
</span><span id="line-888"></span><span class="hs-comment">--</span><span>
</span><span id="line-889"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-890"></span><span class="hs-comment">-- let { ?x = 42 } in ?x</span><span>
</span><span id="line-891"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-892"></span><span class="hs-comment">--</span><span>
</span><span id="line-893"></span><span class="hs-comment">-- Then the output is:</span><span>
</span><span id="line-894"></span><span class="hs-comment">--</span><span>
</span><span id="line-895"></span><span class="hs-comment">-- * @let new_x_val = 42@</span><span>
</span><span id="line-896"></span><span class="hs-comment">--</span><span>
</span><span id="line-897"></span><span class="hs-comment">-- * @\\z -&gt; 'bindIP' \@\&quot;x\&quot; new_x_val z@</span><span>
</span><span id="line-898"></span><span class="hs-comment">--</span><span>
</span><span id="line-899"></span><span class="hs-comment">-- This way, the expression</span><span>
</span><span id="line-900"></span><span class="hs-comment">-- @let { new_x_val = 42 } in 'bindIP' \@&quot;x&quot; new_x_val ('ip' \@\&quot;x\&quot;)@ can be</span><span>
</span><span id="line-901"></span><span class="hs-comment">-- formed. The implicit param binders always come after all the other</span><span>
</span><span id="line-902"></span><span class="hs-comment">-- 'DLetDec's to support parallel assignment of implicit params.</span><span>
</span><span id="line-903"></span><span id="local-6989586621679413783"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-type">dsLetDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413783"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413783"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-type">DLetDec</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-904"></span><span id="dsLetDec"><span class="annot"><span class="annottext">dsLetDec :: Dec -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var hs-var">dsLetDec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FunD</span></span><span> </span><span id="local-6989586621679412834"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679412834"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679412833"><span class="annot"><span class="annottext">clauses :: [Clause]
</span><a href="#local-6989586621679412833"><span class="hs-identifier hs-var">clauses</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-905"></span><span>  </span><span id="local-6989586621679412832"><span class="annot"><span class="annottext">[DClause]
</span><a href="#local-6989586621679412832"><span class="hs-identifier hs-var">clauses'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Clause] -&gt; q [DClause]
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; [Clause] -&gt; q [DClause]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-var">dsClauses</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412834"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621679412833"><span class="hs-identifier hs-var">clauses</span></a></span><span>
</span><span id="line-906"></span><span>  </span><span class="annot"><span class="annottext">([DLetDec], DExp -&gt; DExp) -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [DClause] -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DFunD"><span class="hs-identifier hs-var">DFunD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412834"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[DClause]
</span><a href="#local-6989586621679412832"><span class="hs-identifier hs-var">clauses'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-907"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ValD</span></span><span> </span><span id="local-6989586621679412829"><span class="annot"><span class="annottext">pat :: Pat
</span><a href="#local-6989586621679412829"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679412828"><span class="annot"><span class="annottext">body :: Body
</span><a href="#local-6989586621679412828"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621679412827"><span class="annot"><span class="annottext">where_decs :: [Dec]
</span><a href="#local-6989586621679412827"><span class="hs-identifier hs-var">where_decs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-908"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679412826"><span class="annot"><span class="annottext">pat' :: DPat
</span><a href="#local-6989586621679412826"><span class="hs-identifier hs-var">pat'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412825"><span class="annot"><span class="annottext">vars :: [(Name, DExp)]
</span><a href="#local-6989586621679412825"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; q (DPat, [(Name, DExp)])
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; q (DPat, [(Name, DExp)])
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatX"><span class="hs-identifier hs-var">dsPatX</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679412829"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-909"></span><span>  </span><span id="local-6989586621679412824"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679412824"><span class="hs-identifier hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Body -&gt; [Dec] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Body -&gt; [Dec] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBody"><span class="hs-identifier hs-var">dsBody</span></a></span><span> </span><span class="annot"><span class="annottext">Body
</span><a href="#local-6989586621679412828"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679412827"><span class="hs-identifier hs-var">where_decs</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679412823"><span class="hs-identifier hs-var">error_exp</span></a></span><span>
</span><span id="line-910"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679412822"><span class="annot"><span class="annottext">extras :: [DLetDec]
</span><a href="#local-6989586621679412822"><span class="hs-identifier hs-var hs-var">extras</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; [DExp] -&gt; [DLetDec]) -&gt; ([Name], [DExp]) -&gt; [DLetDec]
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; DExp -&gt; DLetDec) -&gt; [Name] -&gt; [DExp] -&gt; [DLetDec]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DValD"><span class="hs-identifier hs-var">DValD</span></a></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; DExp -&gt; DLetDec)
-&gt; (Name -&gt; DPat) -&gt; Name -&gt; DExp -&gt; DLetDec
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([Name], [DExp]) -&gt; [DLetDec]) -&gt; ([Name], [DExp]) -&gt; [DLetDec]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Name, DExp)] -&gt; ([Name], [DExp])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">[(Name, DExp)]
</span><a href="#local-6989586621679412825"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-911"></span><span>  </span><span class="annot"><span class="annottext">([DLetDec], DExp -&gt; DExp) -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DValD"><span class="hs-identifier hs-var">DValD</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679412826"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679412824"><span class="hs-identifier hs-var">body'</span></a></span><span> </span><span class="annot"><span class="annottext">DLetDec -&gt; [DLetDec] -&gt; [DLetDec]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679412822"><span class="hs-identifier hs-var">extras</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-912"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-913"></span><span>    </span><span id="local-6989586621679412823"><span class="annot"><span class="annottext">error_exp :: DExp
</span><a href="#local-6989586621679412823"><span class="hs-identifier hs-var hs-var">error_exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">error</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lit -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitE"><span class="hs-identifier hs-var">DLitE</span></a></span><span>
</span><span id="line-914"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Lit
</span><span class="hs-identifier hs-var">StringL</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Lit) -&gt; String -&gt; Lit
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Non-exhaustive patterns for &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; String
forall a. Ppr a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">pprint</span></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679412829"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-915"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigD</span></span><span> </span><span id="local-6989586621679412821"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679412821"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679412820"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679412820"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-916"></span><span>  </span><span id="local-6989586621679412819"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412819"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412820"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-917"></span><span>  </span><span class="annot"><span class="annottext">([DLetDec], DExp -&gt; DExp) -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigD"><span class="hs-identifier hs-var">DSigD</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412821"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412819"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-918"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixD</span></span><span> </span><span id="local-6989586621679412817"><span class="annot"><span class="annottext">fixity :: Fixity
</span><a href="#local-6989586621679412817"><span class="hs-identifier hs-var">fixity</span></a></span></span><span> </span><span id="local-6989586621679412816"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679412816"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([DLetDec], DExp -&gt; DExp) -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Fixity -&gt; Name -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DInfixD"><span class="hs-identifier hs-var">DInfixD</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621679412817"><span class="hs-identifier hs-var">fixity</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412816"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-919"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PragmaD</span></span><span> </span><span id="local-6989586621679412814"><span class="annot"><span class="annottext">prag :: Pragma
</span><a href="#local-6989586621679412814"><span class="hs-identifier hs-var">prag</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-920"></span><span>  </span><span id="local-6989586621679412813"><span class="annot"><span class="annottext">DPragma
</span><a href="#local-6989586621679412813"><span class="hs-identifier hs-var">prag'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pragma -&gt; q DPragma
forall (q :: * -&gt; *). DsMonad q =&gt; Pragma -&gt; q DPragma
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="annot"><span class="annottext">Pragma
</span><a href="#local-6989586621679412814"><span class="hs-identifier hs-var">prag</span></a></span><span>
</span><span id="line-921"></span><span>  </span><span class="annot"><span class="annottext">([DLetDec], DExp -&gt; DExp) -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">DPragma -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPragmaD"><span class="hs-identifier hs-var">DPragmaD</span></a></span><span> </span><span class="annot"><span class="annottext">DPragma
</span><a href="#local-6989586621679412813"><span class="hs-identifier hs-var">prag'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImplicitParamBindD</span></span><span> </span><span id="local-6989586621679412810"><span class="annot"><span class="annottext">n :: String
</span><a href="#local-6989586621679412810"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412809"><span class="annot"><span class="annottext">e :: Exp
</span><a href="#local-6989586621679412809"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-924"></span><span>  </span><span id="local-6989586621679412808"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412808"><span class="hs-identifier hs-var">new_n_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><span class="hs-identifier hs-var">qNewName</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q Name) -&gt; String -&gt; q Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;new_&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679412810"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;_val&quot;</span></span><span>
</span><span id="line-925"></span><span>  </span><span id="local-6989586621679412807"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679412807"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679412809"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-926"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679412806"><span class="hs-identifier hs-type">let_dec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-type">DLetDec</span></a></span><span>
</span><span id="line-927"></span><span>      </span><span id="local-6989586621679412806"><span class="annot"><span class="annottext">let_dec :: DLetDec
</span><a href="#local-6989586621679412806"><span class="hs-identifier hs-var hs-var">let_dec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DLetDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DValD"><span class="hs-identifier hs-var">DValD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412808"><span class="hs-identifier hs-var">new_n_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679412807"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-928"></span><span>
</span><span id="line-929"></span><span>      </span><span class="annot"><a href="#local-6989586621679412805"><span class="hs-identifier hs-type">ip_binder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-930"></span><span>      </span><span id="local-6989586621679412805"><span class="annot"><span class="annottext">ip_binder :: DExp -&gt; DExp
</span><a href="#local-6989586621679412805"><span class="hs-identifier hs-var hs-var">ip_binder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-identifier">bindIP</span><span>        </span><span class="annot"><span class="annottext">DExp -&gt; DType -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppTypeE"><span class="hs-operator hs-var">`DAppTypeE`</span></a></span><span>
</span><span id="line-931"></span><span>                     </span><span class="annot"><span class="annottext">TyLit -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-var">DLitT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TyLit
</span><span class="hs-identifier hs-var">StrTyLit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679412810"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-operator hs-var">`DAppE`</span></a></span><span>
</span><span id="line-932"></span><span>                     </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412808"><span class="hs-identifier hs-var">new_n_name</span></a></span><span>   </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-operator hs-var">`DAppE`</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-933"></span><span>  </span><span class="annot"><span class="annottext">([DLetDec], DExp -&gt; DExp) -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">DLetDec
</span><a href="#local-6989586621679412806"><span class="hs-identifier hs-var">let_dec</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679412805"><span class="hs-identifier hs-var">ip_binder</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span> </span><span id="local-6989586621679412804"><span class="annot"><span class="annottext">_dec :: Dec
</span><a href="#local-6989586621679412804"><span class="hs-identifier hs-var">_dec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Illegal declaration in let expression.&quot;</span></span><span>
</span><span id="line-936"></span><span>
</span><span id="line-937"></span><span class="hs-comment">-- | Desugar a single 'Dec' corresponding to something that could appear after</span><span>
</span><span id="line-938"></span><span class="hs-comment">-- the @let@ in a @let@ expression, but occurring at the top level. Because the</span><span>
</span><span id="line-939"></span><span class="hs-comment">-- 'Dec' occurs at the top level, there is nothing that would correspond to the</span><span>
</span><span id="line-940"></span><span class="hs-comment">-- @in ...@ part of the @let@ expression. As a consequence, this function does</span><span>
</span><span id="line-941"></span><span class="hs-comment">-- not return a @'DExp' -&gt; 'DExp'@ function corresonding to implicit param</span><span>
</span><span id="line-942"></span><span class="hs-comment">-- binders (these cannot occur at the top level).</span><span>
</span><span id="line-943"></span><span id="local-6989586621679412803"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-type">dsTopLevelLetDec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679412803"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dec</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679412803"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDec"><span class="hs-identifier hs-type">DDec</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-944"></span><span id="dsTopLevelLetDec"><span class="annot"><span class="annottext">dsTopLevelLetDec :: Dec -&gt; q [DDec]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTopLevelLetDec"><span class="hs-identifier hs-var hs-var">dsTopLevelLetDec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([DLetDec], DExp -&gt; DExp) -&gt; [DDec])
-&gt; q ([DLetDec], DExp -&gt; DExp) -&gt; q [DDec]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DLetDec -&gt; DDec) -&gt; [DLetDec] -&gt; [DDec]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DLetDec -&gt; DDec
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLetDec"><span class="hs-identifier hs-var">DLetDec</span></a></span><span> </span><span class="annot"><span class="annottext">([DLetDec] -&gt; [DDec])
-&gt; (([DLetDec], DExp -&gt; DExp) -&gt; [DLetDec])
-&gt; ([DLetDec], DExp -&gt; DExp)
-&gt; [DDec]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([DLetDec], DExp -&gt; DExp) -&gt; [DLetDec]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(q ([DLetDec], DExp -&gt; DExp) -&gt; q [DDec])
-&gt; (Dec -&gt; q ([DLetDec], DExp -&gt; DExp)) -&gt; Dec -&gt; q [DDec]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dec -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
Dec -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDec"><span class="hs-identifier hs-var">dsLetDec</span></a></span><span>
</span><span id="line-945"></span><span>  </span><span class="hs-comment">-- Note the use of fst above: we're silently throwing away any implicit param</span><span>
</span><span id="line-946"></span><span>  </span><span class="hs-comment">-- binders that dsLetDec returns, since there is invariant that there will be</span><span>
</span><span id="line-947"></span><span>  </span><span class="hs-comment">-- no implicit params in the first place.</span><span>
</span><span id="line-948"></span><span>
</span><span id="line-949"></span><span class="hs-comment">-- | Desugar a single @Con@.</span><span>
</span><span id="line-950"></span><span class="hs-comment">--</span><span>
</span><span id="line-951"></span><span class="hs-comment">-- Because we always desugar @Con@s to GADT syntax (see the documentation for</span><span>
</span><span id="line-952"></span><span class="hs-comment">-- 'DCon'), it is not always possible to desugar with just a 'Con' alone.</span><span>
</span><span id="line-953"></span><span class="hs-comment">-- For instance, we must desugar:</span><span>
</span><span id="line-954"></span><span class="hs-comment">--</span><span>
</span><span id="line-955"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-956"></span><span class="hs-comment">-- data Foo a = forall b. MkFoo b</span><span>
</span><span id="line-957"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-958"></span><span class="hs-comment">--</span><span>
</span><span id="line-959"></span><span class="hs-comment">-- To this:</span><span>
</span><span id="line-960"></span><span class="hs-comment">--</span><span>
</span><span id="line-961"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-962"></span><span class="hs-comment">-- data Foo a :: Type where</span><span>
</span><span id="line-963"></span><span class="hs-comment">--   MkFoo :: forall a b. b -&gt; Foo a</span><span>
</span><span id="line-964"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-965"></span><span class="hs-comment">--</span><span>
</span><span id="line-966"></span><span class="hs-comment">-- If our only argument was @forall b. MkFoo b@, it would be somewhat awkward</span><span>
</span><span id="line-967"></span><span class="hs-comment">-- to figure out (1) what the set of universally quantified type variables</span><span>
</span><span id="line-968"></span><span class="hs-comment">-- (@[a]@) was, and (2) what the return type (@Foo a@) was. For this reason,</span><span>
</span><span id="line-969"></span><span class="hs-comment">-- we require passing these as arguments. (If we desugar an actual GADT</span><span>
</span><span id="line-970"></span><span class="hs-comment">-- constructor, these arguments are ignored.)</span><span>
</span><span id="line-971"></span><span id="local-6989586621679413811"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon"><span class="hs-identifier hs-type">dsCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413811"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-972"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ The universally quantified type variables</span><span>
</span><span id="line-973"></span><span>                      </span><span class="hs-comment">--   (used if desugaring a non-GADT constructor).</span><span>
</span><span id="line-974"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>        </span><span class="hs-comment">-- ^ The original data declaration's type</span><span>
</span><span id="line-975"></span><span>                      </span><span class="hs-comment">--   (used if desugaring a non-GADT constructor).</span><span>
</span><span id="line-976"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413811"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-type">DCon</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-977"></span><span id="dsCon"><span class="annot"><span class="annottext">dsCon :: [DTyVarBndr] -&gt; DType -&gt; Con -&gt; q [DCon]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCon"><span class="hs-identifier hs-var hs-var">dsCon</span></a></span></span><span> </span><span id="local-6989586621679412801"><span class="annot"><span class="annottext">univ_dtvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679412801"><span class="hs-identifier hs-var">univ_dtvbs</span></a></span></span><span> </span><span id="local-6989586621679412800"><span class="annot"><span class="annottext">data_type :: DType
</span><a href="#local-6989586621679412800"><span class="hs-identifier hs-var">data_type</span></a></span></span><span> </span><span id="local-6989586621679412799"><span class="annot"><span class="annottext">con :: Con
</span><a href="#local-6989586621679412799"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-978"></span><span>  </span><span id="local-6989586621679412798"><span class="annot"><span class="annottext">[(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
</span><a href="#local-6989586621679412798"><span class="hs-identifier hs-var">dcons'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Con -&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall (q :: * -&gt; *).
DsMonad q =&gt;
Con -&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679412799"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-979"></span><span>  </span><span class="annot"><span class="annottext">[DCon] -&gt; q [DCon]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([DCon] -&gt; q [DCon]) -&gt; [DCon] -&gt; q [DCon]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(((Name, [DTyVarBndr], DCxt, DConFields, Maybe DType) -&gt; DCon)
 -&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)] -&gt; [DCon])
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; ((Name, [DTyVarBndr], DCxt, DConFields, Maybe DType) -&gt; DCon)
-&gt; [DCon]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">((Name, [DTyVarBndr], DCxt, DConFields, Maybe DType) -&gt; DCon)
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)] -&gt; [DCon]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
</span><a href="#local-6989586621679412798"><span class="hs-identifier hs-var">dcons'</span></a></span><span> </span><span class="annot"><span class="annottext">(((Name, [DTyVarBndr], DCxt, DConFields, Maybe DType) -&gt; DCon)
 -&gt; [DCon])
-&gt; ((Name, [DTyVarBndr], DCxt, DConFields, Maybe DType) -&gt; DCon)
-&gt; [DCon]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679412795"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412795"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412794"><span class="annot"><span class="annottext">dtvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679412794"><span class="hs-identifier hs-var">dtvbs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412793"><span class="annot"><span class="annottext">dcxt :: DCxt
</span><a href="#local-6989586621679412793"><span class="hs-identifier hs-var">dcxt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412792"><span class="annot"><span class="annottext">fields :: DConFields
</span><a href="#local-6989586621679412792"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412791"><span class="annot"><span class="annottext">m_gadt_type :: Maybe DType
</span><a href="#local-6989586621679412791"><span class="hs-identifier hs-var">m_gadt_type</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-980"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679412791"><span class="hs-identifier hs-var">m_gadt_type</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-981"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-982"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679412790"><span class="annot"><span class="annottext">ex_dtvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679412790"><span class="hs-identifier hs-var hs-var">ex_dtvbs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412794"><span class="hs-identifier hs-var">dtvbs</span></a></span><span>
</span><span id="line-983"></span><span>            </span><span id="local-6989586621679412789"><span class="annot"><span class="annottext">expl_dtvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679412789"><span class="hs-identifier hs-var hs-var">expl_dtvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412801"><span class="hs-identifier hs-var">univ_dtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; [DTyVarBndr] -&gt; [DTyVarBndr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412790"><span class="hs-identifier hs-var">ex_dtvbs</span></a></span><span>
</span><span id="line-984"></span><span>            </span><span id="local-6989586621679412788"><span class="annot"><span class="annottext">impl_dtvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679412788"><span class="hs-identifier hs-var hs-var">impl_dtvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; [DTyVarBndr]
</span><a href="Language.Haskell.TH.Desugar.Core.html#toposortTyVarsOf"><span class="hs-identifier hs-var">toposortTyVarsOf</span></a></span><span> </span><span class="annot"><span class="annottext">(DCxt -&gt; [DTyVarBndr]) -&gt; DCxt -&gt; [DTyVarBndr]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; Maybe DType) -&gt; [DTyVarBndr] -&gt; DCxt
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; Maybe DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#extractTvbKind"><span class="hs-identifier hs-var">extractTvbKind</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412789"><span class="hs-identifier hs-var">expl_dtvbs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-985"></span><span>        </span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; DCxt -&gt; Name -&gt; DConFields -&gt; DType -&gt; DCon
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-var">DCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412788"><span class="hs-identifier hs-var">impl_dtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; [DTyVarBndr] -&gt; [DTyVarBndr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412789"><span class="hs-identifier hs-var">expl_dtvbs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679412793"><span class="hs-identifier hs-var">dcxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412795"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">DConFields
</span><a href="#local-6989586621679412792"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412800"><span class="hs-identifier hs-var">data_type</span></a></span><span>
</span><span id="line-986"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679412784"><span class="annot"><span class="annottext">gadt_type :: DType
</span><a href="#local-6989586621679412784"><span class="hs-identifier hs-var">gadt_type</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-987"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679412783"><span class="annot"><span class="annottext">univ_ex_dtvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679412783"><span class="hs-identifier hs-var hs-var">univ_ex_dtvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412794"><span class="hs-identifier hs-var">dtvbs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-988"></span><span>        </span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; DCxt -&gt; Name -&gt; DConFields -&gt; DType -&gt; DCon
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCon"><span class="hs-identifier hs-var">DCon</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412783"><span class="hs-identifier hs-var">univ_ex_dtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679412793"><span class="hs-identifier hs-var">dcxt</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412795"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">DConFields
</span><a href="#local-6989586621679412792"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412784"><span class="hs-identifier hs-var">gadt_type</span></a></span><span>
</span><span id="line-989"></span><span>
</span><span id="line-990"></span><span class="hs-comment">-- Desugar a Con in isolation. The meaning of the returned DTyVarBndrs changes</span><span>
</span><span id="line-991"></span><span class="hs-comment">-- depending on what the returned Maybe DType value is:</span><span>
</span><span id="line-992"></span><span class="hs-comment">--</span><span>
</span><span id="line-993"></span><span class="hs-comment">-- * If returning Just gadt_ty, then we've encountered a GadtC or RecGadtC,</span><span>
</span><span id="line-994"></span><span class="hs-comment">--   so the returned DTyVarBndrs are both the universally and existentially</span><span>
</span><span id="line-995"></span><span class="hs-comment">--   quantified tyvars.</span><span>
</span><span id="line-996"></span><span class="hs-comment">-- * If returning Nothing, we're dealing with a non-GADT constructor, so</span><span>
</span><span id="line-997"></span><span class="hs-comment">--   the returned DTyVarBndrs are the existentials only.</span><span>
</span><span id="line-998"></span><span id="local-6989586621679413769"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-type">dsCon'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413769"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-999"></span><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Con</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413769"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConFields"><span class="hs-identifier hs-type">DConFields</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-1000"></span><span id="dsCon%27"><span class="annot"><span class="annottext">dsCon' :: Con -&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var hs-var">dsCon'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NormalC</span></span><span> </span><span id="local-6989586621679412782"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412782"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412781"><span class="annot"><span class="annottext">stys :: [BangType]
</span><a href="#local-6989586621679412781"><span class="hs-identifier hs-var">stys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1001"></span><span>  </span><span id="local-6989586621679412780"><span class="annot"><span class="annottext">[DBangType]
</span><a href="#local-6989586621679412780"><span class="hs-identifier hs-var">dtys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(BangType -&gt; q DBangType) -&gt; [BangType] -&gt; q [DBangType]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">BangType -&gt; q DBangType
forall (q :: * -&gt; *). DsMonad q =&gt; BangType -&gt; q DBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBangType"><span class="hs-identifier hs-var">dsBangType</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679412781"><span class="hs-identifier hs-var">stys</span></a></span><span>
</span><span id="line-1002"></span><span>  </span><span class="annot"><span class="annottext">[(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412782"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [DBangType] -&gt; DConFields
</span><a href="Language.Haskell.TH.Desugar.AST.html#DNormalC"><span class="hs-identifier hs-var">DNormalC</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">[DBangType]
</span><a href="#local-6989586621679412780"><span class="hs-identifier hs-var">dtys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe DType
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1003"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecC</span></span><span> </span><span id="local-6989586621679412777"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412777"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412776"><span class="annot"><span class="annottext">vstys :: [VarBangType]
</span><a href="#local-6989586621679412776"><span class="hs-identifier hs-var">vstys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1004"></span><span>  </span><span id="local-6989586621679412775"><span class="annot"><span class="annottext">[DVarBangType]
</span><a href="#local-6989586621679412775"><span class="hs-identifier hs-var">vdtys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarBangType -&gt; q DVarBangType)
-&gt; [VarBangType] -&gt; q [DVarBangType]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">VarBangType -&gt; q DVarBangType
forall (q :: * -&gt; *). DsMonad q =&gt; VarBangType -&gt; q DVarBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsVarBangType"><span class="hs-identifier hs-var">dsVarBangType</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679412776"><span class="hs-identifier hs-var">vstys</span></a></span><span>
</span><span id="line-1005"></span><span>  </span><span class="annot"><span class="annottext">[(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412777"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DVarBangType] -&gt; DConFields
</span><a href="Language.Haskell.TH.Desugar.AST.html#DRecC"><span class="hs-identifier hs-var">DRecC</span></a></span><span> </span><span class="annot"><span class="annottext">[DVarBangType]
</span><a href="#local-6989586621679412775"><span class="hs-identifier hs-var">vdtys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe DType
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1006"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixC</span></span><span> </span><span id="local-6989586621679412772"><span class="annot"><span class="annottext">sty1 :: BangType
</span><a href="#local-6989586621679412772"><span class="hs-identifier hs-var">sty1</span></a></span></span><span> </span><span id="local-6989586621679412771"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412771"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412770"><span class="annot"><span class="annottext">sty2 :: BangType
</span><a href="#local-6989586621679412770"><span class="hs-identifier hs-var">sty2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1007"></span><span>  </span><span id="local-6989586621679412769"><span class="annot"><span class="annottext">DBangType
</span><a href="#local-6989586621679412769"><span class="hs-identifier hs-var">dty1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BangType -&gt; q DBangType
forall (q :: * -&gt; *). DsMonad q =&gt; BangType -&gt; q DBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBangType"><span class="hs-identifier hs-var">dsBangType</span></a></span><span> </span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679412772"><span class="hs-identifier hs-var">sty1</span></a></span><span>
</span><span id="line-1008"></span><span>  </span><span id="local-6989586621679412768"><span class="annot"><span class="annottext">DBangType
</span><a href="#local-6989586621679412768"><span class="hs-identifier hs-var">dty2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BangType -&gt; q DBangType
forall (q :: * -&gt; *). DsMonad q =&gt; BangType -&gt; q DBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBangType"><span class="hs-identifier hs-var">dsBangType</span></a></span><span> </span><span class="annot"><span class="annottext">BangType
</span><a href="#local-6989586621679412770"><span class="hs-identifier hs-var">sty2</span></a></span><span>
</span><span id="line-1009"></span><span>  </span><span class="annot"><span class="annottext">[(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412771"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [DBangType] -&gt; DConFields
</span><a href="Language.Haskell.TH.Desugar.AST.html#DNormalC"><span class="hs-identifier hs-var">DNormalC</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DBangType
</span><a href="#local-6989586621679412769"><span class="hs-identifier hs-var">dty1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DBangType
</span><a href="#local-6989586621679412768"><span class="hs-identifier hs-var">dty2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe DType
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1010"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallC</span></span><span> </span><span id="local-6989586621679412767"><span class="annot"><span class="annottext">tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679412767"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679412766"><span class="annot"><span class="annottext">cxt :: Cxt
</span><a href="#local-6989586621679412766"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679412765"><span class="annot"><span class="annottext">con :: Con
</span><a href="#local-6989586621679412765"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1011"></span><span>  </span><span id="local-6989586621679412764"><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412764"><span class="hs-identifier hs-var">dtvbs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679412767"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-1012"></span><span>  </span><span id="local-6989586621679412763"><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679412763"><span class="hs-identifier hs-var">dcxt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Cxt -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679412766"><span class="hs-identifier hs-var">cxt</span></a></span><span>
</span><span id="line-1013"></span><span>  </span><span id="local-6989586621679412762"><span class="annot"><span class="annottext">[(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
</span><a href="#local-6989586621679412762"><span class="hs-identifier hs-var">dcons'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Con -&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall (q :: * -&gt; *).
DsMonad q =&gt;
Con -&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="annot"><span class="annottext">Con
</span><a href="#local-6989586621679412765"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-1014"></span><span>  </span><span class="annot"><span class="annottext">[(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
 -&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)])
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(((Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)
  -&gt; (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
 -&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
 -&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)])
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; ((Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)
    -&gt; (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">((Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)
 -&gt; (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
</span><a href="#local-6989586621679412762"><span class="hs-identifier hs-var">dcons'</span></a></span><span> </span><span class="annot"><span class="annottext">(((Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)
  -&gt; (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
 -&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)])
-&gt; ((Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)
    -&gt; (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679412761"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412761"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412760"><span class="annot"><span class="annottext">dtvbs' :: [DTyVarBndr]
</span><a href="#local-6989586621679412760"><span class="hs-identifier hs-var">dtvbs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412759"><span class="annot"><span class="annottext">dcxt' :: DCxt
</span><a href="#local-6989586621679412759"><span class="hs-identifier hs-var">dcxt'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412758"><span class="annot"><span class="annottext">fields :: DConFields
</span><a href="#local-6989586621679412758"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412757"><span class="annot"><span class="annottext">m_gadt_type :: Maybe DType
</span><a href="#local-6989586621679412757"><span class="hs-identifier hs-var">m_gadt_type</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1015"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412761"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412764"><span class="hs-identifier hs-var">dtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; [DTyVarBndr] -&gt; [DTyVarBndr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412760"><span class="hs-identifier hs-var">dtvbs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679412763"><span class="hs-identifier hs-var">dcxt</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; DCxt -&gt; DCxt
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679412759"><span class="hs-identifier hs-var">dcxt'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DConFields
</span><a href="#local-6989586621679412758"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe DType
</span><a href="#local-6989586621679412757"><span class="hs-identifier hs-var">m_gadt_type</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GadtC</span></span><span> </span><span id="local-6989586621679412756"><span class="annot"><span class="annottext">nms :: [Name]
</span><a href="#local-6989586621679412756"><span class="hs-identifier hs-var">nms</span></a></span></span><span> </span><span id="local-6989586621679412755"><span class="annot"><span class="annottext">btys :: [BangType]
</span><a href="#local-6989586621679412755"><span class="hs-identifier hs-var">btys</span></a></span></span><span> </span><span id="local-6989586621679412754"><span class="annot"><span class="annottext">rty :: Type
</span><a href="#local-6989586621679412754"><span class="hs-identifier hs-var">rty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1018"></span><span>  </span><span id="local-6989586621679412753"><span class="annot"><span class="annottext">[DBangType]
</span><a href="#local-6989586621679412753"><span class="hs-identifier hs-var">dbtys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(BangType -&gt; q DBangType) -&gt; [BangType] -&gt; q [DBangType]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">BangType -&gt; q DBangType
forall (q :: * -&gt; *). DsMonad q =&gt; BangType -&gt; q DBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBangType"><span class="hs-identifier hs-var">dsBangType</span></a></span><span> </span><span class="annot"><span class="annottext">[BangType]
</span><a href="#local-6989586621679412755"><span class="hs-identifier hs-var">btys</span></a></span><span>
</span><span id="line-1019"></span><span>  </span><span id="local-6989586621679412752"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412752"><span class="hs-identifier hs-var">drty</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412754"><span class="hs-identifier hs-var">rty</span></a></span><span>
</span><span id="line-1020"></span><span>  </span><span class="annot"><span class="annottext">[q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">([q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
 -&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)])
-&gt; [q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Name -&gt; q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
 -&gt; [Name]
 -&gt; [q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)])
-&gt; [Name]
-&gt; (Name -&gt; q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
-&gt; [q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
-&gt; [Name]
-&gt; [q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679412756"><span class="hs-identifier hs-var">nms</span></a></span><span> </span><span class="annot"><span class="annottext">((Name -&gt; q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
 -&gt; [q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)])
-&gt; (Name -&gt; q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
-&gt; [q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679412750"><span class="annot"><span class="annottext">nm :: Name
</span><a href="#local-6989586621679412750"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1021"></span><span>    </span><span id="local-6989586621679412749"><span class="annot"><span class="annottext">Maybe Fixity
</span><a href="#local-6989586621679412749"><span class="hs-identifier hs-var">mbFi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q (Maybe Fixity)
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q (Maybe Fixity)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyFixityWithLocals"><span class="hs-identifier hs-var">reifyFixityWithLocals</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412750"><span class="hs-identifier hs-var">nm</span></a></span><span>
</span><span id="line-1022"></span><span>    </span><span class="hs-comment">-- A GADT data constructor is declared infix when these three</span><span>
</span><span id="line-1023"></span><span>    </span><span class="hs-comment">-- properties hold:</span><span>
</span><span id="line-1024"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679412747"><span class="annot"><span class="annottext">decInfix :: Bool
</span><a href="#local-6989586621679412747"><span class="hs-identifier hs-var hs-var">decInfix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="Language.Haskell.TH.Desugar.Util.html#isInfixDataCon"><span class="hs-identifier hs-var">isInfixDataCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412750"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- 1. Its name uses operator syntax</span><span>
</span><span id="line-1025"></span><span>                                                </span><span class="hs-comment">--    (e.g., (:*:))</span><span>
</span><span id="line-1026"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[DBangType] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[DBangType]
</span><a href="#local-6989586621679412753"><span class="hs-identifier hs-var">dbtys</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span>            </span><span class="hs-comment">-- 2. It has exactly two fields</span><span>
</span><span id="line-1027"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Maybe Fixity -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe Fixity
</span><a href="#local-6989586621679412749"><span class="hs-identifier hs-var">mbFi</span></a></span><span>                  </span><span class="hs-comment">-- 3. It has a programmer-specified</span><span>
</span><span id="line-1028"></span><span>                                                </span><span class="hs-comment">--    fixity declaration</span><span>
</span><span id="line-1029"></span><span>    </span><span class="annot"><span class="annottext">(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)
-&gt; q (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412750"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [DBangType] -&gt; DConFields
</span><a href="Language.Haskell.TH.Desugar.AST.html#DNormalC"><span class="hs-identifier hs-var">DNormalC</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679412747"><span class="hs-identifier hs-var">decInfix</span></a></span><span> </span><span class="annot"><span class="annottext">[DBangType]
</span><a href="#local-6989586621679412753"><span class="hs-identifier hs-var">dbtys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Maybe DType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412752"><span class="hs-identifier hs-var">drty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1030"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCon%27"><span class="hs-identifier hs-var">dsCon'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RecGadtC</span></span><span> </span><span id="local-6989586621679412744"><span class="annot"><span class="annottext">nms :: [Name]
</span><a href="#local-6989586621679412744"><span class="hs-identifier hs-var">nms</span></a></span></span><span> </span><span id="local-6989586621679412743"><span class="annot"><span class="annottext">vbtys :: [VarBangType]
</span><a href="#local-6989586621679412743"><span class="hs-identifier hs-var">vbtys</span></a></span></span><span> </span><span id="local-6989586621679412742"><span class="annot"><span class="annottext">rty :: Type
</span><a href="#local-6989586621679412742"><span class="hs-identifier hs-var">rty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1031"></span><span>  </span><span id="local-6989586621679412741"><span class="annot"><span class="annottext">[DVarBangType]
</span><a href="#local-6989586621679412741"><span class="hs-identifier hs-var">dvbtys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(VarBangType -&gt; q DVarBangType)
-&gt; [VarBangType] -&gt; q [DVarBangType]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">VarBangType -&gt; q DVarBangType
forall (q :: * -&gt; *). DsMonad q =&gt; VarBangType -&gt; q DVarBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsVarBangType"><span class="hs-identifier hs-var">dsVarBangType</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679412743"><span class="hs-identifier hs-var">vbtys</span></a></span><span>
</span><span id="line-1032"></span><span>  </span><span id="local-6989586621679412740"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412740"><span class="hs-identifier hs-var">drty</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412742"><span class="hs-identifier hs-var">rty</span></a></span><span>
</span><span id="line-1033"></span><span>  </span><span class="annot"><span class="annottext">[(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
 -&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)])
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
-&gt; q [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Name -&gt; (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
 -&gt; [Name] -&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)])
-&gt; [Name]
-&gt; (Name -&gt; (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
-&gt; [Name] -&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679412744"><span class="hs-identifier hs-var">nms</span></a></span><span> </span><span class="annot"><span class="annottext">((Name -&gt; (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
 -&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)])
-&gt; (Name -&gt; (Name, [DTyVarBndr], DCxt, DConFields, Maybe DType))
-&gt; [(Name, [DTyVarBndr], DCxt, DConFields, Maybe DType)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679412739"><span class="annot"><span class="annottext">nm :: Name
</span><a href="#local-6989586621679412739"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1034"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412739"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DVarBangType] -&gt; DConFields
</span><a href="Language.Haskell.TH.Desugar.AST.html#DRecC"><span class="hs-identifier hs-var">DRecC</span></a></span><span> </span><span class="annot"><span class="annottext">[DVarBangType]
</span><a href="#local-6989586621679412741"><span class="hs-identifier hs-var">dvbtys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Maybe DType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412740"><span class="hs-identifier hs-var">drty</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="hs-comment">-- | Desugar a @BangType@ (or a @StrictType@, if you're old-fashioned)</span><span>
</span><span id="line-1039"></span><span id="local-6989586621679413761"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsBangType"><span class="hs-identifier hs-type">dsBangType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413761"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">BangType</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413761"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DBangType"><span class="hs-identifier hs-type">DBangType</span></a></span></span><span>
</span><span id="line-1040"></span><span id="dsBangType"><span class="annot"><span class="annottext">dsBangType :: BangType -&gt; q DBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBangType"><span class="hs-identifier hs-var hs-var">dsBangType</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679412738"><span class="annot"><span class="annottext">b :: Bang
</span><a href="#local-6989586621679412738"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412737"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679412737"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bang
</span><a href="#local-6989586621679412738"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DBangType) -&gt; q DType -&gt; q DBangType
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412737"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1041"></span><span>
</span><span id="line-1042"></span><span class="hs-comment">-- | Desugar a @VarBangType@ (or a @VarStrictType@, if you're old-fashioned)</span><span>
</span><span id="line-1043"></span><span id="local-6989586621679413759"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsVarBangType"><span class="hs-identifier hs-type">dsVarBangType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413759"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VarBangType</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413759"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarBangType"><span class="hs-identifier hs-type">DVarBangType</span></a></span></span><span>
</span><span id="line-1044"></span><span id="dsVarBangType"><span class="annot"><span class="annottext">dsVarBangType :: VarBangType -&gt; q DVarBangType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsVarBangType"><span class="hs-identifier hs-var hs-var">dsVarBangType</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679412736"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412736"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412735"><span class="annot"><span class="annottext">b :: Bang
</span><a href="#local-6989586621679412735"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412734"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679412734"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412736"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bang
</span><a href="#local-6989586621679412735"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DVarBangType) -&gt; q DType -&gt; q DVarBangType
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412734"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- | Desugar a @BangType@ (or a @StrictType@, if you're old-fashioned)</span><span>
</span><span id="line-1047"></span><span class="hs-identifier">dsBangType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">StrictType</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DBangType</span><span>
</span><span id="line-1048"></span><span class="hs-identifier">dsBangType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ty</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">strictToBang</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">ty</span><span>
</span><span id="line-1049"></span><span>
</span><span id="line-1050"></span><span class="hs-comment">-- | Desugar a @VarBangType@ (or a @VarStrictType@, if you're old-fashioned)</span><span>
</span><span id="line-1051"></span><span class="hs-identifier">dsVarBangType</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">VarStrictType</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DVarBangType</span><span>
</span><span id="line-1052"></span><span class="hs-identifier">dsVarBangType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ty</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">n</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">strictToBang</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">ty</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1055"></span><span class="hs-comment">-- | Desugar a @Foreign@.</span><span>
</span><span id="line-1056"></span><span id="local-6989586621679413836"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsForeign"><span class="hs-identifier hs-type">dsForeign</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413836"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foreign</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413836"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForeign"><span class="hs-identifier hs-type">DForeign</span></a></span></span><span>
</span><span id="line-1057"></span><span id="dsForeign"><span class="annot"><span class="annottext">dsForeign :: Foreign -&gt; q DForeign
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsForeign"><span class="hs-identifier hs-var hs-var">dsForeign</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImportF</span></span><span> </span><span id="local-6989586621679412732"><span class="annot"><span class="annottext">cc :: Callconv
</span><a href="#local-6989586621679412732"><span class="hs-identifier hs-var">cc</span></a></span></span><span> </span><span id="local-6989586621679412731"><span class="annot"><span class="annottext">safety :: Safety
</span><a href="#local-6989586621679412731"><span class="hs-identifier hs-var">safety</span></a></span></span><span> </span><span id="local-6989586621679412730"><span class="annot"><span class="annottext">str :: String
</span><a href="#local-6989586621679412730"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679412729"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412729"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412728"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679412728"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Callconv -&gt; Safety -&gt; String -&gt; Name -&gt; DType -&gt; DForeign
</span><a href="Language.Haskell.TH.Desugar.AST.html#DImportF"><span class="hs-identifier hs-var">DImportF</span></a></span><span> </span><span class="annot"><span class="annottext">Callconv
</span><a href="#local-6989586621679412732"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">Safety
</span><a href="#local-6989586621679412731"><span class="hs-identifier hs-var">safety</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679412730"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412729"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DForeign) -&gt; q DType -&gt; q DForeign
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412728"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1058"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsForeign"><span class="hs-identifier hs-var">dsForeign</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExportF</span></span><span> </span><span id="local-6989586621679412725"><span class="annot"><span class="annottext">cc :: Callconv
</span><a href="#local-6989586621679412725"><span class="hs-identifier hs-var">cc</span></a></span></span><span> </span><span id="local-6989586621679412724"><span class="annot"><span class="annottext">str :: String
</span><a href="#local-6989586621679412724"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679412723"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412723"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412722"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679412722"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Callconv -&gt; String -&gt; Name -&gt; DType -&gt; DForeign
</span><a href="Language.Haskell.TH.Desugar.AST.html#DExportF"><span class="hs-identifier hs-var">DExportF</span></a></span><span> </span><span class="annot"><span class="annottext">Callconv
</span><a href="#local-6989586621679412725"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679412724"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412723"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DForeign) -&gt; q DType -&gt; q DForeign
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412722"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1059"></span><span>
</span><span id="line-1060"></span><span class="hs-comment">-- | Desugar a @Pragma@.</span><span>
</span><span id="line-1061"></span><span id="local-6989586621679413773"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-type">dsPragma</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413773"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pragma</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413773"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPragma"><span class="hs-identifier hs-type">DPragma</span></a></span></span><span>
</span><span id="line-1062"></span><span id="dsPragma"><span class="annot"><span class="annottext">dsPragma :: Pragma -&gt; q DPragma
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var hs-var">dsPragma</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InlineP</span></span><span> </span><span id="local-6989586621679412719"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412719"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412718"><span class="annot"><span class="annottext">inl :: Inline
</span><a href="#local-6989586621679412718"><span class="hs-identifier hs-var">inl</span></a></span></span><span> </span><span id="local-6989586621679412717"><span class="annot"><span class="annottext">rm :: RuleMatch
</span><a href="#local-6989586621679412717"><span class="hs-identifier hs-var">rm</span></a></span></span><span> </span><span id="local-6989586621679412716"><span class="annot"><span class="annottext">phases :: Phases
</span><a href="#local-6989586621679412716"><span class="hs-identifier hs-var">phases</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPragma -&gt; q DPragma
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DPragma -&gt; q DPragma) -&gt; DPragma -&gt; q DPragma
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Inline -&gt; RuleMatch -&gt; Phases -&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DInlineP"><span class="hs-identifier hs-var">DInlineP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412719"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Inline
</span><a href="#local-6989586621679412718"><span class="hs-identifier hs-var">inl</span></a></span><span> </span><span class="annot"><span class="annottext">RuleMatch
</span><a href="#local-6989586621679412717"><span class="hs-identifier hs-var">rm</span></a></span><span> </span><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679412716"><span class="hs-identifier hs-var">phases</span></a></span><span>
</span><span id="line-1063"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SpecialiseP</span></span><span> </span><span id="local-6989586621679412713"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412713"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412712"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679412712"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679412711"><span class="annot"><span class="annottext">m_inl :: Maybe Inline
</span><a href="#local-6989586621679412711"><span class="hs-identifier hs-var">m_inl</span></a></span></span><span> </span><span id="local-6989586621679412710"><span class="annot"><span class="annottext">phases :: Phases
</span><a href="#local-6989586621679412710"><span class="hs-identifier hs-var">phases</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; Maybe Inline -&gt; Phases -&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSpecialiseP"><span class="hs-identifier hs-var">DSpecialiseP</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412713"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; Maybe Inline -&gt; Phases -&gt; DPragma)
-&gt; q DType -&gt; q (Maybe Inline -&gt; Phases -&gt; DPragma)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412712"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1064"></span><span>                                                          </span><span class="annot"><span class="annottext">q (Maybe Inline -&gt; Phases -&gt; DPragma)
-&gt; q (Maybe Inline) -&gt; q (Phases -&gt; DPragma)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Inline -&gt; q (Maybe Inline)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Inline
</span><a href="#local-6989586621679412711"><span class="hs-identifier hs-var">m_inl</span></a></span><span>
</span><span id="line-1065"></span><span>                                                          </span><span class="annot"><span class="annottext">q (Phases -&gt; DPragma) -&gt; q Phases -&gt; q DPragma
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Phases -&gt; q Phases
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679412710"><span class="hs-identifier hs-var">phases</span></a></span><span>
</span><span id="line-1066"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SpecialiseInstP</span></span><span> </span><span id="local-6989586621679412707"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679412707"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSpecialiseInstP"><span class="hs-identifier hs-var">DSpecialiseInstP</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DPragma) -&gt; q DType -&gt; q DPragma
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412707"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RuleP</span></span><span> </span><span id="local-6989586621679412704"><span class="annot"><span class="annottext">str :: String
</span><a href="#local-6989586621679412704"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679412703"><span class="annot"><span class="annottext">mtvbs :: Maybe [TyVarBndr]
</span><a href="#local-6989586621679412703"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679412702"><span class="annot"><span class="annottext">rbs :: [RuleBndr]
</span><a href="#local-6989586621679412702"><span class="hs-identifier hs-var">rbs</span></a></span></span><span> </span><span id="local-6989586621679412701"><span class="annot"><span class="annottext">lhs :: Exp
</span><a href="#local-6989586621679412701"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679412700"><span class="annot"><span class="annottext">rhs :: Exp
</span><a href="#local-6989586621679412700"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621679412699"><span class="annot"><span class="annottext">phases :: Phases
</span><a href="#local-6989586621679412699"><span class="hs-identifier hs-var">phases</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1069"></span><span>                                         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Maybe [DTyVarBndr]
-&gt; [DRuleBndr]
-&gt; DExp
-&gt; DExp
-&gt; Phases
-&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DRuleP"><span class="hs-identifier hs-var">DRuleP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679412704"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [DTyVarBndr]
 -&gt; [DRuleBndr] -&gt; DExp -&gt; DExp -&gt; Phases -&gt; DPragma)
-&gt; q (Maybe [DTyVarBndr])
-&gt; q ([DRuleBndr] -&gt; DExp -&gt; DExp -&gt; Phases -&gt; DPragma)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">([TyVarBndr] -&gt; q [DTyVarBndr])
-&gt; Maybe [TyVarBndr] -&gt; q (Maybe [DTyVarBndr])
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndr]
</span><a href="#local-6989586621679412703"><span class="hs-identifier hs-var">mtvbs</span></a></span><span>
</span><span id="line-1070"></span><span>                                                      </span><span class="annot"><span class="annottext">q ([DRuleBndr] -&gt; DExp -&gt; DExp -&gt; Phases -&gt; DPragma)
-&gt; q [DRuleBndr] -&gt; q (DExp -&gt; DExp -&gt; Phases -&gt; DPragma)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(RuleBndr -&gt; q DRuleBndr) -&gt; [RuleBndr] -&gt; q [DRuleBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">RuleBndr -&gt; q DRuleBndr
forall (q :: * -&gt; *). DsMonad q =&gt; RuleBndr -&gt; q DRuleBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsRuleBndr"><span class="hs-identifier hs-var">dsRuleBndr</span></a></span><span> </span><span class="annot"><span class="annottext">[RuleBndr]
</span><a href="#local-6989586621679412702"><span class="hs-identifier hs-var">rbs</span></a></span><span>
</span><span id="line-1071"></span><span>                                                      </span><span class="annot"><span class="annottext">q (DExp -&gt; DExp -&gt; Phases -&gt; DPragma)
-&gt; q DExp -&gt; q (DExp -&gt; Phases -&gt; DPragma)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679412701"><span class="hs-identifier hs-var">lhs</span></a></span><span>
</span><span id="line-1072"></span><span>                                                      </span><span class="annot"><span class="annottext">q (DExp -&gt; Phases -&gt; DPragma) -&gt; q DExp -&gt; q (Phases -&gt; DPragma)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679412700"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1073"></span><span>                                                      </span><span class="annot"><span class="annottext">q (Phases -&gt; DPragma) -&gt; q Phases -&gt; q DPragma
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Phases -&gt; q Phases
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Phases
</span><a href="#local-6989586621679412699"><span class="hs-identifier hs-var">phases</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">dsPragma</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">RuleP</span><span> </span><span class="hs-identifier">str</span><span> </span><span class="hs-identifier">rbs</span><span> </span><span class="hs-identifier">lhs</span><span> </span><span class="hs-identifier">rhs</span><span> </span><span class="hs-identifier">phases</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">DRuleP</span><span> </span><span class="hs-identifier">str</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-1076"></span><span>                                                      </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsRuleBndr</span><span> </span><span class="hs-identifier">rbs</span><span>
</span><span id="line-1077"></span><span>                                                      </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">dsExp</span><span> </span><span class="hs-identifier">lhs</span><span>
</span><span id="line-1078"></span><span>                                                      </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">dsExp</span><span> </span><span class="hs-identifier">rhs</span><span>
</span><span id="line-1079"></span><span>                                                      </span><span class="hs-operator">&lt;*&gt;</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-identifier">phases</span><span class="hs-cpp">
#endif
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AnnP</span></span><span> </span><span id="local-6989586621679412695"><span class="annot"><span class="annottext">target :: AnnTarget
</span><a href="#local-6989586621679412695"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span id="local-6989586621679412694"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679412694"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnnTarget -&gt; DExp -&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAnnP"><span class="hs-identifier hs-var">DAnnP</span></a></span><span> </span><span class="annot"><span class="annottext">AnnTarget
</span><a href="#local-6989586621679412695"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DPragma) -&gt; q DExp -&gt; q DPragma
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679412694"><span class="hs-identifier hs-var">exp</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 709
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LineP</span></span><span> </span><span id="local-6989586621679412691"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679412691"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412690"><span class="annot"><span class="annottext">str :: String
</span><a href="#local-6989586621679412690"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPragma -&gt; q DPragma
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DPragma -&gt; q DPragma) -&gt; DPragma -&gt; q DPragma
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLineP"><span class="hs-identifier hs-var">DLineP</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679412691"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679412690"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPragma"><span class="hs-identifier hs-var">dsPragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CompleteP</span></span><span> </span><span id="local-6989586621679412687"><span class="annot"><span class="annottext">cls :: [Name]
</span><a href="#local-6989586621679412687"><span class="hs-identifier hs-var">cls</span></a></span></span><span> </span><span id="local-6989586621679412686"><span class="annot"><span class="annottext">mty :: Maybe Name
</span><a href="#local-6989586621679412686"><span class="hs-identifier hs-var">mty</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPragma -&gt; q DPragma
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DPragma -&gt; q DPragma) -&gt; DPragma -&gt; q DPragma
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Maybe Name -&gt; DPragma
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCompleteP"><span class="hs-identifier hs-var">DCompleteP</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679412687"><span class="hs-identifier hs-var">cls</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621679412686"><span class="hs-identifier hs-var">mty</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1089"></span><span class="hs-comment">-- | Desugar a @RuleBndr@.</span><span>
</span><span id="line-1090"></span><span id="local-6989586621679413742"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsRuleBndr"><span class="hs-identifier hs-type">dsRuleBndr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413742"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RuleBndr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413742"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DRuleBndr"><span class="hs-identifier hs-type">DRuleBndr</span></a></span></span><span>
</span><span id="line-1091"></span><span id="dsRuleBndr"><span class="annot"><span class="annottext">dsRuleBndr :: RuleBndr -&gt; q DRuleBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsRuleBndr"><span class="hs-identifier hs-var hs-var">dsRuleBndr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RuleVar</span></span><span> </span><span id="local-6989586621679412683"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412683"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DRuleBndr -&gt; q DRuleBndr
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DRuleBndr -&gt; q DRuleBndr) -&gt; DRuleBndr -&gt; q DRuleBndr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DRuleBndr
</span><a href="Language.Haskell.TH.Desugar.AST.html#DRuleVar"><span class="hs-identifier hs-var">DRuleVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412683"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1092"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsRuleBndr"><span class="hs-identifier hs-var">dsRuleBndr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TypedRuleVar</span></span><span> </span><span id="local-6989586621679412680"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412680"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412679"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679412679"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; DRuleBndr
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTypedRuleVar"><span class="hs-identifier hs-var">DTypedRuleVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412680"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DRuleBndr) -&gt; q DType -&gt; q DRuleBndr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412679"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="hs-comment">-- | Desugar a @TySynEqn@. (Available only with GHC 7.8+)</span><span>
</span><span id="line-1096"></span><span class="hs-comment">--</span><span>
</span><span id="line-1097"></span><span class="hs-comment">-- This requires a 'Name' as an argument since 'TySynEqn's did not have</span><span>
</span><span id="line-1098"></span><span class="hs-comment">-- this information prior to GHC 8.8.</span><span>
</span><span id="line-1099"></span><span id="local-6989586621679413826"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTySynEqn"><span class="hs-identifier hs-type">dsTySynEqn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413826"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TySynEqn</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413826"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTySynEqn"><span class="hs-identifier hs-type">DTySynEqn</span></a></span></span><span>
</span><span id="line-1100"></span><span id="dsTySynEqn"><span class="annot"><span class="annottext">dsTySynEqn :: Name -&gt; TySynEqn -&gt; q DTySynEqn
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTySynEqn"><span class="hs-identifier hs-var hs-var">dsTySynEqn</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TySynEqn</span></span><span> </span><span id="local-6989586621679412676"><span class="annot"><span class="annottext">mtvbs :: Maybe [TyVarBndr]
</span><a href="#local-6989586621679412676"><span class="hs-identifier hs-var">mtvbs</span></a></span></span><span> </span><span id="local-6989586621679412675"><span class="annot"><span class="annottext">lhs :: Type
</span><a href="#local-6989586621679412675"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621679412674"><span class="annot"><span class="annottext">rhs :: Type
</span><a href="#local-6989586621679412674"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1101"></span><span>  </span><span class="annot"><span class="annottext">Maybe [DTyVarBndr] -&gt; DType -&gt; DType -&gt; DTySynEqn
</span><a href="Language.Haskell.TH.Desugar.AST.html#DTySynEqn"><span class="hs-identifier hs-var">DTySynEqn</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [DTyVarBndr] -&gt; DType -&gt; DType -&gt; DTySynEqn)
-&gt; q (Maybe [DTyVarBndr]) -&gt; q (DType -&gt; DType -&gt; DTySynEqn)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">([TyVarBndr] -&gt; q [DTyVarBndr])
-&gt; Maybe [TyVarBndr] -&gt; q (Maybe [DTyVarBndr])
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [TyVarBndr]
</span><a href="#local-6989586621679412676"><span class="hs-identifier hs-var">mtvbs</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DType -&gt; DTySynEqn)
-&gt; q DType -&gt; q (DType -&gt; DTySynEqn)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412675"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DTySynEqn) -&gt; q DType -&gt; q DTySynEqn
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412674"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-comment">-- | Desugar a @TySynEqn@. (Available only with GHC 7.8+)</span><span>
</span><span id="line-1104"></span><span class="hs-identifier">dsTySynEqn</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Name</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">TySynEqn</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DTySynEqn</span><span>
</span><span id="line-1105"></span><span class="hs-identifier">dsTySynEqn</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">TySynEqn</span><span> </span><span class="hs-identifier">lhss</span><span> </span><span class="hs-identifier">rhs</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1106"></span><span>  </span><span class="hs-identifier">lhss'</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">lhss</span><span>
</span><span id="line-1107"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">lhs'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">applyDType</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DConT</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">DTANormal</span><span> </span><span class="hs-identifier">lhss'</span><span>
</span><span id="line-1108"></span><span>  </span><span class="hs-identifier">DTySynEqn</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-identifier">lhs'</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">rhs</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1111"></span><span class="hs-comment">-- | Desugar clauses to a function definition</span><span>
</span><span id="line-1112"></span><span id="local-6989586621679413777"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-type">dsClauses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413777"><span class="hs-identifier hs-type">q</span></a></span><span>
</span><span id="line-1113"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>         </span><span class="hs-comment">-- ^ Name of the function</span><span>
</span><span id="line-1114"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Clause</span></span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- ^ Clauses to desugar</span><span>
</span><span id="line-1115"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413777"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DClause"><span class="hs-identifier hs-type">DClause</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1116"></span><span id="dsClauses"><span class="annot"><span class="annottext">dsClauses :: Name -&gt; [Clause] -&gt; q [DClause]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-var hs-var">dsClauses</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DClause] -&gt; q [DClause]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1117"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-var">dsClauses</span></a></span><span> </span><span id="local-6989586621679412672"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412672"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Clause</span></span><span> </span><span id="local-6989586621679412670"><span class="annot"><span class="annottext">pats :: [Pat]
</span><a href="#local-6989586621679412670"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NormalB</span></span><span> </span><span id="local-6989586621679412669"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679412669"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679412668"><span class="annot"><span class="annottext">where_decs :: [Dec]
</span><a href="#local-6989586621679412668"><span class="hs-identifier hs-var">where_decs</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679412667"><span class="annot"><span class="annottext">rest :: [Clause]
</span><a href="#local-6989586621679412667"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1118"></span><span>  </span><span class="hs-comment">-- this case is necessary to maintain the roundtrip property.</span><span>
</span><span id="line-1119"></span><span>  </span><span id="local-6989586621679412666"><span class="annot"><span class="annottext">[DClause]
</span><a href="#local-6989586621679412666"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Clause] -&gt; q [DClause]
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; [Clause] -&gt; q [DClause]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-var">dsClauses</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412672"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621679412667"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1120"></span><span>  </span><span id="local-6989586621679412665"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679412665"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679412669"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-1121"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679412664"><span class="annot"><span class="annottext">where_decs' :: [DLetDec]
</span><a href="#local-6989586621679412664"><span class="hs-identifier hs-var">where_decs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412663"><span class="annot"><span class="annottext">ip_binder :: DExp -&gt; DExp
</span><a href="#local-6989586621679412663"><span class="hs-identifier hs-var">ip_binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Dec] -&gt; q ([DLetDec], DExp -&gt; DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsLetDecs"><span class="hs-identifier hs-var">dsLetDecs</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679412668"><span class="hs-identifier hs-var">where_decs</span></a></span><span>
</span><span id="line-1122"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679412662"><span class="annot"><span class="annottext">exp_with_wheres :: DExp
</span><a href="#local-6989586621679412662"><span class="hs-identifier hs-var hs-var">exp_with_wheres</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DLetDec] -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDLetE"><span class="hs-identifier hs-var">maybeDLetE</span></a></span><span> </span><span class="annot"><span class="annottext">[DLetDec]
</span><a href="#local-6989586621679412664"><span class="hs-identifier hs-var">where_decs'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; DExp
</span><a href="#local-6989586621679412663"><span class="hs-identifier hs-var">ip_binder</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679412665"><span class="hs-identifier hs-var">exp'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1123"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679412661"><span class="annot"><span class="annottext">pats' :: [DPat]
</span><a href="#local-6989586621679412661"><span class="hs-identifier hs-var">pats'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412660"><span class="annot"><span class="annottext">exp'' :: DExp
</span><a href="#local-6989586621679412660"><span class="hs-identifier hs-var">exp''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; DExp -&gt; q ([DPat], DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Pat] -&gt; DExp -&gt; q ([DPat], DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatsOverExp"><span class="hs-identifier hs-var">dsPatsOverExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679412670"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679412662"><span class="hs-identifier hs-var">exp_with_wheres</span></a></span><span>
</span><span id="line-1124"></span><span>  </span><span class="annot"><span class="annottext">[DClause] -&gt; q [DClause]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([DClause] -&gt; q [DClause]) -&gt; [DClause] -&gt; q [DClause]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[DPat] -&gt; DExp -&gt; DClause
</span><a href="Language.Haskell.TH.Desugar.AST.html#DClause"><span class="hs-identifier hs-var">DClause</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679412661"><span class="hs-identifier hs-var">pats'</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679412660"><span class="hs-identifier hs-var">exp''</span></a></span><span> </span><span class="annot"><span class="annottext">DClause -&gt; [DClause] -&gt; [DClause]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[DClause]
</span><a href="#local-6989586621679412666"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-1125"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-var">dsClauses</span></a></span><span> </span><span id="local-6989586621679412658"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412658"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412657"><span class="annot"><span class="annottext">clauses :: [Clause]
</span><a href="#local-6989586621679412657"><span class="hs-identifier hs-var">clauses</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Clause</span></span><span> </span><span id="local-6989586621679412656"><span class="annot"><span class="annottext">outer_pats :: [Pat]
</span><a href="#local-6989586621679412656"><span class="hs-identifier hs-var">outer_pats</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1126"></span><span>  </span><span id="local-6989586621679412655"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679412655"><span class="hs-identifier hs-var">arg_names</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; q Name -&gt; q [Name]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pat] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679412656"><span class="hs-identifier hs-var">outer_pats</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; q Name
forall (q :: * -&gt; *). Quasi q =&gt; String -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#newUniqueName"><span class="hs-identifier hs-var">newUniqueName</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;arg&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1127"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679412654"><span class="annot"><span class="annottext">scrutinee :: DExp
</span><a href="#local-6989586621679412654"><span class="hs-identifier hs-var hs-var">scrutinee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DExp] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDExp"><span class="hs-identifier hs-var">mkTupleDExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; DExp) -&gt; [Name] -&gt; [DExp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarE"><span class="hs-identifier hs-var">DVarE</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679412655"><span class="hs-identifier hs-var">arg_names</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1128"></span><span>  </span><span id="local-6989586621679412653"><span class="annot"><span class="annottext">DClause
</span><a href="#local-6989586621679412653"><span class="hs-identifier hs-var">clause</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[DPat] -&gt; DExp -&gt; DClause
</span><a href="Language.Haskell.TH.Desugar.AST.html#DClause"><span class="hs-identifier hs-var">DClause</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; DPat) -&gt; [Name] -&gt; [DPat]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-var">DVarP</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679412655"><span class="hs-identifier hs-var">arg_names</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DClause) -&gt; q DExp -&gt; q DClause
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-1129"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DCaseE"><span class="hs-identifier hs-var">DCaseE</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679412654"><span class="hs-identifier hs-var">scrutinee</span></a></span><span> </span><span class="annot"><span class="annottext">([DMatch] -&gt; DExp) -&gt; q [DMatch] -&gt; q DExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Clause -&gt; [DMatch] -&gt; q [DMatch])
-&gt; [DMatch] -&gt; [Clause] -&gt; q [DMatch]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; b -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldrM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DExp -&gt; Clause -&gt; [DMatch] -&gt; q [DMatch]
forall (q :: * -&gt; *).
DsMonad q =&gt;
DExp -&gt; Clause -&gt; [DMatch] -&gt; q [DMatch]
</span><a href="#local-6989586621679412651"><span class="hs-identifier hs-var">clause_to_dmatch</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679412654"><span class="hs-identifier hs-var">scrutinee</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621679412657"><span class="hs-identifier hs-var">clauses</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1130"></span><span>  </span><span class="annot"><span class="annottext">[DClause] -&gt; q [DClause]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DClause
</span><a href="#local-6989586621679412653"><span class="hs-identifier hs-var">clause</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1131"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1132"></span><span>    </span><span id="local-6989586621679413733"><span class="annot"><a href="#local-6989586621679412651"><span class="hs-identifier hs-type">clause_to_dmatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413733"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Clause</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413733"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-type">DMatch</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1133"></span><span>    </span><span id="local-6989586621679412651"><span class="annot"><span class="annottext">clause_to_dmatch :: DExp -&gt; Clause -&gt; [DMatch] -&gt; q [DMatch]
</span><a href="#local-6989586621679412651"><span class="hs-identifier hs-var hs-var">clause_to_dmatch</span></a></span></span><span> </span><span id="local-6989586621679412650"><span class="annot"><span class="annottext">scrutinee :: DExp
</span><a href="#local-6989586621679412650"><span class="hs-identifier hs-var">scrutinee</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Clause</span></span><span> </span><span id="local-6989586621679412649"><span class="annot"><span class="annottext">pats :: [Pat]
</span><a href="#local-6989586621679412649"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span id="local-6989586621679412648"><span class="annot"><span class="annottext">body :: Body
</span><a href="#local-6989586621679412648"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span id="local-6989586621679412647"><span class="annot"><span class="annottext">where_decs :: [Dec]
</span><a href="#local-6989586621679412647"><span class="hs-identifier hs-var">where_decs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679412646"><span class="annot"><span class="annottext">failure_matches :: [DMatch]
</span><a href="#local-6989586621679412646"><span class="hs-identifier hs-var">failure_matches</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1134"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679412645"><span class="annot"><span class="annottext">failure_exp :: DExp
</span><a href="#local-6989586621679412645"><span class="hs-identifier hs-var hs-var">failure_exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; DExp -&gt; [DMatch] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#maybeDCaseE"><span class="hs-identifier hs-var">maybeDCaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;Non-exhaustive patterns in &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412658"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1135"></span><span>                                    </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679412650"><span class="hs-identifier hs-var">scrutinee</span></a></span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679412646"><span class="hs-identifier hs-var">failure_matches</span></a></span><span>
</span><span id="line-1136"></span><span>      </span><span id="local-6989586621679412644"><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679412644"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Body -&gt; [Dec] -&gt; DExp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Body -&gt; [Dec] -&gt; DExp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsBody"><span class="hs-identifier hs-var">dsBody</span></a></span><span> </span><span class="annot"><span class="annottext">Body
</span><a href="#local-6989586621679412648"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">[Dec]
</span><a href="#local-6989586621679412647"><span class="hs-identifier hs-var">where_decs</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679412645"><span class="hs-identifier hs-var">failure_exp</span></a></span><span>
</span><span id="line-1137"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679412643"><span class="annot"><span class="annottext">pats' :: [DPat]
</span><a href="#local-6989586621679412643"><span class="hs-identifier hs-var">pats'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412642"><span class="annot"><span class="annottext">exp' :: DExp
</span><a href="#local-6989586621679412642"><span class="hs-identifier hs-var">exp'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; DExp -&gt; q ([DPat], DExp)
forall (q :: * -&gt; *).
DsMonad q =&gt;
[Pat] -&gt; DExp -&gt; q ([DPat], DExp)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatsOverExp"><span class="hs-identifier hs-var">dsPatsOverExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679412649"><span class="hs-identifier hs-var">pats</span></a></span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679412644"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-1138"></span><span>      </span><span id="local-6989586621679412641"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679412641"><span class="hs-identifier hs-var">uni_pats</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(All -&gt; Bool) -&gt; q All -&gt; q Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">All -&gt; Bool
</span><span class="hs-identifier hs-var hs-var">getAll</span></span><span> </span><span class="annot"><span class="annottext">(q All -&gt; q Bool) -&gt; q All -&gt; q Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; q All) -&gt; [DPat] -&gt; q All
forall (monad :: * -&gt; *) monoid (t :: * -&gt; *) a.
(Monad monad, Monoid monoid, Traversable t) =&gt;
(a -&gt; monad monoid) -&gt; t a -&gt; monad monoid
</span><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Bool -&gt; All) -&gt; q Bool -&gt; q All
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><span class="hs-identifier hs-var">All</span></span><span> </span><span class="annot"><span class="annottext">(q Bool -&gt; q All) -&gt; (DPat -&gt; q Bool) -&gt; DPat -&gt; q All
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q Bool
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679412643"><span class="hs-identifier hs-var">pats'</span></a></span><span>
</span><span id="line-1139"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679412638"><span class="annot"><span class="annottext">match :: DMatch
</span><a href="#local-6989586621679412638"><span class="hs-identifier hs-var hs-var">match</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; DExp -&gt; DMatch
</span><a href="Language.Haskell.TH.Desugar.AST.html#DMatch"><span class="hs-identifier hs-var">DMatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDPat"><span class="hs-identifier hs-var">mkTupleDPat</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679412643"><span class="hs-identifier hs-var">pats'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679412642"><span class="hs-identifier hs-var">exp'</span></a></span><span>
</span><span id="line-1140"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679412641"><span class="hs-identifier hs-var">uni_pats</span></a></span><span>
</span><span id="line-1141"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[DMatch] -&gt; q [DMatch]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DMatch
</span><a href="#local-6989586621679412638"><span class="hs-identifier hs-var">match</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1142"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[DMatch] -&gt; q [DMatch]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DMatch
</span><a href="#local-6989586621679412638"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">DMatch -&gt; [DMatch] -&gt; [DMatch]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[DMatch]
</span><a href="#local-6989586621679412646"><span class="hs-identifier hs-var">failure_matches</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1143"></span><span>
</span><span id="line-1144"></span><span class="hs-comment">-- | Desugar a type</span><span>
</span><span id="line-1145"></span><span id="local-6989586621679413993"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-type">dsType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413993"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413993"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span></span><span>
</span><span id="line-1146"></span><span id="dsType"><span class="annot"><span class="annottext">dsType :: Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var hs-var">dsType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span id="local-6989586621679412637"><span class="annot"><span class="annottext">tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679412637"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679412636"><span class="annot"><span class="annottext">preds :: Cxt
</span><a href="#local-6989586621679412636"><span class="hs-identifier hs-var">preds</span></a></span></span><span> </span><span id="local-6989586621679412635"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679412635"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-var">DForallT</span></a></span><span> </span><span class="annot"><span class="annottext">([DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; DType)
-&gt; q [DTyVarBndr] -&gt; q (DCxt -&gt; DType -&gt; DType)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679412637"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">q (DCxt -&gt; DType -&gt; DType) -&gt; q DCxt -&gt; q (DType -&gt; DType)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Cxt -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679412636"><span class="hs-identifier hs-var">preds</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412635"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1147"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span id="local-6989586621679412633"><span class="annot"><span class="annottext">t1 :: Type
</span><a href="#local-6989586621679412633"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679412632"><span class="annot"><span class="annottext">t2 :: Type
</span><a href="#local-6989586621679412632"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DType -&gt; DType) -&gt; q DType -&gt; q (DType -&gt; DType)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412633"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412632"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1148"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679412630"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679412630"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679412629"><span class="annot"><span class="annottext">ki :: Type
</span><a href="#local-6989586621679412629"><span class="hs-identifier hs-var">ki</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigT"><span class="hs-identifier hs-var">DSigT</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DType -&gt; DType) -&gt; q DType -&gt; q (DType -&gt; DType)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412630"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412629"><span class="hs-identifier hs-var">ki</span></a></span><span>
</span><span id="line-1149"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarT</span></span><span> </span><span id="local-6989586621679412626"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679412626"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-var">DVarT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412626"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1150"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679412624"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679412624"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412624"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1151"></span><span>  </span><span class="hs-comment">-- the only difference between ConT and PromotedT is the name lookup. Here, we assume</span><span>
</span><span id="line-1152"></span><span>  </span><span class="hs-comment">-- that the TH quote mechanism figured out the right name. Note that lookupDataName name</span><span>
</span><span id="line-1153"></span><span>  </span><span class="hs-comment">-- does not necessarily work, because `name` has its original module attached, which</span><span>
</span><span id="line-1154"></span><span>  </span><span class="hs-comment">-- may not be in scope.</span><span>
</span><span id="line-1155"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PromotedT</span></span><span> </span><span id="local-6989586621679412622"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679412622"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412622"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-1156"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TupleT</span></span><span> </span><span id="local-6989586621679412620"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679412620"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleTypeName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679412620"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1157"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedTupleT</span></span><span> </span><span id="local-6989586621679412617"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679412617"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">unboxedTupleTypeName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679412617"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1158"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ArrowT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DArrowT"><span class="hs-identifier hs-var">DArrowT</span></a></span><span>
</span><span id="line-1159"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ListT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1160"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PromotedTupleT</span></span><span> </span><span id="local-6989586621679412612"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679412612"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679412612"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1161"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PromotedNilT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1162"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PromotedConsT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><span id="line-1163"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StarT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Language.Haskell.TH.Desugar.Util.html#typeKindName"><span class="hs-identifier hs-var">typeKindName</span></a></span><span>
</span><span id="line-1164"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConstraintT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Constraint</span><span>
</span><span id="line-1165"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LitT</span></span><span> </span><span id="local-6989586621679412606"><span class="annot"><span class="annottext">lit :: TyLit
</span><a href="#local-6989586621679412606"><span class="hs-identifier hs-var">lit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-var">DLitT</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit
</span><a href="#local-6989586621679412606"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 709
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EqualityT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-glyph">~</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixT</span></span><span> </span><span id="local-6989586621679412603"><span class="annot"><span class="annottext">t1 :: Type
</span><a href="#local-6989586621679412603"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679412602"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412602"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412601"><span class="annot"><span class="annottext">t2 :: Type
</span><a href="#local-6989586621679412601"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DType -&gt; DType) -&gt; q DType -&gt; q (DType -&gt; DType)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412602"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412603"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412601"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1171"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UInfixT</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DType
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Cannot desugar unresolved infix operators.&quot;</span></span><span>
</span><span id="line-1172"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensT</span></span><span> </span><span id="local-6989586621679412598"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679412598"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412598"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1173"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WildCardT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildCardT"><span class="hs-identifier hs-var">DWildCardT</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedSumT</span></span><span> </span><span id="local-6989586621679412594"><span class="annot"><span class="annottext">arity :: Int
</span><a href="#local-6989586621679412594"><span class="hs-identifier hs-var">arity</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">unboxedSumTypeName</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679412594"><span class="hs-identifier hs-var">arity</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppKindT</span></span><span> </span><span id="local-6989586621679412591"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679412591"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679412590"><span class="annot"><span class="annottext">k :: Type
</span><a href="#local-6989586621679412590"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppKindT"><span class="hs-identifier hs-var">DAppKindT</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DType -&gt; DType) -&gt; q DType -&gt; q (DType -&gt; DType)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412591"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412590"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1180"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImplicitParamT</span></span><span> </span><span id="local-6989586621679412587"><span class="annot"><span class="annottext">n :: String
</span><a href="#local-6989586621679412587"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412586"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679412586"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1181"></span><span>  </span><span id="local-6989586621679412585"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412585"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412586"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1182"></span><span>  </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; q DType) -&gt; DType -&gt; q DType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">IP</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-operator hs-var">`DAppT`</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-var">DLitT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TyLit
</span><span class="hs-identifier hs-var">StrTyLit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679412587"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-operator hs-var">`DAppT`</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412585"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1185"></span><span class="hs-comment">-- | Desugar a @TyVarBndr@</span><span>
</span><span id="line-1186"></span><span id="local-6989586621679413841"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-type">dsTvb</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413841"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TyVarBndr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413841"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span></span><span>
</span><span id="line-1187"></span><span id="dsTvb"><span class="annot"><span class="annottext">dsTvb :: TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var hs-var">dsTvb</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PlainTV</span></span><span> </span><span id="local-6989586621679412583"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412583"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; q DTyVarBndr
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; q DTyVarBndr) -&gt; DTyVarBndr -&gt; q DTyVarBndr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPlainTV"><span class="hs-identifier hs-var">DPlainTV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412583"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1188"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KindedTV</span></span><span> </span><span id="local-6989586621679412580"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412580"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412579"><span class="annot"><span class="annottext">k :: Type
</span><a href="#local-6989586621679412579"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-var">DKindedTV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412580"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DTyVarBndr) -&gt; q DType -&gt; q DTyVarBndr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412579"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1189"></span><span>
</span><span id="line-1190"></span><span class="hs-comment">-- | Desugar a @Cxt@</span><span>
</span><span id="line-1191"></span><span id="local-6989586621679413839"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-type">dsCxt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413839"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Cxt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413839"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span></span><span>
</span><span id="line-1192"></span><span id="dsCxt"><span class="annot"><span class="annottext">dsCxt :: Cxt -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var hs-var">dsCxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; q DCxt) -&gt; Cxt -&gt; q DCxt
forall (monad :: * -&gt; *) monoid (t :: * -&gt; *) a.
(Monad monad, Monoid monoid, Traversable t) =&gt;
(a -&gt; monad monoid) -&gt; t a -&gt; monad monoid
</span><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="hs-comment">-- | A backwards-compatible type synonym for the thing representing a single</span><span>
</span><span id="line-1196"></span><span class="hs-comment">-- derived class in a @deriving@ clause. (This is a @DerivClause@, @Pred@, or</span><span>
</span><span id="line-1197"></span><span class="hs-comment">-- @Name@ depending on the GHC version.)</span><span>
</span><span id="line-1198"></span><span class="hs-keyword">type</span><span> </span><span id="DerivingClause"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DerivingClause"><span class="hs-identifier hs-var">DerivingClause</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DerivClause</span></span><span>
</span><span id="line-1199"></span><span>
</span><span id="line-1200"></span><span class="hs-comment">-- | Desugar a @DerivingClause@.</span><span>
</span><span id="line-1201"></span><span id="local-6989586621679413810"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivClause"><span class="hs-identifier hs-type">dsDerivClause</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413810"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DerivingClause"><span class="hs-identifier hs-type">DerivingClause</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413810"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDerivClause"><span class="hs-identifier hs-type">DDerivClause</span></a></span></span><span>
</span><span id="line-1202"></span><span id="dsDerivClause"><span class="annot"><span class="annottext">dsDerivClause :: DerivClause -&gt; q DDerivClause
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivClause"><span class="hs-identifier hs-var hs-var">dsDerivClause</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DerivClause</span></span><span> </span><span id="local-6989586621679412576"><span class="annot"><span class="annottext">mds :: Maybe DerivStrategy
</span><a href="#local-6989586621679412576"><span class="hs-identifier hs-var">mds</span></a></span></span><span> </span><span id="local-6989586621679412575"><span class="annot"><span class="annottext">cxt :: Cxt
</span><a href="#local-6989586621679412575"><span class="hs-identifier hs-var">cxt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1203"></span><span>  </span><span class="annot"><span class="annottext">Maybe DDerivStrategy -&gt; DCxt -&gt; DDerivClause
</span><a href="Language.Haskell.TH.Desugar.AST.html#DDerivClause"><span class="hs-identifier hs-var">DDerivClause</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe DDerivStrategy -&gt; DCxt -&gt; DDerivClause)
-&gt; q (Maybe DDerivStrategy) -&gt; q (DCxt -&gt; DDerivClause)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(DerivStrategy -&gt; q DDerivStrategy)
-&gt; Maybe DerivStrategy -&gt; q (Maybe DDerivStrategy)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">DerivStrategy -&gt; q DDerivStrategy
forall (q :: * -&gt; *).
DsMonad q =&gt;
DerivStrategy -&gt; q DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-var">dsDerivStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DerivStrategy
</span><a href="#local-6989586621679412576"><span class="hs-identifier hs-var">mds</span></a></span><span> </span><span class="annot"><span class="annottext">q (DCxt -&gt; DDerivClause) -&gt; q DCxt -&gt; q DDerivClause
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Cxt -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679412575"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-cpp">
#elif __GLASGOW_HASKELL__ &gt;= 711
</span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">DerivingClause</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Pred</span><span>
</span><span id="line-1206"></span><span>
</span><span id="line-1207"></span><span class="hs-identifier">dsDerivClause</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">DerivingClause</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DDerivClause</span><span>
</span><span id="line-1208"></span><span class="hs-identifier">dsDerivClause</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">DDerivClause</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-operator">&lt;$&gt;</span><span> </span><span class="hs-identifier">dsPred</span><span> </span><span class="hs-identifier">p</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">DerivingClause</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Name</span><span>
</span><span id="line-1211"></span><span>
</span><span id="line-1212"></span><span class="hs-identifier">dsDerivClause</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">DsMonad</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">DerivingClause</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">q</span><span> </span><span class="hs-identifier">DDerivClause</span><span>
</span><span id="line-1213"></span><span class="hs-identifier">dsDerivClause</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">pure</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">DDerivClause</span><span> </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">DConT</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="hs-comment">-- | Desugar a @DerivStrategy@.</span><span>
</span><span id="line-1218"></span><span id="local-6989586621679413815"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-type">dsDerivStrategy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413815"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DerivStrategy</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413815"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DDerivStrategy"><span class="hs-identifier hs-type">DDerivStrategy</span></a></span></span><span>
</span><span id="line-1219"></span><span id="dsDerivStrategy"><span class="annot"><span class="annottext">dsDerivStrategy :: DerivStrategy -&gt; q DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-var hs-var">dsDerivStrategy</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StockStrategy</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DDerivStrategy -&gt; q DDerivStrategy
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.AST.html#DStockStrategy"><span class="hs-identifier hs-var">DStockStrategy</span></a></span><span>
</span><span id="line-1220"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-var">dsDerivStrategy</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AnyclassStrategy</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DDerivStrategy -&gt; q DDerivStrategy
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAnyclassStrategy"><span class="hs-identifier hs-var">DAnyclassStrategy</span></a></span><span>
</span><span id="line-1221"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-var">dsDerivStrategy</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NewtypeStrategy</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DDerivStrategy -&gt; q DDerivStrategy
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.AST.html#DNewtypeStrategy"><span class="hs-identifier hs-var">DNewtypeStrategy</span></a></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 805
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsDerivStrategy"><span class="hs-identifier hs-var">dsDerivStrategy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ViaStrategy</span></span><span> </span><span id="local-6989586621679412566"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679412566"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DDerivStrategy
</span><a href="Language.Haskell.TH.Desugar.AST.html#DViaStrategy"><span class="hs-identifier hs-var">DViaStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DDerivStrategy) -&gt; q DType -&gt; q DDerivStrategy
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412566"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#endif
</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="hs-comment">-- | Desugar a @PatSynDir@. (Available only with GHC 8.2+)</span><span>
</span><span id="line-1229"></span><span id="local-6989586621679413820"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPatSynDir"><span class="hs-identifier hs-type">dsPatSynDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413820"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PatSynDir</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413820"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPatSynDir"><span class="hs-identifier hs-type">DPatSynDir</span></a></span></span><span>
</span><span id="line-1230"></span><span id="dsPatSynDir"><span class="annot"><span class="annottext">dsPatSynDir :: Name -&gt; PatSynDir -&gt; q DPatSynDir
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPatSynDir"><span class="hs-identifier hs-var hs-var">dsPatSynDir</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Unidir</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPatSynDir -&gt; q DPatSynDir
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DPatSynDir
</span><a href="Language.Haskell.TH.Desugar.AST.html#DUnidir"><span class="hs-identifier hs-var">DUnidir</span></a></span><span>
</span><span id="line-1231"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPatSynDir"><span class="hs-identifier hs-var">dsPatSynDir</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ImplBidir</span></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPatSynDir -&gt; q DPatSynDir
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DPatSynDir
</span><a href="Language.Haskell.TH.Desugar.AST.html#DImplBidir"><span class="hs-identifier hs-var">DImplBidir</span></a></span><span>
</span><span id="line-1232"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPatSynDir"><span class="hs-identifier hs-var">dsPatSynDir</span></a></span><span> </span><span id="local-6989586621679412560"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412560"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExplBidir</span></span><span> </span><span id="local-6989586621679412558"><span class="annot"><span class="annottext">clauses :: [Clause]
</span><a href="#local-6989586621679412558"><span class="hs-identifier hs-var">clauses</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DClause] -&gt; DPatSynDir
</span><a href="Language.Haskell.TH.Desugar.AST.html#DExplBidir"><span class="hs-identifier hs-var">DExplBidir</span></a></span><span> </span><span class="annot"><span class="annottext">([DClause] -&gt; DPatSynDir) -&gt; q [DClause] -&gt; q DPatSynDir
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Clause] -&gt; q [DClause]
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; [Clause] -&gt; q [DClause]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsClauses"><span class="hs-identifier hs-var">dsClauses</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412560"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Clause]
</span><a href="#local-6989586621679412558"><span class="hs-identifier hs-var">clauses</span></a></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1235"></span><span class="hs-comment">-- | Desugar a @Pred@, flattening any internal tuples</span><span>
</span><span id="line-1236"></span><span id="local-6989586621679413727"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-type">dsPred</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413727"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pred</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413727"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DCxt"><span class="hs-identifier hs-type">DCxt</span></a></span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt; 709
</span><span class="hs-identifier">dsPred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ClassP</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">tys</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1239"></span><span>  </span><span class="hs-identifier">ts'</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-identifier">tys</span><span>
</span><span id="line-1240"></span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">foldl</span><span> </span><span class="hs-identifier">DAppT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DConT</span><span> </span><span class="hs-identifier">n</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ts'</span><span class="hs-special">]</span><span>
</span><span id="line-1241"></span><span class="hs-identifier">dsPred</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">EqualP</span><span> </span><span class="hs-identifier">t1</span><span> </span><span class="hs-identifier">t2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1242"></span><span>  </span><span class="hs-identifier">ts'</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">mapM</span><span> </span><span class="hs-identifier">dsType</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">t1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">t2</span><span class="hs-special">]</span><span>
</span><span id="line-1243"></span><span>  </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">foldl</span><span> </span><span class="hs-identifier">DAppT</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">DConT</span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-glyph">~</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ts'</span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span id="dsPred"><span class="annot"><span class="annottext">dsPred :: Type -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var hs-var">dsPred</span></a></span></span><span> </span><span id="local-6989586621679412556"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679412556"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-1246"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679412555"><span class="annot"><span class="annottext">ts :: Cxt
</span><a href="#local-6989586621679412555"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Cxt
</span><a href="Language.Haskell.TH.Desugar.Util.html#splitTuple_maybe"><span class="hs-identifier hs-var">splitTuple_maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412556"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1247"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; q DCxt) -&gt; Cxt -&gt; q DCxt
forall (monad :: * -&gt; *) monoid (t :: * -&gt; *) a.
(Monad monad, Monoid monoid, Traversable t) =&gt;
(a -&gt; monad monoid) -&gt; t a -&gt; monad monoid
</span><a href="Language.Haskell.TH.Desugar.Util.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679412555"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-1248"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForallT</span></span><span> </span><span id="local-6989586621679412553"><span class="annot"><span class="annottext">tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679412553"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679412552"><span class="annot"><span class="annottext">cxt :: Cxt
</span><a href="#local-6989586621679412552"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679412551"><span class="annot"><span class="annottext">p :: Type
</span><a href="#local-6989586621679412551"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1249"></span><span>  </span><span id="local-6989586621679412550"><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679412550"><span class="hs-identifier hs-var">ps'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412551"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1250"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679412550"><span class="hs-identifier hs-var">ps'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1251"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679412549"><span class="annot"><span class="annottext">p' :: DType
</span><a href="#local-6989586621679412549"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DCxt -&gt; DCxt
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DCxt) -&gt; q DType -&gt; q DCxt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-var">DForallT</span></a></span><span> </span><span class="annot"><span class="annottext">([DTyVarBndr] -&gt; DCxt -&gt; DType -&gt; DType)
-&gt; q [DTyVarBndr] -&gt; q (DCxt -&gt; DType -&gt; DType)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TyVarBndr -&gt; q DTyVarBndr) -&gt; [TyVarBndr] -&gt; q [DTyVarBndr]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">TyVarBndr -&gt; q DTyVarBndr
forall (q :: * -&gt; *). DsMonad q =&gt; TyVarBndr -&gt; q DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTvb"><span class="hs-identifier hs-var">dsTvb</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarBndr]
</span><a href="#local-6989586621679412553"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">q (DCxt -&gt; DType -&gt; DType) -&gt; q DCxt -&gt; q (DType -&gt; DType)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cxt -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Cxt -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsCxt"><span class="hs-identifier hs-var">dsCxt</span></a></span><span> </span><span class="annot"><span class="annottext">Cxt
</span><a href="#local-6989586621679412552"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; q DType
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412549"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1252"></span><span>    </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Cannot desugar constraint tuples in the body of a quantified constraint&quot;</span></span><span>
</span><span id="line-1253"></span><span>              </span><span class="hs-comment">-- See Trac #15334.</span><span>
</span><span id="line-1254"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppT</span></span><span> </span><span id="local-6989586621679412548"><span class="annot"><span class="annottext">t1 :: Type
</span><a href="#local-6989586621679412548"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679412547"><span class="annot"><span class="annottext">t2 :: Type
</span><a href="#local-6989586621679412547"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1255"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679412546"><span class="annot"><span class="annottext">p1 :: DType
</span><a href="#local-6989586621679412546"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412548"><span class="hs-identifier hs-var">t1</span></a></span><span>   </span><span class="hs-comment">-- tuples can't be applied!</span><span>
</span><span id="line-1256"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DCxt -&gt; DCxt
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DCxt) -&gt; (DType -&gt; DType) -&gt; DType -&gt; DCxt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412546"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DCxt) -&gt; q DType -&gt; q DCxt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412547"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1257"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SigT</span></span><span> </span><span id="local-6989586621679412545"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621679412545"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679412544"><span class="annot"><span class="annottext">ki :: Type
</span><a href="#local-6989586621679412544"><span class="hs-identifier hs-var">ki</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1258"></span><span>  </span><span id="local-6989586621679412543"><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679412543"><span class="hs-identifier hs-var">preds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412545"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1259"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679412543"><span class="hs-identifier hs-var">preds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1260"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679412542"><span class="annot"><span class="annottext">p :: DType
</span><a href="#local-6989586621679412542"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DCxt -&gt; DCxt
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DCxt) -&gt; (DType -&gt; DType) -&gt; DType -&gt; DCxt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigT"><span class="hs-identifier hs-var">DSigT</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412542"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DCxt) -&gt; q DType -&gt; q DCxt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412544"><span class="hs-identifier hs-var">ki</span></a></span><span>
</span><span id="line-1261"></span><span>    </span><span id="local-6989586621679412541"><span class="annot"><span class="annottext">other :: DCxt
</span><a href="#local-6989586621679412541"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; q DCxt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679412541"><span class="hs-identifier hs-var">other</span></a></span><span>   </span><span class="hs-comment">-- just drop the kind signature on a tuple.</span><span>
</span><span id="line-1262"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarT</span></span><span> </span><span id="local-6989586621679412540"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412540"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; q DCxt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-var">DVarT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412540"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1263"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ConT</span></span><span> </span><span id="local-6989586621679412539"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412539"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; q DCxt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412539"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1264"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span id="local-6989586621679412538"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679412538"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PromotedT</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1265"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q DCxt) -&gt; String -&gt; q DCxt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Promoted type seen as head of constraint: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412538"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1266"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TupleT</span></span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; q DCxt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleTypeName</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1267"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TupleT</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1268"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Internal error in th-desugar in detecting tuple constraints.&quot;</span></span><span>
</span><span id="line-1269"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span id="local-6989586621679412537"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679412537"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedTupleT</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1270"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q DCxt) -&gt; String -&gt; q DCxt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Unboxed tuple seen as head of constraint: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412537"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1271"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ArrowT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Arrow seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1272"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ListT</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;List seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1273"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PromotedTupleT</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1274"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Promoted tuple seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1275"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PromotedNilT</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Promoted nil seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1276"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PromotedConsT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Promoted cons seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1277"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StarT</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;* seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1278"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConstraintT</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1279"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;The kind `Constraint' seen as head of constraint.&quot;</span></span><span>
</span><span id="line-1280"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span id="local-6989586621679412536"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679412536"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LitT</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1281"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q DCxt) -&gt; String -&gt; q DCxt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Type literal seen as head of constraint: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412536"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1282"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EqualityT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; q DCxt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-special">(</span><span class="hs-glyph">~</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt; 710
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">InfixT</span></span><span> </span><span id="local-6989586621679412535"><span class="annot"><span class="annottext">t1 :: Type
</span><a href="#local-6989586621679412535"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679412534"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412534"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412533"><span class="annot"><span class="annottext">t2 :: Type
</span><a href="#local-6989586621679412533"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DCxt -&gt; DCxt
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DCxt) -&gt; q DType -&gt; q DCxt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DType -&gt; DType) -&gt; q DType -&gt; q (DType -&gt; DType)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-var">DAppT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412534"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412535"><span class="hs-identifier hs-var">t1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">q (DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412533"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1285"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UInfixT</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Cannot desugar unresolved infix operators.&quot;</span></span><span>
</span><span id="line-1286"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ParensT</span></span><span> </span><span id="local-6989586621679412532"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679412532"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412532"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1287"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WildCardT</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; q DCxt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildCardT"><span class="hs-identifier hs-var">DWildCardT</span></a></span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 801
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span id="local-6989586621679412531"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679412531"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">UnboxedSumT</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1291"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; q DCxt
forall (q :: * -&gt; *) a. MonadFail q =&gt; String -&gt; q a
</span><a href="Language.Haskell.TH.Desugar.Util.html#impossible"><span class="hs-identifier hs-var">impossible</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; q DCxt) -&gt; String -&gt; q DCxt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Unboxed sum seen as head of constraint: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412531"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 807
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AppKindT</span></span><span> </span><span id="local-6989586621679412530"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679412530"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679412529"><span class="annot"><span class="annottext">k :: Type
</span><a href="#local-6989586621679412529"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1295"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679412528"><span class="annot"><span class="annottext">p :: DType
</span><a href="#local-6989586621679412528"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DCxt
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412530"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1296"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DCxt -&gt; DCxt
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DCxt) -&gt; q DType -&gt; q DCxt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppKindT"><span class="hs-identifier hs-var">DAppKindT</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412528"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DType) -&gt; q DType -&gt; q DType
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412529"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1297"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsPred"><span class="hs-identifier hs-var">dsPred</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ImplicitParamT</span></span><span> </span><span id="local-6989586621679412527"><span class="annot"><span class="annottext">n :: String
</span><a href="#local-6989586621679412527"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412526"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679412526"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1298"></span><span>  </span><span id="local-6989586621679412525"><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412525"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412526"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1299"></span><span>  </span><span class="annot"><span class="annottext">DCxt -&gt; q DCxt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="hs-special">''</span><span class="hs-identifier">IP</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-operator hs-var">`DAppT`</span></a></span><span> </span><span class="annot"><span class="annottext">TyLit -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-var">DLitT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TyLit
</span><span class="hs-identifier hs-var">StrTyLit</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679412527"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-operator hs-var">`DAppT`</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412525"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#endif
</span><span>
</span><span id="line-1303"></span><span class="hs-comment">-- | Like 'reify', but safer and desugared. Uses local declarations where</span><span>
</span><span id="line-1304"></span><span class="hs-comment">-- available.</span><span>
</span><span id="line-1305"></span><span id="local-6989586621679412524"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsReify"><span class="hs-identifier hs-type">dsReify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679412524"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679412524"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DInfo"><span class="hs-identifier hs-type">DInfo</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1306"></span><span id="dsReify"><span class="annot"><span class="annottext">dsReify :: Name -&gt; q (Maybe DInfo)
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsReify"><span class="hs-identifier hs-var hs-var">dsReify</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Info -&gt; q DInfo) -&gt; Maybe Info -&gt; q (Maybe DInfo)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Info -&gt; q DInfo
forall (q :: * -&gt; *). DsMonad q =&gt; Info -&gt; q DInfo
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsInfo"><span class="hs-identifier hs-var">dsInfo</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Info -&gt; q (Maybe DInfo))
-&gt; (Name -&gt; q (Maybe Info)) -&gt; Name -&gt; q (Maybe DInfo)
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; q (Maybe Info)
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q (Maybe Info)
</span><a href="Language.Haskell.TH.Desugar.Reify.html#reifyWithLocals_maybe"><span class="hs-identifier hs-var">reifyWithLocals_maybe</span></a></span><span>
</span><span id="line-1307"></span><span>
</span><span id="line-1308"></span><span class="hs-comment">-- create a list of expressions in the same order as the fields in the first argument</span><span>
</span><span id="line-1309"></span><span class="hs-comment">-- but with the values as given in the second argument</span><span>
</span><span id="line-1310"></span><span class="hs-comment">-- if a field is missing from the second argument, use the corresponding expression</span><span>
</span><span id="line-1311"></span><span class="hs-comment">-- from the third argument</span><span>
</span><span id="line-1312"></span><span id="local-6989586621679413983"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields"><span class="hs-identifier hs-type">reorderFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413983"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">VarStrictType</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FieldExp</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413983"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1313"></span><span id="reorderFields"><span class="annot"><span class="annottext">reorderFields :: Name -&gt; [VarBangType] -&gt; [FieldExp] -&gt; [DExp] -&gt; q [DExp]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields"><span class="hs-identifier hs-var hs-var">reorderFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; q DExp)
-&gt; Name -&gt; [VarBangType] -&gt; [FieldExp] -&gt; [DExp] -&gt; q [DExp]
forall (m :: * -&gt; *) a da.
(Applicative m, MonadFail m) =&gt;
(a -&gt; m da)
-&gt; Name -&gt; [VarBangType] -&gt; [(Name, a)] -&gt; [da] -&gt; m [da]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields%27"><span class="hs-identifier hs-var">reorderFields'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; q DExp
forall (q :: * -&gt; *). DsMonad q =&gt; Exp -&gt; q DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsExp"><span class="hs-identifier hs-var">dsExp</span></a></span><span>
</span><span id="line-1314"></span><span>
</span><span id="line-1315"></span><span id="local-6989586621679413864"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#reorderFieldsPat"><span class="hs-identifier hs-type">reorderFieldsPat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413864"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">VarStrictType</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FieldPat</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#PatM"><span class="hs-identifier hs-type">PatM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413864"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1316"></span><span id="reorderFieldsPat"><span class="annot"><span class="annottext">reorderFieldsPat :: Name -&gt; [VarBangType] -&gt; [FieldPat] -&gt; PatM q [DPat]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFieldsPat"><span class="hs-identifier hs-var hs-var">reorderFieldsPat</span></a></span></span><span> </span><span id="local-6989586621679412517"><span class="annot"><span class="annottext">con_name :: Name
</span><a href="#local-6989586621679412517"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679412516"><span class="annot"><span class="annottext">field_decs :: [VarBangType]
</span><a href="#local-6989586621679412516"><span class="hs-identifier hs-var">field_decs</span></a></span></span><span> </span><span id="local-6989586621679412515"><span class="annot"><span class="annottext">field_pats :: [FieldPat]
</span><a href="#local-6989586621679412515"><span class="hs-identifier hs-var">field_pats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1317"></span><span>  </span><span class="annot"><span class="annottext">(Pat -&gt; WriterT [(Name, DExp)] q DPat)
-&gt; Name -&gt; [VarBangType] -&gt; [FieldPat] -&gt; [DPat] -&gt; PatM q [DPat]
forall (m :: * -&gt; *) a da.
(Applicative m, MonadFail m) =&gt;
(a -&gt; m da)
-&gt; Name -&gt; [VarBangType] -&gt; [(Name, a)] -&gt; [da] -&gt; m [da]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields%27"><span class="hs-identifier hs-var">reorderFields'</span></a></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; WriterT [(Name, DExp)] q DPat
forall (q :: * -&gt; *). DsMonad q =&gt; Pat -&gt; PatM q DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsPat"><span class="hs-identifier hs-var">dsPat</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412517"><span class="hs-identifier hs-var">con_name</span></a></span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679412516"><span class="hs-identifier hs-var">field_decs</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldPat]
</span><a href="#local-6989586621679412515"><span class="hs-identifier hs-var">field_pats</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DPat -&gt; [DPat]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-var">DWildP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1318"></span><span>
</span><span id="line-1319"></span><span id="local-6989586621679413709"><span id="local-6989586621679413710"><span id="local-6989586621679413711"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields%27"><span class="hs-identifier hs-type">reorderFields'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679413711"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Fail.MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679413711"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1320"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679413710"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413711"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413709"><span class="hs-identifier hs-type">da</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1321"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-comment">-- ^ The name of the constructor (used for error reporting)</span><span>
</span><span id="line-1322"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">VarStrictType</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679413710"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1323"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679413709"><span class="hs-identifier hs-type">da</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413711"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679413709"><span class="hs-identifier hs-type">da</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-1324"></span><span id="reorderFields%27"><span class="annot"><span class="annottext">reorderFields' :: (a -&gt; m da)
-&gt; Name -&gt; [VarBangType] -&gt; [(Name, a)] -&gt; [da] -&gt; m [da]
</span><a href="Language.Haskell.TH.Desugar.Core.html#reorderFields%27"><span class="hs-identifier hs-var hs-var">reorderFields'</span></a></span></span><span> </span><span id="local-6989586621679412514"><span class="annot"><span class="annottext">ds_thing :: a -&gt; m da
</span><a href="#local-6989586621679412514"><span class="hs-identifier hs-var">ds_thing</span></a></span></span><span> </span><span id="local-6989586621679412513"><span class="annot"><span class="annottext">con_name :: Name
</span><a href="#local-6989586621679412513"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679412512"><span class="annot"><span class="annottext">field_names_types :: [VarBangType]
</span><a href="#local-6989586621679412512"><span class="hs-identifier hs-var">field_names_types</span></a></span></span><span> </span><span id="local-6989586621679412511"><span class="annot"><span class="annottext">field_things :: [(Name, a)]
</span><a href="#local-6989586621679412511"><span class="hs-identifier hs-var">field_things</span></a></span></span><span> </span><span id="local-6989586621679412510"><span class="annot"><span class="annottext">deflts :: [da]
</span><a href="#local-6989586621679412510"><span class="hs-identifier hs-var">deflts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1325"></span><span>  </span><span class="annot"><span class="annottext">m ()
</span><a href="#local-6989586621679412509"><span class="hs-identifier hs-var">check_valid_fields</span></a></span><span> </span><span class="annot"><span class="annottext">m () -&gt; m [da] -&gt; m [da]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [da] -&gt; m [da]
</span><a href="#local-6989586621679412508"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679412507"><span class="hs-identifier hs-var">field_names</span></a></span><span> </span><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679412510"><span class="hs-identifier hs-var">deflts</span></a></span><span>
</span><span id="line-1326"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1327"></span><span>    </span><span id="local-6989586621679412507"><span class="annot"><span class="annottext">field_names :: [Name]
</span><a href="#local-6989586621679412507"><span class="hs-identifier hs-var hs-var">field_names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VarBangType -&gt; Name) -&gt; [VarBangType] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679412506"><span class="annot"><span class="annottext">a :: Name
</span><a href="#local-6989586621679412506"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412506"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[VarBangType]
</span><a href="#local-6989586621679412512"><span class="hs-identifier hs-var">field_names_types</span></a></span><span>
</span><span id="line-1328"></span><span>
</span><span id="line-1329"></span><span>    </span><span id="local-6989586621679412509"><span class="annot"><span class="annottext">check_valid_fields :: m ()
</span><a href="#local-6989586621679412509"><span class="hs-identifier hs-var hs-var">check_valid_fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1330"></span><span>      </span><span class="annot"><span class="annottext">[(Name, a)] -&gt; ((Name, a) -&gt; m ()) -&gt; m ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">[(Name, a)]
</span><a href="#local-6989586621679412511"><span class="hs-identifier hs-var">field_things</span></a></span><span> </span><span class="annot"><span class="annottext">(((Name, a) -&gt; m ()) -&gt; m ()) -&gt; ((Name, a) -&gt; m ()) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679412505"><span class="annot"><span class="annottext">thing_name :: Name
</span><a href="#local-6989586621679412505"><span class="hs-identifier hs-var">thing_name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1331"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412505"><span class="hs-identifier hs-var">thing_name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679412507"><span class="hs-identifier hs-var">field_names</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1332"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; m ()
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m ()) -&gt; String -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Constructor &#8216;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412513"><span class="hs-identifier hs-var">con_name</span></a></span><span>   </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&#8216; does not have field &#8216;&quot;</span></span><span>
</span><span id="line-1333"></span><span>                                 </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
</span><span class="hs-identifier hs-var">nameBase</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412505"><span class="hs-identifier hs-var">thing_name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&#8216;&quot;</span></span><span>
</span><span id="line-1334"></span><span>
</span><span id="line-1335"></span><span>    </span><span id="local-6989586621679412508"><span class="annot"><span class="annottext">reorder :: [Name] -&gt; [da] -&gt; m [da]
</span><a href="#local-6989586621679412508"><span class="hs-identifier hs-var hs-var">reorder</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[da] -&gt; m [da]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1336"></span><span>    </span><span class="annot"><a href="#local-6989586621679412508"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679412504"><span class="annot"><span class="annottext">field_name :: Name
</span><a href="#local-6989586621679412504"><span class="hs-identifier hs-var">field_name</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679412503"><span class="annot"><span class="annottext">rest :: [Name]
</span><a href="#local-6989586621679412503"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679412502"><span class="annot"><span class="annottext">deflt :: da
</span><a href="#local-6989586621679412502"><span class="hs-identifier hs-var">deflt</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679412501"><span class="annot"><span class="annottext">rest_deflt :: [da]
</span><a href="#local-6989586621679412501"><span class="hs-identifier hs-var">rest_deflt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1337"></span><span>      </span><span id="local-6989586621679412500"><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679412500"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [da] -&gt; m [da]
</span><a href="#local-6989586621679412508"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679412503"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679412501"><span class="hs-identifier hs-var">rest_deflt</span></a></span><span>
</span><span id="line-1338"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((Name, a) -&gt; Bool) -&gt; [(Name, a)] -&gt; Maybe (Name, a)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679412498"><span class="annot"><span class="annottext">thing_name :: Name
</span><a href="#local-6989586621679412498"><span class="hs-identifier hs-var">thing_name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412498"><span class="hs-identifier hs-var">thing_name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412504"><span class="hs-identifier hs-var">field_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Name, a)]
</span><a href="#local-6989586621679412511"><span class="hs-identifier hs-var">field_things</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1339"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412497"><span class="annot"><span class="annottext">thing :: a
</span><a href="#local-6989586621679412497"><span class="hs-identifier hs-var">thing</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">da -&gt; [da] -&gt; [da]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679412500"><span class="hs-identifier hs-var">rest'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(da -&gt; [da]) -&gt; m da -&gt; m [da]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m da
</span><a href="#local-6989586621679412514"><span class="hs-identifier hs-var">ds_thing</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679412497"><span class="hs-identifier hs-var">thing</span></a></span><span>
</span><span id="line-1340"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[da] -&gt; m [da]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([da] -&gt; m [da]) -&gt; [da] -&gt; m [da]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">da
</span><a href="#local-6989586621679412502"><span class="hs-identifier hs-var">deflt</span></a></span><span> </span><span class="annot"><span class="annottext">da -&gt; [da] -&gt; [da]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679412500"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-1341"></span><span>    </span><span class="annot"><a href="#local-6989586621679412508"><span class="hs-identifier hs-var">reorder</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; m [da]
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Internal error in th-desugar.&quot;</span></span><span>
</span><span id="line-1342"></span><span>
</span><span id="line-1343"></span><span class="hs-comment">-- | Make a tuple 'DExp' from a list of 'DExp's. Avoids using a 1-tuple.</span><span>
</span><span id="line-1344"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDExp"><span class="hs-identifier hs-type">mkTupleDExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-1345"></span><span id="mkTupleDExp"><span class="annot"><span class="annottext">mkTupleDExp :: [DExp] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDExp"><span class="hs-identifier hs-var hs-var">mkTupleDExp</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679412496"><span class="annot"><span class="annottext">exp :: DExp
</span><a href="#local-6989586621679412496"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DExp
</span><a href="#local-6989586621679412496"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-1346"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDExp"><span class="hs-identifier hs-var">mkTupleDExp</span></a></span><span> </span><span id="local-6989586621679412495"><span class="annot"><span class="annottext">exps :: [DExp]
</span><a href="#local-6989586621679412495"><span class="hs-identifier hs-var">exps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; DExp -&gt; [DExp] -&gt; DExp
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConE"><span class="hs-identifier hs-var">DConE</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; DExp) -&gt; Name -&gt; DExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DExp] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[DExp]
</span><a href="#local-6989586621679412495"><span class="hs-identifier hs-var">exps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DExp]
</span><a href="#local-6989586621679412495"><span class="hs-identifier hs-var">exps</span></a></span><span>
</span><span id="line-1347"></span><span>
</span><span id="line-1348"></span><span class="hs-comment">-- | Make a tuple 'Exp' from a list of 'Exp's. Avoids using a 1-tuple.</span><span>
</span><span id="line-1349"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleExp"><span class="hs-identifier hs-type">mkTupleExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-1350"></span><span id="mkTupleExp"><span class="annot"><span class="annottext">mkTupleExp :: [Exp] -&gt; Exp
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleExp"><span class="hs-identifier hs-var hs-var">mkTupleExp</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679412494"><span class="annot"><span class="annottext">exp :: Exp
</span><a href="#local-6989586621679412494"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679412494"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-1351"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleExp"><span class="hs-identifier hs-var">mkTupleExp</span></a></span><span> </span><span id="local-6989586621679412493"><span class="annot"><span class="annottext">exps :: [Exp]
</span><a href="#local-6989586621679412493"><span class="hs-identifier hs-var">exps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp -&gt; Exp) -&gt; Exp -&gt; [Exp] -&gt; Exp
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-identifier hs-var">AppE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">ConE</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Exp) -&gt; Name -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679412493"><span class="hs-identifier hs-var">exps</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621679412493"><span class="hs-identifier hs-var">exps</span></a></span><span>
</span><span id="line-1352"></span><span>
</span><span id="line-1353"></span><span class="hs-comment">-- | Make a tuple 'DPat' from a list of 'DPat's. Avoids using a 1-tuple.</span><span>
</span><span id="line-1354"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDPat"><span class="hs-identifier hs-type">mkTupleDPat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span>
</span><span id="line-1355"></span><span id="mkTupleDPat"><span class="annot"><span class="annottext">mkTupleDPat :: [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDPat"><span class="hs-identifier hs-var hs-var">mkTupleDPat</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679412492"><span class="annot"><span class="annottext">pat :: DPat
</span><a href="#local-6989586621679412492"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679412492"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-1356"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTupleDPat"><span class="hs-identifier hs-var">mkTupleDPat</span></a></span><span> </span><span id="local-6989586621679412491"><span class="annot"><span class="annottext">pats :: [DPat]
</span><a href="#local-6989586621679412491"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [DPat] -&gt; DPat
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-var">DConP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DPat] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679412491"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679412491"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-1357"></span><span>
</span><span id="line-1358"></span><span class="hs-comment">-- | Make a tuple 'Pat' from a list of 'Pat's. Avoids using a 1-tuple.</span><span>
</span><span id="line-1359"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTuplePat"><span class="hs-identifier hs-type">mkTuplePat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pat</span></span><span>
</span><span id="line-1360"></span><span id="mkTuplePat"><span class="annot"><span class="annottext">mkTuplePat :: [Pat] -&gt; Pat
</span><a href="Language.Haskell.TH.Desugar.Core.html#mkTuplePat"><span class="hs-identifier hs-var hs-var">mkTuplePat</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679412490"><span class="annot"><span class="annottext">pat :: Pat
</span><a href="#local-6989586621679412490"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621679412490"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-1361"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#mkTuplePat"><span class="hs-identifier hs-var">mkTuplePat</span></a></span><span> </span><span id="local-6989586621679412489"><span class="annot"><span class="annottext">pats :: [Pat]
</span><a href="#local-6989586621679412489"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Pat
</span><span class="hs-identifier hs-var">ConP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Name
</span><span class="hs-identifier hs-var">tupleDataName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pat] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679412489"><span class="hs-identifier hs-var">pats</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621679412489"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-1362"></span><span>
</span><span id="line-1363"></span><span class="hs-comment">-- | Is this pattern guaranteed to match?</span><span>
</span><span id="line-1364"></span><span id="local-6989586621679413913"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-type">isUniversalPattern</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413913"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPat"><span class="hs-identifier hs-type">DPat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413913"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-1365"></span><span id="isUniversalPattern"><span class="annot"><span class="annottext">isUniversalPattern :: DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var hs-var">isUniversalPattern</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLitP"><span class="hs-identifier hs-type">DLitP</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; q Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1366"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarP"><span class="hs-identifier hs-type">DVarP</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; q Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1367"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConP"><span class="hs-identifier hs-type">DConP</span></a></span><span> </span><span id="local-6989586621679412488"><span class="annot"><span class="annottext">con_name :: Name
</span><a href="#local-6989586621679412488"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span id="local-6989586621679412487"><span class="annot"><span class="annottext">pats :: [DPat]
</span><a href="#local-6989586621679412487"><span class="hs-identifier hs-var">pats</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1368"></span><span>  </span><span id="local-6989586621679412486"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412486"><span class="hs-identifier hs-var">data_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; q Name
forall (q :: * -&gt; *). DsMonad q =&gt; Name -&gt; q Name
</span><a href="Language.Haskell.TH.Desugar.Reify.html#dataConNameToDataName"><span class="hs-identifier hs-var">dataConNameToDataName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412488"><span class="hs-identifier hs-var">con_name</span></a></span><span>
</span><span id="line-1369"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679412484"><span class="annot"><span class="annottext">_tvbs :: [TyVarBndr]
</span><a href="#local-6989586621679412484"><span class="hs-identifier hs-var">_tvbs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412483"><span class="annot"><span class="annottext">cons :: [Con]
</span><a href="#local-6989586621679412483"><span class="hs-identifier hs-var">cons</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name -&gt; q ([TyVarBndr], [Con])
forall (q :: * -&gt; *).
DsMonad q =&gt;
String -&gt; Name -&gt; q ([TyVarBndr], [Con])
</span><a href="Language.Haskell.TH.Desugar.Reify.html#getDataD"><span class="hs-identifier hs-var">getDataD</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Internal error.&quot;</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412486"><span class="hs-identifier hs-var">data_name</span></a></span><span>
</span><span id="line-1370"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Con] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Con]
</span><a href="#local-6989586621679412483"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-1371"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; Bool) -&gt; q [Bool] -&gt; q Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">and</span></span><span> </span><span class="annot"><span class="annottext">(q [Bool] -&gt; q Bool) -&gt; q [Bool] -&gt; q Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(DPat -&gt; q Bool) -&gt; [DPat] -&gt; q [Bool]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q Bool
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="annot"><span class="annottext">[DPat]
</span><a href="#local-6989586621679412487"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-1372"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; q Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1373"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTildeP"><span class="hs-identifier hs-type">DTildeP</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; q Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1374"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DBangP"><span class="hs-identifier hs-type">DBangP</span></a></span><span> </span><span id="local-6989586621679412482"><span class="annot"><span class="annottext">pat :: DPat
</span><a href="#local-6989586621679412482"><span class="hs-identifier hs-var">pat</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q Bool
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679412482"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-1375"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigP"><span class="hs-identifier hs-type">DSigP</span></a></span><span> </span><span id="local-6989586621679412481"><span class="annot"><span class="annottext">pat :: DPat
</span><a href="#local-6989586621679412481"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DPat -&gt; q Bool
forall (q :: * -&gt; *). DsMonad q =&gt; DPat -&gt; q Bool
</span><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="annot"><span class="annottext">DPat
</span><a href="#local-6989586621679412481"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-1376"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#isUniversalPattern"><span class="hs-identifier hs-var">isUniversalPattern</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DWildP"><span class="hs-identifier hs-type">DWildP</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; q Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1377"></span><span>
</span><span id="line-1378"></span><span class="hs-comment">-- | Apply one 'DExp' to a list of arguments</span><span>
</span><span id="line-1379"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#applyDExp"><span class="hs-identifier hs-type">applyDExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DExp"><span class="hs-identifier hs-type">DExp</span></a></span><span>
</span><span id="line-1380"></span><span id="applyDExp"><span class="annot"><span class="annottext">applyDExp :: DExp -&gt; [DExp] -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.Core.html#applyDExp"><span class="hs-identifier hs-var hs-var">applyDExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DExp -&gt; DExp -&gt; DExp) -&gt; DExp -&gt; [DExp] -&gt; DExp
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DExp -&gt; DExp -&gt; DExp
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppE"><span class="hs-identifier hs-var">DAppE</span></a></span><span>
</span><span id="line-1381"></span><span>
</span><span id="line-1382"></span><span class="hs-comment">-- | Apply one 'DType' to a list of arguments</span><span>
</span><span id="line-1383"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#applyDType"><span class="hs-identifier hs-type">applyDType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1384"></span><span id="applyDType"><span class="annot"><span class="annottext">applyDType :: DType -&gt; [DTypeArg] -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#applyDType"><span class="hs-identifier hs-var hs-var">applyDType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DTypeArg -&gt; DType) -&gt; DType -&gt; [DTypeArg] -&gt; DType
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; DTypeArg -&gt; DType
</span><a href="#local-6989586621679412479"><span class="hs-identifier hs-var">apply</span></a></span><span>
</span><span id="line-1385"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1386"></span><span>    </span><span class="annot"><a href="#local-6989586621679412479"><span class="hs-identifier hs-type">apply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1387"></span><span>    </span><span id="local-6989586621679412479"><span class="annot"><span class="annottext">apply :: DType -&gt; DTypeArg -&gt; DType
</span><a href="#local-6989586621679412479"><span class="hs-identifier hs-var hs-var">apply</span></a></span></span><span> </span><span id="local-6989586621679412478"><span class="annot"><span class="annottext">f :: DType
</span><a href="#local-6989586621679412478"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-type">DTANormal</span></a></span><span> </span><span id="local-6989586621679412476"><span class="annot"><span class="annottext">x :: DType
</span><a href="#local-6989586621679412476"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412478"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-operator hs-var">`DAppT`</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412476"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1388"></span><span>    </span><span class="annot"><a href="#local-6989586621679412479"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span id="local-6989586621679412475"><span class="annot"><span class="annottext">f :: DType
</span><a href="#local-6989586621679412475"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTyArg"><span class="hs-identifier hs-type">DTyArg</span></a></span><span> </span><span id="local-6989586621679412473"><span class="annot"><span class="annottext">x :: DType
</span><a href="#local-6989586621679412473"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412475"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DAppKindT"><span class="hs-operator hs-var">`DAppKindT`</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412473"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1389"></span><span>
</span><span id="line-1390"></span><span class="hs-comment">-- | An argument to a type, either a normal type ('DTANormal') or a visible</span><span>
</span><span id="line-1391"></span><span class="hs-comment">-- kind application ('DTyArg').</span><span>
</span><span id="line-1392"></span><span class="hs-comment">--</span><span>
</span><span id="line-1393"></span><span class="hs-comment">-- 'DTypeArg' does not appear directly in the @th-desugar@ AST, but it is</span><span>
</span><span id="line-1394"></span><span class="hs-comment">-- useful when decomposing an application of a 'DType' to its arguments.</span><span>
</span><span id="line-1395"></span><span id="local-6989586621679412471"><span id="local-6989586621679412472"></span></span><span class="hs-keyword">data</span><span> </span><span id="DTypeArg"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-var">DTypeArg</span></a></span></span><span>
</span><span id="line-1396"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="DTANormal"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-var">DTANormal</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1397"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DTyArg"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTyArg"><span class="hs-identifier hs-var">DTyArg</span></a></span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span>
</span><span id="line-1398"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679412467"><span id="local-6989586621679412469"><span class="annot"><span class="annottext">DTypeArg -&gt; DTypeArg -&gt; Bool
(DTypeArg -&gt; DTypeArg -&gt; Bool)
-&gt; (DTypeArg -&gt; DTypeArg -&gt; Bool) -&gt; Eq DTypeArg
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DTypeArg -&gt; DTypeArg -&gt; Bool
$c/= :: DTypeArg -&gt; DTypeArg -&gt; Bool
== :: DTypeArg -&gt; DTypeArg -&gt; Bool
$c== :: DTypeArg -&gt; DTypeArg -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412460"><span id="local-6989586621679412462"><span id="local-6989586621679412464"><span class="annot"><span class="annottext">Int -&gt; DTypeArg -&gt; String -&gt; String
[DTypeArg] -&gt; String -&gt; String
DTypeArg -&gt; String
(Int -&gt; DTypeArg -&gt; String -&gt; String)
-&gt; (DTypeArg -&gt; String)
-&gt; ([DTypeArg] -&gt; String -&gt; String)
-&gt; Show DTypeArg
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [DTypeArg] -&gt; String -&gt; String
$cshowList :: [DTypeArg] -&gt; String -&gt; String
show :: DTypeArg -&gt; String
$cshow :: DTypeArg -&gt; String
showsPrec :: Int -&gt; DTypeArg -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; DTypeArg -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">,</span><span> </span><span id="%24cDTyArg"><span id="%24cDTANormal"><span id="%24tDTypeArg"><span id="local-6989586621679412430"><span id="local-6989586621679412432"><span id="local-6989586621679412434"><span id="local-6989586621679412436"><span id="local-6989586621679412438"><span id="local-6989586621679412440"><span id="local-6989586621679412442"><span id="local-6989586621679412444"><span id="local-6989586621679412446"><span id="local-6989586621679412448"><span id="local-6989586621679412450"><span id="local-6989586621679412452"><span id="local-6989586621679412454"><span id="local-6989586621679412456"><span class="annot"><span class="annottext">Typeable DTypeArg
DataType
Constr
Typeable DTypeArg =&gt;
(forall (c :: * -&gt; *).
 (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
 -&gt; (forall g. g -&gt; c g) -&gt; DTypeArg -&gt; c DTypeArg)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DTypeArg)
-&gt; (DTypeArg -&gt; Constr)
-&gt; (DTypeArg -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DTypeArg))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DTypeArg))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; DTypeArg -&gt; DTypeArg)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg)
-&gt; Data DTypeArg
DTypeArg -&gt; DataType
DTypeArg -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; DTypeArg -&gt; DTypeArg
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DTypeArg -&gt; c DTypeArg
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DTypeArg
forall a.
Typeable a =&gt;
(forall (c :: * -&gt; *).
 (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
 -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DTypeArg
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DTypeArg -&gt; c DTypeArg
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DTypeArg)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DTypeArg)
$cDTyArg :: Constr
$cDTANormal :: Constr
$tDTypeArg :: DataType
gmapMo :: (forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
gmapMp :: (forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
gmapM :: (forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; DTypeArg -&gt; m DTypeArg
gmapQi :: Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; u
gmapQ :: (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; DTypeArg -&gt; [u]
gmapQr :: (r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r
gmapQl :: (r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; DTypeArg -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; DTypeArg -&gt; DTypeArg
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; DTypeArg -&gt; DTypeArg
dataCast2 :: (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DTypeArg)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c DTypeArg)
dataCast1 :: (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DTypeArg)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c DTypeArg)
dataTypeOf :: DTypeArg -&gt; DataType
$cdataTypeOf :: DTypeArg -&gt; DataType
toConstr :: DTypeArg -&gt; Constr
$ctoConstr :: DTypeArg -&gt; Constr
gunfold :: (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DTypeArg
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c DTypeArg
gfoldl :: (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DTypeArg -&gt; c DTypeArg
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; DTypeArg -&gt; c DTypeArg
$cp1Data :: Typeable DTypeArg
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. DTypeArg -&gt; Rep DTypeArg x)
-&gt; (forall x. Rep DTypeArg x -&gt; DTypeArg) -&gt; Generic DTypeArg
forall x. Rep DTypeArg x -&gt; DTypeArg
forall x. DTypeArg -&gt; Rep DTypeArg x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep DTypeArg x -&gt; DTypeArg
$cfrom :: forall x. DTypeArg -&gt; Rep DTypeArg x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-1399"></span><span>
</span><span id="line-1400"></span><span class="hs-comment">-- | Desugar a 'TypeArg'.</span><span>
</span><span id="line-1401"></span><span id="local-6989586621679413807"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeArg"><span class="hs-identifier hs-type">dsTypeArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Reify.html#DsMonad"><span class="hs-identifier hs-type">DsMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679413807"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TypeArg"><span class="hs-identifier hs-type">TypeArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679413807"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span></span><span>
</span><span id="line-1402"></span><span id="dsTypeArg"><span class="annot"><span class="annottext">dsTypeArg :: TypeArg -&gt; q DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeArg"><span class="hs-identifier hs-var hs-var">dsTypeArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TANormal"><span class="hs-identifier hs-type">TANormal</span></a></span><span> </span><span id="local-6989586621679412421"><span class="annot"><span class="annottext">t :: Type
</span><a href="#local-6989586621679412421"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-var">DTANormal</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DTypeArg) -&gt; q DType -&gt; q DTypeArg
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412421"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1403"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dsTypeArg"><span class="hs-identifier hs-var">dsTypeArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Util.html#TyArg"><span class="hs-identifier hs-type">TyArg</span></a></span><span> </span><span id="local-6989586621679412419"><span class="annot"><span class="annottext">k :: Type
</span><a href="#local-6989586621679412419"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#DTyArg"><span class="hs-identifier hs-var">DTyArg</span></a></span><span>    </span><span class="annot"><span class="annottext">(DType -&gt; DTypeArg) -&gt; q DType -&gt; q DTypeArg
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; q DType
forall (q :: * -&gt; *). DsMonad q =&gt; Type -&gt; q DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dsType"><span class="hs-identifier hs-var">dsType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679412419"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1404"></span><span>
</span><span id="line-1405"></span><span class="hs-comment">-- | Filter the normal type arguments from a list of 'DTypeArg's.</span><span>
</span><span id="line-1406"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#filterDTANormals"><span class="hs-identifier hs-type">filterDTANormals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1407"></span><span id="filterDTANormals"><span class="annot"><span class="annottext">filterDTANormals :: [DTypeArg] -&gt; DCxt
</span><a href="Language.Haskell.TH.Desugar.Core.html#filterDTANormals"><span class="hs-identifier hs-var hs-var">filterDTANormals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DTypeArg -&gt; Maybe DType) -&gt; [DTypeArg] -&gt; DCxt
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">DTypeArg -&gt; Maybe DType
</span><a href="#local-6989586621679412417"><span class="hs-identifier hs-var">getDTANormal</span></a></span><span>
</span><span id="line-1408"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1409"></span><span>    </span><span class="annot"><a href="#local-6989586621679412417"><span class="hs-identifier hs-type">getDTANormal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1410"></span><span>    </span><span id="local-6989586621679412417"><span class="annot"><span class="annottext">getDTANormal :: DTypeArg -&gt; Maybe DType
</span><a href="#local-6989586621679412417"><span class="hs-identifier hs-var hs-var">getDTANormal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-type">DTANormal</span></a></span><span> </span><span id="local-6989586621679412416"><span class="annot"><span class="annottext">t :: DType
</span><a href="#local-6989586621679412416"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Maybe DType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412416"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1411"></span><span>    </span><span class="annot"><a href="#local-6989586621679412417"><span class="hs-identifier hs-var">getDTANormal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTyArg"><span class="hs-identifier hs-type">DTyArg</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe DType
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1412"></span><span>
</span><span id="line-1413"></span><span class="hs-comment">-- | Convert a 'DTyVarBndr' into a 'DType'</span><span>
</span><span id="line-1414"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dTyVarBndrToDType"><span class="hs-identifier hs-type">dTyVarBndrToDType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1415"></span><span id="dTyVarBndrToDType"><span class="annot"><span class="annottext">dTyVarBndrToDType :: DTyVarBndr -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dTyVarBndrToDType"><span class="hs-identifier hs-var hs-var">dTyVarBndrToDType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPlainTV"><span class="hs-identifier hs-type">DPlainTV</span></a></span><span> </span><span id="local-6989586621679412414"><span class="annot"><span class="annottext">a :: Name
</span><a href="#local-6989586621679412414"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-var">DVarT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412414"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1416"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dTyVarBndrToDType"><span class="hs-identifier hs-var">dTyVarBndrToDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-type">DKindedTV</span></a></span><span> </span><span id="local-6989586621679412413"><span class="annot"><span class="annottext">a :: Name
</span><a href="#local-6989586621679412413"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679412412"><span class="annot"><span class="annottext">k :: DType
</span><a href="#local-6989586621679412412"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-var">DVarT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412413"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">DType -&gt; DType -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DSigT"><span class="hs-operator hs-var">`DSigT`</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412412"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1417"></span><span>
</span><span id="line-1418"></span><span class="hs-comment">-- | Extract the underlying 'DType' or 'DKind' from a 'DTypeArg'. This forgets</span><span>
</span><span id="line-1419"></span><span class="hs-comment">-- information about whether a type is a normal argument or not, so use with</span><span>
</span><span id="line-1420"></span><span class="hs-comment">-- caution.</span><span>
</span><span id="line-1421"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#probablyWrongUnDTypeArg"><span class="hs-identifier hs-type">probablyWrongUnDTypeArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1422"></span><span id="probablyWrongUnDTypeArg"><span class="annot"><span class="annottext">probablyWrongUnDTypeArg :: DTypeArg -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#probablyWrongUnDTypeArg"><span class="hs-identifier hs-var hs-var">probablyWrongUnDTypeArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-type">DTANormal</span></a></span><span> </span><span id="local-6989586621679412410"><span class="annot"><span class="annottext">t :: DType
</span><a href="#local-6989586621679412410"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412410"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1423"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#probablyWrongUnDTypeArg"><span class="hs-identifier hs-var">probablyWrongUnDTypeArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTyArg"><span class="hs-identifier hs-type">DTyArg</span></a></span><span> </span><span id="local-6989586621679412409"><span class="annot"><span class="annottext">k :: DType
</span><a href="#local-6989586621679412409"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412409"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1424"></span><span>
</span><span id="line-1425"></span><span class="hs-comment">-- | Convert a 'Strict' to a 'Bang' in GHCs 7.x. This is just</span><span>
</span><span id="line-1426"></span><span class="hs-comment">-- the identity operation in GHC 8.x, which has no 'Strict'.</span><span>
</span><span id="line-1427"></span><span class="hs-comment">-- (This is included in GHC 8.x only for good Haddocking.)</span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &lt;= 710
</span><span class="hs-identifier">strictToBang</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Strict</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Bang</span><span>
</span><span id="line-1430"></span><span class="hs-identifier">strictToBang</span><span> </span><span class="hs-identifier">IsStrict</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Bang</span><span> </span><span class="hs-identifier">NoSourceUnpackedness</span><span> </span><span class="hs-identifier">SourceStrict</span><span>
</span><span id="line-1431"></span><span class="hs-identifier">strictToBang</span><span> </span><span class="hs-identifier">NotStrict</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Bang</span><span> </span><span class="hs-identifier">NoSourceUnpackedness</span><span> </span><span class="hs-identifier">NoSourceStrictness</span><span>
</span><span id="line-1432"></span><span class="hs-identifier">strictToBang</span><span> </span><span class="hs-identifier">Unpacked</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Bang</span><span> </span><span class="hs-identifier">SourceUnpack</span><span> </span><span class="hs-identifier">SourceStrict</span><span class="hs-cpp">
#else
</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#strictToBang"><span class="hs-identifier hs-type">strictToBang</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bang</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bang</span></span><span>
</span><span id="line-1435"></span><span id="strictToBang"><span class="annot"><span class="annottext">strictToBang :: Bang -&gt; Bang
</span><a href="Language.Haskell.TH.Desugar.Core.html#strictToBang"><span class="hs-identifier hs-var hs-var">strictToBang</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bang -&gt; Bang
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1438"></span><span class="hs-comment">-- Take a data type name (which does not belong to a data family) and</span><span>
</span><span id="line-1439"></span><span class="hs-comment">-- apply it to its type variable binders to form a DType.</span><span>
</span><span id="line-1440"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#nonFamilyDataReturnType"><span class="hs-identifier hs-type">nonFamilyDataReturnType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1441"></span><span id="nonFamilyDataReturnType"><span class="annot"><span class="annottext">nonFamilyDataReturnType :: Name -&gt; [DTyVarBndr] -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#nonFamilyDataReturnType"><span class="hs-identifier hs-var hs-var">nonFamilyDataReturnType</span></a></span></span><span> </span><span id="local-6989586621679412407"><span class="annot"><span class="annottext">con_name :: Name
</span><a href="#local-6989586621679412407"><span class="hs-identifier hs-var">con_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1442"></span><span>  </span><span class="annot"><span class="annottext">DType -&gt; [DTypeArg] -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#applyDType"><span class="hs-identifier hs-var">applyDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412407"><span class="hs-identifier hs-var">con_name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([DTypeArg] -&gt; DType)
-&gt; ([DTyVarBndr] -&gt; [DTypeArg]) -&gt; [DTyVarBndr] -&gt; DType
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; DTypeArg) -&gt; [DTyVarBndr] -&gt; [DTypeArg]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-var">DTANormal</span></a></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; DTypeArg)
-&gt; (DTyVarBndr -&gt; DType) -&gt; DTyVarBndr -&gt; DTypeArg
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dTyVarBndrToDType"><span class="hs-identifier hs-var">dTyVarBndrToDType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1443"></span><span>
</span><span id="line-1444"></span><span class="hs-comment">-- Take a data family name and apply it to its argument types to form a</span><span>
</span><span id="line-1445"></span><span class="hs-comment">-- data family instance DType.</span><span>
</span><span id="line-1446"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dataFamInstReturnType"><span class="hs-identifier hs-type">dataFamInstReturnType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span>
</span><span id="line-1447"></span><span id="dataFamInstReturnType"><span class="annot"><span class="annottext">dataFamInstReturnType :: Name -&gt; [DTypeArg] -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#dataFamInstReturnType"><span class="hs-identifier hs-var hs-var">dataFamInstReturnType</span></a></span></span><span> </span><span id="local-6989586621679412406"><span class="annot"><span class="annottext">fam_name :: Name
</span><a href="#local-6989586621679412406"><span class="hs-identifier hs-var">fam_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; [DTypeArg] -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#applyDType"><span class="hs-identifier hs-var">applyDType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-var">DConT</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412406"><span class="hs-identifier hs-var">fam_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1448"></span><span>
</span><span id="line-1449"></span><span class="hs-comment">-- Data family instance declarations did not come equipped with a list of bound</span><span>
</span><span id="line-1450"></span><span class="hs-comment">-- type variables until GHC 8.8 (and even then, it's optional whether the user</span><span>
</span><span id="line-1451"></span><span class="hs-comment">-- provides them or not). This means that there are situations where we must</span><span>
</span><span id="line-1452"></span><span class="hs-comment">-- reverse engineer this information ourselves from the list of type</span><span>
</span><span id="line-1453"></span><span class="hs-comment">-- arguments. We accomplish this by taking the free variables of the types</span><span>
</span><span id="line-1454"></span><span class="hs-comment">-- and performing a reverse topological sort on them to ensure that the</span><span>
</span><span id="line-1455"></span><span class="hs-comment">-- returned list is well scoped.</span><span>
</span><span id="line-1456"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dataFamInstTvbs"><span class="hs-identifier hs-type">dataFamInstTvbs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1457"></span><span id="dataFamInstTvbs"><span class="annot"><span class="annottext">dataFamInstTvbs :: [DTypeArg] -&gt; [DTyVarBndr]
</span><a href="Language.Haskell.TH.Desugar.Core.html#dataFamInstTvbs"><span class="hs-identifier hs-var hs-var">dataFamInstTvbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; [DTyVarBndr]
</span><a href="Language.Haskell.TH.Desugar.Core.html#toposortTyVarsOf"><span class="hs-identifier hs-var">toposortTyVarsOf</span></a></span><span> </span><span class="annot"><span class="annottext">(DCxt -&gt; [DTyVarBndr])
-&gt; ([DTypeArg] -&gt; DCxt) -&gt; [DTypeArg] -&gt; [DTyVarBndr]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DTypeArg -&gt; DType) -&gt; [DTypeArg] -&gt; DCxt
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">DTypeArg -&gt; DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#probablyWrongUnDTypeArg"><span class="hs-identifier hs-var">probablyWrongUnDTypeArg</span></a></span><span>
</span><span id="line-1458"></span><span>
</span><span id="line-1459"></span><span class="hs-comment">-- | Take a list of 'DType's, find their free variables, and sort them in</span><span>
</span><span id="line-1460"></span><span class="hs-comment">-- reverse topological order to ensure that they are well scoped. In other</span><span>
</span><span id="line-1461"></span><span class="hs-comment">-- words, the free variables are ordered such that:</span><span>
</span><span id="line-1462"></span><span class="hs-comment">--</span><span>
</span><span id="line-1463"></span><span class="hs-comment">-- 1. Whenever an explicit kind signature of the form @(A :: K)@ is</span><span>
</span><span id="line-1464"></span><span class="hs-comment">--    encountered, the free variables of @K@ will always appear to the left of</span><span>
</span><span id="line-1465"></span><span class="hs-comment">--    the free variables of @A@ in the returned result.</span><span>
</span><span id="line-1466"></span><span class="hs-comment">--</span><span>
</span><span id="line-1467"></span><span class="hs-comment">-- 2. The constraint in (1) notwithstanding, free variables will appear in</span><span>
</span><span id="line-1468"></span><span class="hs-comment">--    left-to-right order of their original appearance.</span><span>
</span><span id="line-1469"></span><span class="hs-comment">--</span><span>
</span><span id="line-1470"></span><span class="hs-comment">-- On older GHCs, this takes measures to avoid returning explicitly bound</span><span>
</span><span id="line-1471"></span><span class="hs-comment">-- kind variables, which was not possible before @TypeInType@.</span><span>
</span><span id="line-1472"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#toposortTyVarsOf"><span class="hs-identifier hs-type">toposortTyVarsOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1473"></span><span id="toposortTyVarsOf"><span class="annot"><span class="annottext">toposortTyVarsOf :: DCxt -&gt; [DTyVarBndr]
</span><a href="Language.Haskell.TH.Desugar.Core.html#toposortTyVarsOf"><span class="hs-identifier hs-var hs-var">toposortTyVarsOf</span></a></span></span><span> </span><span id="local-6989586621679412405"><span class="annot"><span class="annottext">tys :: DCxt
</span><a href="#local-6989586621679412405"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1474"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679412404"><span class="hs-identifier hs-type">freeVars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>
</span><span id="line-1475"></span><span>      </span><span id="local-6989586621679412404"><span class="annot"><span class="annottext">freeVars :: [Name]
</span><a href="#local-6989586621679412404"><span class="hs-identifier hs-var hs-var">freeVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OSet Name -&gt; [Name]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">(OSet Name -&gt; [Name]) -&gt; OSet Name -&gt; [Name]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(DType -&gt; OSet Name) -&gt; DCxt -&gt; OSet Name
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.FV.html#fvDType"><span class="hs-identifier hs-var">fvDType</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679412405"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1476"></span><span>
</span><span id="line-1477"></span><span>      </span><span class="annot"><a href="#local-6989586621679412401"><span class="hs-identifier hs-type">varKindSigs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span>
</span><span id="line-1478"></span><span>      </span><span id="local-6989586621679412401"><span class="annot"><span class="annottext">varKindSigs :: Map Name DType
</span><a href="#local-6989586621679412401"><span class="hs-identifier hs-var hs-var">varKindSigs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DType -&gt; Map Name DType) -&gt; DCxt -&gt; Map Name DType
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679412400"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679412405"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1479"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-1480"></span><span>          </span><span class="annot"><a href="#local-6989586621679412400"><span class="hs-identifier hs-type">go_ty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span>
</span><span id="line-1481"></span><span>          </span><span id="local-6989586621679412400"><span class="annot"><span class="annottext">go_ty :: DType -&gt; Map Name DType
</span><a href="#local-6989586621679412400"><span class="hs-identifier hs-var hs-var">go_ty</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-type">DForallT</span></a></span><span> </span><span id="local-6989586621679412399"><span class="annot"><span class="annottext">tvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679412399"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679412398"><span class="annot"><span class="annottext">ctxt :: DCxt
</span><a href="#local-6989586621679412398"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679412397"><span class="annot"><span class="annottext">t :: DType
</span><a href="#local-6989586621679412397"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1482"></span><span>            </span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; Map Name DType -&gt; Map Name DType
</span><a href="#local-6989586621679412396"><span class="hs-identifier hs-var">go_tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412399"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DType -&gt; Map Name DType) -&gt; DCxt -&gt; Map Name DType
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679412400"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679412398"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType -&gt; Map Name DType -&gt; Map Name DType
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679412400"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412397"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1483"></span><span>          </span><span class="annot"><a href="#local-6989586621679412400"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-type">DAppT</span></a></span><span> </span><span id="local-6989586621679412395"><span class="annot"><span class="annottext">t1 :: DType
</span><a href="#local-6989586621679412395"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679412394"><span class="annot"><span class="annottext">t2 :: DType
</span><a href="#local-6989586621679412394"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679412400"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412395"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType -&gt; Map Name DType -&gt; Map Name DType
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679412400"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412394"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-1484"></span><span>          </span><span class="annot"><a href="#local-6989586621679412400"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppKindT"><span class="hs-identifier hs-type">DAppKindT</span></a></span><span> </span><span id="local-6989586621679412393"><span class="annot"><span class="annottext">t :: DType
</span><a href="#local-6989586621679412393"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679412392"><span class="annot"><span class="annottext">k :: DType
</span><a href="#local-6989586621679412392"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679412400"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412393"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType -&gt; Map Name DType -&gt; Map Name DType
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679412400"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412392"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1485"></span><span>          </span><span class="annot"><a href="#local-6989586621679412400"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigT"><span class="hs-identifier hs-type">DSigT</span></a></span><span> </span><span id="local-6989586621679412391"><span class="annot"><span class="annottext">t :: DType
</span><a href="#local-6989586621679412391"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679412390"><span class="annot"><span class="annottext">k :: DType
</span><a href="#local-6989586621679412390"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1486"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679412389"><span class="annot"><span class="annottext">kSigs :: Map Name DType
</span><a href="#local-6989586621679412389"><span class="hs-identifier hs-var hs-var">kSigs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679412400"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412390"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1487"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412391"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1488"></span><span>                 </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-type">DVarT</span></a></span><span> </span><span id="local-6989586621679412388"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412388"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; Map Name DType -&gt; Map Name DType
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412388"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412390"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType
</span><a href="#local-6989586621679412389"><span class="hs-identifier hs-var">kSigs</span></a></span><span>
</span><span id="line-1489"></span><span>                 </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679412400"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412391"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType -&gt; Map Name DType -&gt; Map Name DType
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">Map Name DType
</span><a href="#local-6989586621679412389"><span class="hs-identifier hs-var">kSigs</span></a></span><span>
</span><span id="line-1490"></span><span>          </span><span class="annot"><a href="#local-6989586621679412400"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DVarT"><span class="hs-identifier hs-type">DVarT</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name DType
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1491"></span><span>          </span><span class="annot"><a href="#local-6989586621679412400"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DConT"><span class="hs-identifier hs-type">DConT</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name DType
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1492"></span><span>          </span><span class="annot"><a href="#local-6989586621679412400"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DArrowT"><span class="hs-identifier hs-type">DArrowT</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name DType
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1493"></span><span>          </span><span class="annot"><a href="#local-6989586621679412400"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DLitT"><span class="hs-identifier hs-type">DLitT</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name DType
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1494"></span><span>          </span><span class="annot"><a href="#local-6989586621679412400"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DWildCardT"><span class="hs-identifier hs-type">DWildCardT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name DType
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-1495"></span><span>
</span><span id="line-1496"></span><span>          </span><span class="annot"><a href="#local-6989586621679412396"><span class="hs-identifier hs-type">go_tvbs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span>
</span><span id="line-1497"></span><span>          </span><span id="local-6989586621679412396"><span class="annot"><span class="annottext">go_tvbs :: [DTyVarBndr] -&gt; Map Name DType -&gt; Map Name DType
</span><a href="#local-6989586621679412396"><span class="hs-identifier hs-var hs-var">go_tvbs</span></a></span></span><span> </span><span id="local-6989586621679412386"><span class="annot"><span class="annottext">tvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679412386"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679412385"><span class="annot"><span class="annottext">m :: Map Name DType
</span><a href="#local-6989586621679412385"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DTyVarBndr -&gt; Map Name DType -&gt; Map Name DType)
-&gt; Map Name DType -&gt; [DTyVarBndr] -&gt; Map Name DType
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; Map Name DType -&gt; Map Name DType
</span><a href="#local-6989586621679412384"><span class="hs-identifier hs-var">go_tvb</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType
</span><a href="#local-6989586621679412385"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412386"><span class="hs-identifier hs-var">tvbs</span></a></span><span>
</span><span id="line-1498"></span><span>
</span><span id="line-1499"></span><span>          </span><span class="annot"><a href="#local-6989586621679412384"><span class="hs-identifier hs-type">go_tvb</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span>
</span><span id="line-1500"></span><span>          </span><span id="local-6989586621679412384"><span class="annot"><span class="annottext">go_tvb :: DTyVarBndr -&gt; Map Name DType -&gt; Map Name DType
</span><a href="#local-6989586621679412384"><span class="hs-identifier hs-var hs-var">go_tvb</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPlainTV"><span class="hs-identifier hs-type">DPlainTV</span></a></span><span> </span><span id="local-6989586621679412383"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412383"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>    </span><span id="local-6989586621679412382"><span class="annot"><span class="annottext">m :: Map Name DType
</span><a href="#local-6989586621679412382"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Map Name DType -&gt; Map Name DType
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.delete</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412383"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType
</span><a href="#local-6989586621679412382"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1501"></span><span>          </span><span class="annot"><a href="#local-6989586621679412384"><span class="hs-identifier hs-var">go_tvb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-type">DKindedTV</span></a></span><span> </span><span id="local-6989586621679412380"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412380"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679412379"><span class="annot"><span class="annottext">k :: DType
</span><a href="#local-6989586621679412379"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679412378"><span class="annot"><span class="annottext">m :: Map Name DType
</span><a href="#local-6989586621679412378"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Map Name DType -&gt; Map Name DType
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.delete</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412380"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType
</span><a href="#local-6989586621679412378"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType -&gt; Map Name DType -&gt; Map Name DType
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mappend`</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; Map Name DType
</span><a href="#local-6989586621679412400"><span class="hs-identifier hs-var">go_ty</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412379"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1502"></span><span>
</span><span id="line-1503"></span><span>      </span><span class="hs-comment">-- | Do a topological sort on a list of tyvars,</span><span>
</span><span id="line-1504"></span><span>      </span><span class="hs-comment">--   so that binders occur before occurrences</span><span>
</span><span id="line-1505"></span><span>      </span><span class="hs-comment">-- E.g. given  [ a::k, k::*, b::k ]</span><span>
</span><span id="line-1506"></span><span>      </span><span class="hs-comment">-- it'll return a well-scoped list [ k::*, a::k, b::k ]</span><span>
</span><span id="line-1507"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1508"></span><span>      </span><span class="hs-comment">-- This is a deterministic sorting operation</span><span>
</span><span id="line-1509"></span><span>      </span><span class="hs-comment">-- (that is, doesn't depend on Uniques).</span><span>
</span><span id="line-1510"></span><span>      </span><span class="hs-comment">--</span><span>
</span><span id="line-1511"></span><span>      </span><span class="hs-comment">-- It is also meant to be stable: that is, variables should not</span><span>
</span><span id="line-1512"></span><span>      </span><span class="hs-comment">-- be reordered unnecessarily.</span><span>
</span><span id="line-1513"></span><span>      </span><span class="annot"><a href="#local-6989586621679412377"><span class="hs-identifier hs-type">scopedSort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>
</span><span id="line-1514"></span><span>      </span><span id="local-6989586621679412377"><span class="annot"><span class="annottext">scopedSort :: [Name] -&gt; [Name]
</span><a href="#local-6989586621679412377"><span class="hs-identifier hs-var hs-var">scopedSort</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Set Name] -&gt; [Name] -&gt; [Name]
</span><a href="#local-6989586621679412376"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1515"></span><span>
</span><span id="line-1516"></span><span>      </span><span class="annot"><a href="#local-6989586621679412376"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- already sorted, in reverse order</span><span>
</span><span id="line-1517"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- each set contains all the variables which must be placed</span><span>
</span><span id="line-1518"></span><span>                       </span><span class="hs-comment">-- before the tv corresponding to the set; they are accumulations</span><span>
</span><span id="line-1519"></span><span>                       </span><span class="hs-comment">-- of the fvs in the sorted tvs' kinds</span><span>
</span><span id="line-1520"></span><span>
</span><span id="line-1521"></span><span>                       </span><span class="hs-comment">-- This list is in 1-to-1 correspondence with the sorted tyvars</span><span>
</span><span id="line-1522"></span><span>                       </span><span class="hs-comment">-- INVARIANT:</span><span>
</span><span id="line-1523"></span><span>                       </span><span class="hs-comment">--   all (\tl -&gt; all (`isSubsetOf` head tl) (tail tl)) (tails fv_list)</span><span>
</span><span id="line-1524"></span><span>                       </span><span class="hs-comment">-- That is, each set in the list is a superset of all later sets.</span><span>
</span><span id="line-1525"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- yet to be sorted</span><span>
</span><span id="line-1526"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>
</span><span id="line-1527"></span><span>      </span><span id="local-6989586621679412376"><span class="annot"><span class="annottext">go :: [Name] -&gt; [Set Name] -&gt; [Name] -&gt; [Name]
</span><a href="#local-6989586621679412376"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679412375"><span class="annot"><span class="annottext">acc :: [Name]
</span><a href="#local-6989586621679412375"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679412374"><span class="annot"><span class="annottext">_fv_list :: [Set Name]
</span><a href="#local-6989586621679412374"><span class="hs-identifier hs-var">_fv_list</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679412375"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1528"></span><span>      </span><span class="annot"><a href="#local-6989586621679412376"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679412372"><span class="annot"><span class="annottext">acc :: [Name]
</span><a href="#local-6989586621679412372"><span class="hs-identifier hs-var">acc</span></a></span></span><span>  </span><span id="local-6989586621679412371"><span class="annot"><span class="annottext">fv_list :: [Set Name]
</span><a href="#local-6989586621679412371"><span class="hs-identifier hs-var">fv_list</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679412370"><span class="annot"><span class="annottext">tv :: Name
</span><a href="#local-6989586621679412370"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679412369"><span class="annot"><span class="annottext">tvs :: [Name]
</span><a href="#local-6989586621679412369"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1529"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Set Name] -&gt; [Name] -&gt; [Name]
</span><a href="#local-6989586621679412376"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679412368"><span class="hs-identifier hs-var">acc'</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679412367"><span class="hs-identifier hs-var">fv_list'</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679412369"><span class="hs-identifier hs-var">tvs</span></a></span><span>
</span><span id="line-1530"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-1531"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679412368"><span class="annot"><span class="annottext">acc' :: [Name]
</span><a href="#local-6989586621679412368"><span class="hs-identifier hs-var">acc'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412367"><span class="annot"><span class="annottext">fv_list' :: [Set Name]
</span><a href="#local-6989586621679412367"><span class="hs-identifier hs-var">fv_list'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [Set Name] -&gt; ([Name], [Set Name])
</span><a href="#local-6989586621679412366"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412370"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679412372"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679412371"><span class="hs-identifier hs-var">fv_list</span></a></span><span>
</span><span id="line-1532"></span><span>
</span><span id="line-1533"></span><span>      </span><span class="annot"><a href="#local-6989586621679412366"><span class="hs-identifier hs-type">insert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>       </span><span class="hs-comment">-- var to insert</span><span>
</span><span id="line-1534"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- sorted list, in reverse order</span><span>
</span><span id="line-1535"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- list of fvs, as above</span><span>
</span><span id="line-1536"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- augmented lists</span><span>
</span><span id="line-1537"></span><span>      </span><span id="local-6989586621679412366"><span class="annot"><span class="annottext">insert :: Name -&gt; [Name] -&gt; [Set Name] -&gt; ([Name], [Set Name])
</span><a href="#local-6989586621679412366"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span id="local-6989586621679412365"><span class="annot"><span class="annottext">tv :: Name
</span><a href="#local-6989586621679412365"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412365"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Set Name
</span><a href="#local-6989586621679412364"><span class="hs-identifier hs-var">kindFVSet</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412365"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1538"></span><span>      </span><span class="annot"><a href="#local-6989586621679412366"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span id="local-6989586621679412363"><span class="annot"><span class="annottext">tv :: Name
</span><a href="#local-6989586621679412363"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679412362"><span class="annot"><span class="annottext">a :: Name
</span><a href="#local-6989586621679412362"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679412361"><span class="annot"><span class="annottext">as :: [Name]
</span><a href="#local-6989586621679412361"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679412360"><span class="annot"><span class="annottext">fvs :: Set Name
</span><a href="#local-6989586621679412360"><span class="hs-identifier hs-var">fvs</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679412359"><span class="annot"><span class="annottext">fvss :: [Set Name]
</span><a href="#local-6989586621679412359"><span class="hs-identifier hs-var">fvss</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1539"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412363"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Set Name -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`S.member`</span></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679412360"><span class="hs-identifier hs-var">fvs</span></a></span><span>
</span><span id="line-1540"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679412357"><span class="annot"><span class="annottext">as' :: [Name]
</span><a href="#local-6989586621679412357"><span class="hs-identifier hs-var">as'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412356"><span class="annot"><span class="annottext">fvss' :: [Set Name]
</span><a href="#local-6989586621679412356"><span class="hs-identifier hs-var">fvss'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [Set Name] -&gt; ([Name], [Set Name])
</span><a href="#local-6989586621679412366"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412363"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679412361"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679412359"><span class="hs-identifier hs-var">fvss</span></a></span><span>
</span><span id="line-1541"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412362"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [Name]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679412357"><span class="hs-identifier hs-var">as'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679412360"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; Set Name -&gt; Set Name
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`S.union`</span></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679412354"><span class="hs-identifier hs-var">fv_tv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; [Set Name] -&gt; [Set Name]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679412356"><span class="hs-identifier hs-var">fvss'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1542"></span><span>
</span><span id="line-1543"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>
</span><span id="line-1544"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412363"><span class="hs-identifier hs-var">tv</span></a></span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [Name]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412362"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; [Name]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679412361"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679412360"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; Set Name -&gt; Set Name
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-operator hs-var">`S.union`</span></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679412354"><span class="hs-identifier hs-var">fv_tv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; [Set Name] -&gt; [Set Name]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Set Name
</span><a href="#local-6989586621679412360"><span class="hs-identifier hs-var">fvs</span></a></span><span> </span><span class="annot"><span class="annottext">Set Name -&gt; [Set Name] -&gt; [Set Name]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Set Name]
</span><a href="#local-6989586621679412359"><span class="hs-identifier hs-var">fvss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1545"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-1546"></span><span>          </span><span id="local-6989586621679412354"><span class="annot"><span class="annottext">fv_tv :: Set Name
</span><a href="#local-6989586621679412354"><span class="hs-identifier hs-var hs-var">fv_tv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Set Name
</span><a href="#local-6989586621679412364"><span class="hs-identifier hs-var">kindFVSet</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412363"><span class="hs-identifier hs-var">tv</span></a></span><span>
</span><span id="line-1547"></span><span>
</span><span id="line-1548"></span><span>         </span><span class="hs-comment">-- lists not in correspondence</span><span>
</span><span id="line-1549"></span><span>      </span><span class="annot"><a href="#local-6989586621679412366"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ([Name], [Set Name])
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;scopedSort&quot;</span></span><span>
</span><span id="line-1550"></span><span>
</span><span id="line-1551"></span><span>      </span><span id="local-6989586621679412364"><span class="annot"><span class="annottext">kindFVSet :: Name -&gt; Set Name
</span><a href="#local-6989586621679412364"><span class="hs-identifier hs-var hs-var">kindFVSet</span></a></span></span><span> </span><span id="local-6989586621679412353"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412353"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1552"></span><span>        </span><span class="annot"><span class="annottext">Set Name -&gt; (DType -&gt; Set Name) -&gt; Maybe DType -&gt; Set Name
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Set Name
forall a. Set a
</span><span class="hs-identifier hs-var">S.empty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OSet Name -&gt; Set Name
forall a. OSet a -&gt; Set a
</span><a href="Language.Haskell.TH.Desugar.OSet.html#toSet"><span class="hs-identifier hs-var">OS.toSet</span></a></span><span> </span><span class="annot"><span class="annottext">(OSet Name -&gt; Set Name)
-&gt; (DType -&gt; OSet Name) -&gt; DType -&gt; Set Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">DType -&gt; OSet Name
</span><a href="Language.Haskell.TH.Desugar.FV.html#fvDType"><span class="hs-identifier hs-var">fvDType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1553"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Map Name DType -&gt; Maybe DType
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412353"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType
</span><a href="#local-6989586621679412401"><span class="hs-identifier hs-var">varKindSigs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1554"></span><span>      </span><span id="local-6989586621679412349"><span class="annot"><span class="annottext">ascribeWithKind :: Name -&gt; DTyVarBndr
</span><a href="#local-6989586621679412349"><span class="hs-identifier hs-var hs-var">ascribeWithKind</span></a></span></span><span> </span><span id="local-6989586621679412348"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412348"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1555"></span><span>        </span><span class="annot"><span class="annottext">DTyVarBndr -&gt; (DType -&gt; DTyVarBndr) -&gt; Maybe DType -&gt; DTyVarBndr
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.AST.html#DPlainTV"><span class="hs-identifier hs-var">DPlainTV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412348"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; DType -&gt; DTyVarBndr
</span><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-var">DKindedTV</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412348"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Map Name DType -&gt; Maybe DType
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412348"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name DType
</span><a href="#local-6989586621679412401"><span class="hs-identifier hs-var">varKindSigs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1556"></span><span>
</span><span id="line-1557"></span><span>      </span><span class="hs-comment">-- An annoying wrinkle: GHCs before 8.0 don't support explicitly</span><span>
</span><span id="line-1558"></span><span>      </span><span class="hs-comment">-- quantifying kinds, so something like @forall k (a :: k)@ would be</span><span>
</span><span id="line-1559"></span><span>      </span><span class="hs-comment">-- rejected. To work around this, we filter out any binders whose names</span><span>
</span><span id="line-1560"></span><span>      </span><span class="hs-comment">-- also appear in a kind on old GHCs.</span><span>
</span><span id="line-1561"></span><span>      </span><span id="local-6989586621679412347"><span class="annot"><span class="annottext">isKindBinderOnOldGHCs :: b -&gt; Bool
</span><a href="#local-6989586621679412347"><span class="hs-identifier hs-var hs-var">isKindBinderOnOldGHCs</span></a></span></span><span class="hs-cpp">
#if __GLASGOW_HASKELL__ &gt;= 800
</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; b -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-cpp">
#else
</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier">elem</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">kindVars</span><span class="hs-special">)</span><span>
</span><span id="line-1566"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-1567"></span><span>            </span><span class="hs-identifier">kindVars</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldMap</span><span> </span><span class="hs-identifier">fvDType</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">M.elems</span><span> </span><span class="hs-identifier">varKindSigs</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-1570"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Name -&gt; DTyVarBndr) -&gt; [Name] -&gt; [DTyVarBndr]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; DTyVarBndr
</span><a href="#local-6989586621679412349"><span class="hs-identifier hs-var">ascribeWithKind</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; [DTyVarBndr]) -&gt; [Name] -&gt; [DTyVarBndr]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1571"></span><span>     </span><span class="annot"><span class="annottext">(Name -&gt; Bool) -&gt; [Name] -&gt; [Name]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Name -&gt; Bool) -&gt; Name -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
forall b. b -&gt; Bool
</span><a href="#local-6989586621679412347"><span class="hs-identifier hs-var">isKindBinderOnOldGHCs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; [Name]) -&gt; [Name] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1572"></span><span>     </span><span class="annot"><span class="annottext">[Name] -&gt; [Name]
</span><a href="#local-6989586621679412377"><span class="hs-identifier hs-var">scopedSort</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679412404"><span class="hs-identifier hs-var">freeVars</span></a></span><span>
</span><span id="line-1573"></span><span>
</span><span id="line-1574"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dtvbName"><span class="hs-identifier hs-type">dtvbName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Name</span></span><span>
</span><span id="line-1575"></span><span id="dtvbName"><span class="annot"><span class="annottext">dtvbName :: DTyVarBndr -&gt; Name
</span><a href="Language.Haskell.TH.Desugar.Core.html#dtvbName"><span class="hs-identifier hs-var hs-var">dtvbName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPlainTV"><span class="hs-identifier hs-type">DPlainTV</span></a></span><span> </span><span id="local-6989586621679412343"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412343"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412343"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1576"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#dtvbName"><span class="hs-identifier hs-var">dtvbName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-type">DKindedTV</span></a></span><span> </span><span id="local-6989586621679412342"><span class="annot"><span class="annottext">n :: Name
</span><a href="#local-6989586621679412342"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679412342"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1577"></span><span>
</span><span id="line-1578"></span><span class="hs-comment">-- | Decompose a function type into its type variables, its context, its</span><span>
</span><span id="line-1579"></span><span class="hs-comment">-- argument types, and its result type.</span><span>
</span><span id="line-1580"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#unravel"><span class="hs-identifier hs-type">unravel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPred"><span class="hs-identifier hs-type">DPred</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1581"></span><span id="unravel"><span class="annot"><span class="annottext">unravel :: DType -&gt; ([DTyVarBndr], DCxt, DCxt, DType)
</span><a href="Language.Haskell.TH.Desugar.Core.html#unravel"><span class="hs-identifier hs-var hs-var">unravel</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-type">DForallT</span></a></span><span> </span><span id="local-6989586621679412340"><span class="annot"><span class="annottext">tvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679412340"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span> </span><span id="local-6989586621679412339"><span class="annot"><span class="annottext">cxt :: DCxt
</span><a href="#local-6989586621679412339"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span id="local-6989586621679412338"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679412338"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1582"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679412337"><span class="annot"><span class="annottext">tvbs' :: [DTyVarBndr]
</span><a href="#local-6989586621679412337"><span class="hs-identifier hs-var">tvbs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412336"><span class="annot"><span class="annottext">cxt' :: DCxt
</span><a href="#local-6989586621679412336"><span class="hs-identifier hs-var">cxt'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412335"><span class="annot"><span class="annottext">tys :: DCxt
</span><a href="#local-6989586621679412335"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412334"><span class="annot"><span class="annottext">res :: DType
</span><a href="#local-6989586621679412334"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; ([DTyVarBndr], DCxt, DCxt, DType)
</span><a href="Language.Haskell.TH.Desugar.Core.html#unravel"><span class="hs-identifier hs-var">unravel</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412338"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-1583"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412340"><span class="hs-identifier hs-var">tvbs</span></a></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr] -&gt; [DTyVarBndr] -&gt; [DTyVarBndr]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412337"><span class="hs-identifier hs-var">tvbs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679412339"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="annot"><span class="annottext">DCxt -&gt; DCxt -&gt; DCxt
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679412336"><span class="hs-identifier hs-var">cxt'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679412335"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412334"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1584"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#unravel"><span class="hs-identifier hs-var">unravel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-type">DAppT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-type">DAppT</span></a></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DArrowT"><span class="hs-identifier hs-type">DArrowT</span></a></span><span> </span><span id="local-6989586621679412333"><span class="annot"><span class="annottext">t1 :: DType
</span><a href="#local-6989586621679412333"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679412332"><span class="annot"><span class="annottext">t2 :: DType
</span><a href="#local-6989586621679412332"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1585"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679412331"><span class="annot"><span class="annottext">tvbs :: [DTyVarBndr]
</span><a href="#local-6989586621679412331"><span class="hs-identifier hs-var">tvbs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412330"><span class="annot"><span class="annottext">cxt :: DCxt
</span><a href="#local-6989586621679412330"><span class="hs-identifier hs-var">cxt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412329"><span class="annot"><span class="annottext">tys :: DCxt
</span><a href="#local-6989586621679412329"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679412328"><span class="annot"><span class="annottext">res :: DType
</span><a href="#local-6989586621679412328"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; ([DTyVarBndr], DCxt, DCxt, DType)
</span><a href="Language.Haskell.TH.Desugar.Core.html#unravel"><span class="hs-identifier hs-var">unravel</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412332"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-1586"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DTyVarBndr]
</span><a href="#local-6989586621679412331"><span class="hs-identifier hs-var">tvbs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679412330"><span class="hs-identifier hs-var">cxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412333"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">DType -&gt; DCxt -&gt; DCxt
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">DCxt
</span><a href="#local-6989586621679412329"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412328"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1587"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#unravel"><span class="hs-identifier hs-var">unravel</span></a></span><span> </span><span id="local-6989586621679412327"><span class="annot"><span class="annottext">t :: DType
</span><a href="#local-6989586621679412327"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412327"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1588"></span><span>
</span><span id="line-1589"></span><span class="hs-comment">-- | Decompose an applied type into its individual components. For example, this:</span><span>
</span><span id="line-1590"></span><span class="hs-comment">--</span><span>
</span><span id="line-1591"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1592"></span><span class="hs-comment">-- Proxy \@Type Char</span><span>
</span><span id="line-1593"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1594"></span><span class="hs-comment">--</span><span>
</span><span id="line-1595"></span><span class="hs-comment">-- would be unfolded to this:</span><span>
</span><span id="line-1596"></span><span class="hs-comment">--</span><span>
</span><span id="line-1597"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1598"></span><span class="hs-comment">-- ('DConT' ''Proxy, ['DTyArg' ('DConT' ''Type), 'DTANormal' ('DConT' ''Char)])</span><span>
</span><span id="line-1599"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1600"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#unfoldDType"><span class="hs-identifier hs-type">unfoldDType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1601"></span><span id="unfoldDType"><span class="annot"><span class="annottext">unfoldDType :: DType -&gt; (DType, [DTypeArg])
</span><a href="Language.Haskell.TH.Desugar.Core.html#unfoldDType"><span class="hs-identifier hs-var hs-var">unfoldDType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTypeArg] -&gt; DType -&gt; (DType, [DTypeArg])
</span><a href="#local-6989586621679412325"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1602"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1603"></span><span>    </span><span class="annot"><a href="#local-6989586621679412325"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#DTypeArg"><span class="hs-identifier hs-type">DTypeArg</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1604"></span><span>    </span><span id="local-6989586621679412325"><span class="annot"><span class="annottext">go :: [DTypeArg] -&gt; DType -&gt; (DType, [DTypeArg])
</span><a href="#local-6989586621679412325"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679412324"><span class="annot"><span class="annottext">acc :: [DTypeArg]
</span><a href="#local-6989586621679412324"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DForallT"><span class="hs-identifier hs-type">DForallT</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679412323"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679412323"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTypeArg] -&gt; DType -&gt; (DType, [DTypeArg])
</span><a href="#local-6989586621679412325"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679412324"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412323"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1605"></span><span>    </span><span class="annot"><a href="#local-6989586621679412325"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679412322"><span class="annot"><span class="annottext">acc :: [DTypeArg]
</span><a href="#local-6989586621679412322"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppT"><span class="hs-identifier hs-type">DAppT</span></a></span><span> </span><span id="local-6989586621679412321"><span class="annot"><span class="annottext">ty1 :: DType
</span><a href="#local-6989586621679412321"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span id="local-6989586621679412320"><span class="annot"><span class="annottext">ty2 :: DType
</span><a href="#local-6989586621679412320"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTypeArg] -&gt; DType -&gt; (DType, [DTypeArg])
</span><a href="#local-6989586621679412325"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#DTANormal"><span class="hs-identifier hs-var">DTANormal</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412320"><span class="hs-identifier hs-var">ty2</span></a></span><span class="annot"><span class="annottext">DTypeArg -&gt; [DTypeArg] -&gt; [DTypeArg]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679412322"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412321"><span class="hs-identifier hs-var">ty1</span></a></span><span>
</span><span id="line-1606"></span><span>    </span><span class="annot"><a href="#local-6989586621679412325"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679412319"><span class="annot"><span class="annottext">acc :: [DTypeArg]
</span><a href="#local-6989586621679412319"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DAppKindT"><span class="hs-identifier hs-type">DAppKindT</span></a></span><span> </span><span id="local-6989586621679412318"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679412318"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621679412317"><span class="annot"><span class="annottext">ki :: DType
</span><a href="#local-6989586621679412317"><span class="hs-identifier hs-var">ki</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTypeArg] -&gt; DType -&gt; (DType, [DTypeArg])
</span><a href="#local-6989586621679412325"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType -&gt; DTypeArg
</span><a href="Language.Haskell.TH.Desugar.Core.html#DTyArg"><span class="hs-identifier hs-var">DTyArg</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412317"><span class="hs-identifier hs-var">ki</span></a></span><span class="annot"><span class="annottext">DTypeArg -&gt; [DTypeArg] -&gt; [DTypeArg]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679412319"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412318"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1607"></span><span>    </span><span class="annot"><a href="#local-6989586621679412325"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679412316"><span class="annot"><span class="annottext">acc :: [DTypeArg]
</span><a href="#local-6989586621679412316"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DSigT"><span class="hs-identifier hs-type">DSigT</span></a></span><span> </span><span id="local-6989586621679412315"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679412315"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DTypeArg] -&gt; DType -&gt; (DType, [DTypeArg])
</span><a href="#local-6989586621679412325"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679412316"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412315"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1608"></span><span>    </span><span class="annot"><a href="#local-6989586621679412325"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679412314"><span class="annot"><span class="annottext">acc :: [DTypeArg]
</span><a href="#local-6989586621679412314"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679412313"><span class="annot"><span class="annottext">ty :: DType
</span><a href="#local-6989586621679412313"><span class="hs-identifier hs-var">ty</span></a></span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412313"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[DTypeArg]
</span><a href="#local-6989586621679412314"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1609"></span><span>
</span><span id="line-1610"></span><span class="hs-comment">-- | Extract the kind from a 'TyVarBndr', if one is present.</span><span>
</span><span id="line-1611"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#extractTvbKind"><span class="hs-identifier hs-type">extractTvbKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DTyVarBndr"><span class="hs-identifier hs-type">DTyVarBndr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKind"><span class="hs-identifier hs-type">DKind</span></a></span><span>
</span><span id="line-1612"></span><span id="extractTvbKind"><span class="annot"><span class="annottext">extractTvbKind :: DTyVarBndr -&gt; Maybe DType
</span><a href="Language.Haskell.TH.Desugar.Core.html#extractTvbKind"><span class="hs-identifier hs-var hs-var">extractTvbKind</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DPlainTV"><span class="hs-identifier hs-type">DPlainTV</span></a></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe DType
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1613"></span><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#extractTvbKind"><span class="hs-identifier hs-var">extractTvbKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Haskell.TH.Desugar.AST.html#DKindedTV"><span class="hs-identifier hs-type">DKindedTV</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679412312"><span class="annot"><span class="annottext">k :: DType
</span><a href="#local-6989586621679412312"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DType -&gt; Maybe DType
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">DType
</span><a href="#local-6989586621679412312"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1614"></span><span>
</span><span id="line-1615"></span><span class="hs-comment">-- | Some functions in this module only use certain arguments on particular</span><span>
</span><span id="line-1616"></span><span class="hs-comment">-- versions of GHC. Other versions of GHC (that don't make use of those</span><span>
</span><span id="line-1617"></span><span class="hs-comment">-- arguments) might need to conjure up those arguments out of thin air at the</span><span>
</span><span id="line-1618"></span><span class="hs-comment">-- functions' call sites, so this function serves as a placeholder to use in</span><span>
</span><span id="line-1619"></span><span class="hs-comment">-- those situations. (In other words, this is a slightly more informative</span><span>
</span><span id="line-1620"></span><span class="hs-comment">-- version of 'undefined'.)</span><span>
</span><span id="line-1621"></span><span id="local-6989586621679413825"><span class="annot"><a href="Language.Haskell.TH.Desugar.Core.html#unusedArgument"><span class="hs-identifier hs-type">unusedArgument</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679413825"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1622"></span><span id="unusedArgument"><span class="annot"><span class="annottext">unusedArgument :: a
</span><a href="Language.Haskell.TH.Desugar.Core.html#unusedArgument"><span class="hs-identifier hs-var hs-var">unusedArgument</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Unused&quot;</span></span><span>
</span><span id="line-1623"></span></pre></body></html>